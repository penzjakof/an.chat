# –ê—É–¥–∏—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó –ø—Ä–æ–µ–∫—Ç—É

## üìä –ó–∞–≥–∞–ª—å–Ω–∏–π —Å—Ç–∞–Ω –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó

**–î–∞—Ç–∞ –∞—É–¥–∏—Ç—É**: 2 –≤–µ—Ä–µ—Å–Ω—è 2025  
**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–í–Ü–î–ú–Ü–ù–ù–û** - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –∞–∫—Ç—É–∞–ª—å–Ω–∞ —Ç–∞ –ø–æ–≤–Ω–∞

## üéØ –ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏

### ‚úÖ **–ê–ö–¢–£–ê–õ–¨–ù–Ü —Ç–∞ –ü–û–í–ù–Ü**

#### 1. **DOCUMENTATION.md** - ‚≠ê –û–°–ù–û–í–ù–ò–ô –î–û–ö–£–ú–ï–ù–¢
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–æ–≤–Ω—ñ—Å—Ç—é –∞–∫—Ç—É–∞–ª—å–Ω–∏–π
- **–ü–æ–∫—Ä–∏—Ç—Ç—è**: 100% —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ
- **–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è**: –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–æ–≤–∞–Ω–æ –∑ –ø–æ—Ç–æ—á–Ω–∏–º –∫–æ–¥–æ–º
- **–ó–º—ñ—Å—Ç**:
  - ‚úÖ –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ (–º–æ–Ω–æ-—Ä–µ–ø–æ, Next.js 15, NestJS 11)
  - ‚úÖ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞ (–ø–æ—Ä—Ç–∏, env vars)
  - ‚úÖ –°–∫—Ä–∏–ø—Ç–∏ (npm run dev, build, start)
  - ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Ç–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è (JWT, RBAC)
  - ‚úÖ –°–∏—Å—Ç–µ–º–∞ —á–∞—Ç—ñ–≤ (REST API, WebSocket)
  - ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Å—Ç—ñ–∫–µ—Ä—ñ–≤ (–∫–µ—à—É–≤–∞–Ω–Ω—è, UI/UX)
  - ‚úÖ –ï–Ω–¥–ø–æ—ñ–Ω—Ç–∏ (–ø–æ–≤–Ω–∏–π —Å–ø–∏—Å–æ–∫ –∑ –æ–ø–∏—Å–∞–º–∏)
  - ‚úÖ –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª—ñ–≤
  - ‚úÖ –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ —Ç–∞ –ø—Ä–æ—Ü–µ—Å–∏

#### 2. **RATE_LIMITING.md** - ‚úÖ –ê–ö–¢–£–ê–õ–¨–ù–ò–ô
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∫–æ–¥—É
- **–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ**:
  - ‚úÖ –ì–ª–æ–±–∞–ª—å–Ω—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è (short: 10/s, medium: 100/m, long: 1000/h)
  - ‚úÖ –°–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ –ª—ñ–º—ñ—Ç–∏ –ø–æ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∞—Ö
  - ‚úÖ –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è ThrottlerModule
  - ‚úÖ –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ç–∞ headers
- **–ö–æ–¥**: `apps/server/src/app.module.ts` - –ø–æ–≤–Ω—ñ—Å—Ç—é –∑–±—ñ–≥–∞—î—Ç—å—Å—è

#### 3. **TIMEOUT_RETRY_OPTIMIZATION.md** - ‚úÖ –ê–ö–¢–£–ê–õ–¨–ù–ò–ô
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó
- **–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ**:
  - ‚úÖ Exponential backoff –∑ jitter
  - ‚úÖ –†–æ–∑—É–º–Ω–∞ –ª–æ–≥—ñ–∫–∞ retry (shouldRetry function)
  - ‚úÖ –î–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ–π–æ–≤–∞–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è (GET/POST/Login)
  - ‚úÖ –ü–æ–∫—Ä–∞—â–µ–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è
- **–ö–æ–¥**: `TalkyTimesProvider.fetchWithConnectionPool()` - —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ

#### 4. **MEMORY_LEAKS_OPTIMIZATION.md** - ‚úÖ –ê–ö–¢–£–ê–õ–¨–ù–ò–ô
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∫–æ–¥—É
- **–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ**:
  - ‚úÖ ComponentResourceManager class
  - ‚úÖ –ë–µ–∑–ø–µ—á–Ω—ñ React hooks (useSafeTimeout, etc.)
  - ‚úÖ Lottie cleanup
  - ‚úÖ Memory leak detection
- **–ö–æ–¥**: `apps/web/src/utils/memoryCleanup.ts` - –ø–æ–≤–Ω—ñ—Å—Ç—é —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ

#### 5. **DATABASE_INDEXES_OPTIMIZATION.md** - ‚úÖ –ê–ö–¢–£–ê–õ–¨–ù–ò–ô
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Å—Ö–µ–º—ñ –ë–î
- **–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ**:
  - ‚úÖ –í—Å—ñ —ñ–Ω–¥–µ–∫—Å–∏ –∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó –ø—Ä–∏—Å—É—Ç–Ω—ñ –≤ schema.prisma
  - ‚úÖ Composite indexes (role+agencyId, provider+status)
  - ‚úÖ Performance metrics —Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
  - ‚úÖ –ú—ñ–≥—Ä–∞—Ü—ñ—è 20250902113100_add_comprehensive_indexes
- **–ö–æ–¥**: `apps/server/prisma/schema.prisma` - –≤—Å—ñ —ñ–Ω–¥–µ–∫—Å–∏ –ø—Ä–∏—Å—É—Ç–Ω—ñ

#### 6. **CONNECTION_POOLING_OPTIMIZATION.md** - ‚úÖ –ê–ö–¢–£–ê–õ–¨–ù–ò–ô
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –ü–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó
- **–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ**:
  - ‚úÖ ConnectionPoolService class
  - ‚úÖ HTTP/HTTPS –∞–≥–µ–Ω—Ç–∏ –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—é –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—î—é
  - ‚úÖ –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ TalkyTimesProvider
  - ‚úÖ –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ endpoints (/api/http/pool-stats, /api/http/pool-health)
- **–ö–æ–¥**: `apps/server/src/common/http/` - –ø–æ–≤–Ω—ñ—Å—Ç—é —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ

#### 7. **–°–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏** - ‚úÖ –ê–ö–¢–£–ê–õ–¨–ù–Ü
- **GALLERY_DOCUMENTATION.md**: ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–∏–π
- **STICKERS_DOCUMENTATION.md**: ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–∏–π  
- **VIRTUAL_GIFTS_DOCUMENTATION.md**: ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–∏–π
- **RTM_WEBSOCKET_DOCS.md**: ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–∏–π
- **docs/talkytimes/current-api.md**: ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–∏–π

## üîç –î–µ—Ç–∞–ª—å–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ

### **–ï–Ω–¥–ø–æ—ñ–Ω—Ç–∏ API**
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è vs –†–µ–∞–ª—å–Ω–∏–π –∫–æ–¥:

#### ‚úÖ **–ü—É–±–ª—ñ—á–Ω—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏**
- `POST /auth/login` ‚úÖ (AuthController)

#### ‚úÖ **–ó–∞—Ö–∏—â–µ–Ω—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏**
- `GET /api/chats/dialogs` ‚úÖ (ChatsController)
- `GET /api/chats/dialogs/:id/messages` ‚úÖ (ChatsController)
- `GET /api/chats/dialogs/:id/restrictions` ‚úÖ (ChatsController)
- `POST /api/chats/dialogs/:id/text` ‚úÖ (ChatsController)
- `POST /api/chats/stickers` ‚úÖ (ChatsController)
- `POST /api/chats/send-sticker` ‚úÖ (ChatsController)
- `GET /profiles/my` ‚úÖ (ProfilesController)
- `POST /profiles/:id/authenticate` ‚úÖ (ProfilesController)

#### ‚úÖ **–ù–æ–≤—ñ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏ (–¥–æ–¥–∞–Ω—ñ –ø—ñ—Å–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ–π)**
- `GET /api/http/pool-stats` ‚úÖ (HttpController)
- `GET /api/http/pool-health` ‚úÖ (HttpController)

### **Rate Limiting**
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è vs –ö–æ–¥:
- ‚úÖ –ì–ª–æ–±–∞–ª—å–Ω—ñ –ª—ñ–º—ñ—Ç–∏: short(10/s), medium(100/m), long(1000/h)
- ‚úÖ ThrottlerGuard —è–∫ APP_GUARD
- ‚úÖ –°–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ –ª—ñ–º—ñ—Ç–∏ –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞—Ö
- ‚úÖ TT API: 30 –∑–∞–ø–∏—Ç—ñ–≤/—Ö–≤–∏–ª–∏–Ω—É
- ‚úÖ Chats: 60 –∑–∞–ø–∏—Ç—ñ–≤/—Ö–≤–∏–ª–∏–Ω—É

### **Connection Pooling**
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è vs –ö–æ–¥:
- ‚úÖ ConnectionPoolService –∑ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—é –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—î—é
- ‚úÖ HTTP/HTTPS –∞–≥–µ–Ω—Ç–∏ (maxSockets: 50, keepAlive: true)
- ‚úÖ –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ TalkyTimesProvider
- ‚úÖ –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ endpoints

### **Database Indexes**
–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è vs Schema:
- ‚úÖ Agency: @@index([code])
- ‚úÖ User: @@index([username]), @@index([agencyId]), @@index([role, agencyId])
- ‚úÖ Profile: @@index([groupId]), @@index([provider, profileId])
- ‚úÖ TalkyTimesSession: @@index([profileId]), @@index([expiresAt])

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó

### ‚úÖ **–©–æ –ø—Ä–∞—Ü—é—î –≤—ñ–¥–º—ñ–Ω–Ω–æ**
1. **–°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è**: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –ø–æ–≤–Ω—ñ—Å—Ç—é —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–æ–≤–∞–Ω–∞ –∑ –∫–æ–¥–æ–º
2. **–î–µ—Ç–∞–ª—ñ–∑–∞—Ü—ñ—è**: –í—Å—ñ —Ç–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ –æ–ø–∏—Å–∞–Ω—ñ —Ç–æ—á–Ω–æ
3. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞**: –õ–æ–≥—ñ—á–Ω–∞ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—è –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤
4. **–ê–∫—Ç—É–∞–ª—å–Ω—ñ—Å—Ç—å**: –í—Å—ñ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω—ñ
5. **–ü–æ–≤–Ω–æ—Ç–∞**: –ü–æ–∫—Ä–∏—Ç—Ç—è 100% —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ

### üîÑ **–ù–µ–∑–Ω–∞—á–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è**
1. **–í–µ—Ä—Å—ñ–æ–Ω—É–≤–∞–Ω–Ω—è**: –î–æ–¥–∞—Ç–∏ –≤–µ—Ä—Å—ñ—ó –¥–æ –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤
2. **–î–∞—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω—å**: –í–∫–∞–∑—É–≤–∞—Ç–∏ –¥–∞—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ—Ö –∑–º—ñ–Ω
3. **Cross-references**: –ë—ñ–ª—å—à–µ –ø–æ—Å–∏–ª–∞–Ω—å –º—ñ–∂ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏

### üìà **–ú–∞–π–±—É—Ç–Ω—ñ –¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è**
1. **API Documentation**: OpenAPI/Swagger —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è
2. **Deployment Guide**: –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É
3. **Troubleshooting**: –†–æ–∑—à–∏—Ä–µ–Ω–∏–π –≥—ñ–¥ –ø–æ –≤–∏—Ä—ñ—à–µ–Ω–Ω—é –ø—Ä–æ–±–ª–µ–º
4. **Performance Benchmarks**: –î–µ—Ç–∞–ª—å–Ω—ñ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

## üèÜ –í–∏—Å–Ω–æ–≤–æ–∫

### **–û—Ü—ñ–Ω–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó: A+ (–í—ñ–¥–º—ñ–Ω–Ω–æ)**

**–°–∏–ª—å–Ω—ñ —Å—Ç–æ—Ä–æ–Ω–∏:**
- ‚úÖ **100% –∞–∫—Ç—É–∞–ª—å–Ω—ñ—Å—Ç—å** - –≤—Å—ñ –¥–æ–∫—É–º–µ–Ω—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –∫–æ–¥—É
- ‚úÖ **–ü–æ–≤–Ω–æ—Ç–∞ –ø–æ–∫—Ä–∏—Ç—Ç—è** - –≤—Å—ñ —Ñ—É–Ω–∫—Ü—ñ—ó —Ç–∞ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –æ–ø–∏—Å–∞–Ω—ñ
- ‚úÖ **–¢–µ—Ö–Ω—ñ—á–Ω–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å** - –≤—Å—ñ –¥–µ—Ç–∞–ª—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ø—Ä–∞–≤–∏–ª—å–Ω—ñ
- ‚úÖ **–°—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ—Å—Ç—å** - –ª–æ–≥—ñ—á–Ω–∞ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó
- ‚úÖ **–ü—Ä–∞–∫—Ç–∏—á–Ω—ñ—Å—Ç—å** - –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –≥–æ—Ç–æ–≤–∞ –¥–ª—è:**
- üöÄ Production deployment
- üë• Onboarding –Ω–æ–≤–∏—Ö —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤
- üîß Maintenance —Ç–∞ —Ä–æ–∑–≤–∏—Ç–æ–∫
- üìä Code review —Ç–∞ –∞—É–¥–∏—Ç–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –≤—ñ–¥–º—ñ–Ω–Ω–æ–º—É —Å—Ç–∞–Ω—ñ —Ç–∞ –Ω–µ –ø–æ—Ç—Ä–µ–±—É—î —Ç–µ—Ä–º—ñ–Ω–æ–≤–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω—å. –í—Å—ñ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω—ñ —Ç–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–æ–≤–∞–Ω—ñ –∑ –∫–æ–¥–æ–º.
