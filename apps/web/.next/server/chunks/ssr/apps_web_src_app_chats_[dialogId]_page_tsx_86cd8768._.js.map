{"version":3,"sources":["turbopack:///[project]/apps/web/src/app/chats/[dialogId]/page.tsx","turbopack:///[project]/apps/web/src/hooks/useDialogWebSocket.ts","turbopack:///[project]/apps/web/src/components/AudioPlayer.tsx","turbopack:///[project]/apps/web/src/components/MediaGallery.tsx","turbopack:///[project]/apps/web/src/components/ImagePreviewModal.tsx","turbopack:///[project]/apps/web/src/components/LottieErrorBoundary.tsx","turbopack:///[project]/apps/web/src/components/EmojiPicker.tsx","turbopack:///[project]/apps/web/src/components/EmailHistory.tsx","turbopack:///[project]/apps/web/src/utils/memoryCleanup.ts","turbopack:///[project]/apps/web/src/utils/grpcUtils.ts","turbopack:///[project]/apps/web/src/components/ClientPublicProfileModal.tsx","turbopack:///[project]/apps/web/src/components/MyPublicProfileModal.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef, useState, useCallback } from 'react';\nimport { useParams, useRouter, useSearchParams } from 'next/navigation';\nimport { apiGet, apiPost } from '@/lib/api';\nimport { getAccessToken, getSession } from '@/lib/session';\nimport { ChatHeaderSkeleton, MessageSkeleton } from '@/components/SkeletonLoader';\nimport { useDialogWebSocket } from '@/hooks/useDialogWebSocket';\nimport { MediaGallery, Photo } from '@/components/MediaGallery';\nimport ImagePreviewModal from '@/components/ImagePreviewModal';\nimport LottieErrorBoundary from '@/components/LottieErrorBoundary';\nimport EmailHistory from '@/components/EmailHistory';\nimport { useResourceManager, cleanupLottieAnimations } from '@/utils/memoryCleanup';\nimport { checkDialogRestrictions, logRestrictionsCheck } from '@/utils/grpcUtils';\nimport { ClientPublicProfileModal } from '@/components/ClientPublicProfileModal';\nimport { MyPublicProfileModal } from '@/components/MyPublicProfileModal';\nimport { EmojiPicker } from '@/components/EmojiPicker';\n\n// –¢–∏–ø–∏ –¥–ª—è Lottie\ndeclare global {\n\tinterface Window {\n\t\tlottie?: {\n\t\t\tloadAnimation: (params: {\n\t\t\t\tcontainer: HTMLElement;\n\t\t\t\tanimationData: any;\n\t\t\t\trenderer: string;\n\t\t\t\tloop: boolean;\n\t\t\t\tautoplay: boolean;\n\t\t\t\trendererSettings?: {\n\t\t\t\t\tpreserveAspectRatio: string;\n\t\t\t\t};\n\t\t\t}) => {\n\t\t\t\taddEventListener: (event: string, callback: (data?: any) => void) => void;\n\t\t\t};\n\t\t};\n\t\tactiveLottieInstances?: Map<string, any>;\n\t}\n}\n\ntype ChatMessage = {\n\tid: number;\n\tdateCreated: string;\n\tidUserFrom: number;\n\tidUserTo: number;\n\ttype: string;\n\tcontent: {\n\t\tmessage?: string;\n\t\tidPhoto?: number;\n\t\turl?: string;\n\t\tid?: number; // –î–ª—è —Å—Ç—ñ–∫–µ—Ä—ñ–≤\n\t\tphotos?: Array<{ id: number; url: string }>; // –î–ª—è –ø–∞–∫–µ—Ç—ñ–≤ —Ñ–æ—Ç–æ\n\t};\n\tisSending?: boolean; // –î–ª—è –ª–æ–∫–∞–ª—å–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —â–æ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—Ç—å—Å—è\n\terror?: boolean; // –î–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∑ –ø–æ–º–∏–ª–∫–æ—é –≤—ñ–¥–ø—Ä–∞–≤–∫–∏\n\t[key: string]: unknown;\n};\n\ntype UserProfile = {\n\tid: number;\n\tname: string;\n\tpersonal: {\n\t\tavatar_small: string;\n\t\tavatar_large: string;\n\t\tmood?: string;\n\t};\n\tis_online: boolean;\n};\n\ntype SourceProfile = {\n\tid: string;\n\tdisplayName: string;\n};\n\ntype Sticker = {\n\tid: number;\n\turl: string;\n};\n\ntype StickerCategory = {\n\tname: string;\n\tstickers: Sticker[];\n};\n\ntype VirtualGiftLimit = {\n\tlimit: number;\n\tcanSendWithoutLimit: boolean;\n};\n\ntype VirtualGiftCategory = {\n\tid: number;\n\tname: string;\n};\n\ntype VirtualGiftItem = {\n\tid: number;\n\tcost: number;\n\tname: string;\n\timageSrc: string | null;\n\tanimationSrc: string | null;\n\tcategory: VirtualGiftCategory;\n\tgender: string | null;\n};\n\ntype VirtualGiftListResponse = {\n\tcursor: string;\n\titems: VirtualGiftItem[];\n};\n\nexport default function DialogPage() {\n\tconst router = useRouter();\n\tconst searchParams = useSearchParams();\n\tconst params = useParams();\n\tconst dialogId = params.dialogId as string;\n\t\n\t// Resource manager –¥–ª—è –±–µ–∑–ø–µ—á–Ω–æ–≥–æ cleanup\n\tconst resourceManager = useResourceManager();\n\n\tconst [messages, setMessages] = useState<ChatMessage[]>([]);\n\tconst [text, setText] = useState('');\n\tconst [userProfile, setUserProfile] = useState<UserProfile | null>(null);\n\tconst [sourceProfile, setSourceProfile] = useState<SourceProfile | null>(null);\n\tconst [profileAvatar, setProfileAvatar] = useState<string | null>(null);\n\tconst [isLoadingMessages, setIsLoadingMessages] = useState(true);\n\tconst [isLoadingHeader, setIsLoadingHeader] = useState(true);\n\tconst [isLoadingMore, setIsLoadingMore] = useState(false);\n\tconst [hasMoreMessages, setHasMoreMessages] = useState(true);\n\tconst [cursor, setCursor] = useState<number | null>(null);\n\tconst [messagesLeft, setMessagesLeft] = useState<number | null>(null);\n\tconst [lettersLeft, setLettersLeft] = useState<number | null>(null);\n\tconst [isLoadingRestrictions, setIsLoadingRestrictions] = useState(false);\n    const [isImagePreviewOpen, setIsImagePreviewOpen] = useState(false);\n    const [imagePreviewUrl, setImagePreviewUrl] = useState<string | null>(null);\n    const [imagePreviewLoading, setImagePreviewLoading] = useState(false);\n\tconst bottomRef = useRef<HTMLDivElement>(null);\n\tconst scrollContainerRef = useRef<HTMLDivElement>(null);\n\tconst inputRef = useRef<HTMLTextAreaElement>(null);\n\tconst lastScrollTop = useRef<number>(0);\n\tconst loadingTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\tconst unlockTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\tconst canLoadMore = useRef<boolean>(true);\n\tconst [isChatGalleryOpen, setIsChatGalleryOpen] = useState(false);\n\tconst [isAttachGalleryOpen, setIsAttachGalleryOpen] = useState(false);\n\tconst [isStickerModalOpen, setIsStickerModalOpen] = useState(false);\n\tconst [isEmailHistoryOpen, setIsEmailHistoryOpen] = useState(false);\n\tconst [isBlockedByInterlocutor, setIsBlockedByInterlocutor] = useState(false);\n\tconst [stickerCategories, setStickerCategories] = useState<StickerCategory[]>([]);\n\tconst [isLoadingStickers, setIsLoadingStickers] = useState(false);\n\tconst [activeCategoryIndex, setActiveCategoryIndex] = useState<number>(0);\n\tconst stickerScrollRef = useRef<HTMLDivElement>(null);\n\tconst [giftLimit, setGiftLimit] = useState<VirtualGiftLimit | null>(null);\n\tconst [isLoadingGiftLimit, setIsLoadingGiftLimit] = useState(false);\n\tconst [isGiftModalOpen, setIsGiftModalOpen] = useState(false);\n\tconst [giftItems, setGiftItems] = useState<VirtualGiftItem[]>([]);\n\tconst [isLoadingGifts, setIsLoadingGifts] = useState(false);\n\tconst [giftCursor, setGiftCursor] = useState<string>('');\n\tconst [hasMoreGifts, setHasMoreGifts] = useState(true);\n\tconst [isEmojiPickerOpen, setIsEmojiPickerOpen] = useState(false);\n\tconst [isPostEmojiPickerOpen, setIsPostEmojiPickerOpen] = useState(false);\n\tconst [isGiftEmojiPickerOpen, setIsGiftEmojiPickerOpen] = useState(false);\n\n\t// –°—Ç–∞–Ω –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ –ø–æ—Å—Ç–∞\n\tconst [isPostModalOpen, setIsPostModalOpen] = useState(false);\n\n\t// –ê–≤—Ç–æ–≤—ñ–¥–∫—Ä–∏—Ç—Ç—è EmailHistory –∑–∞ query-–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏\n\tuseEffect(() => {\n\t\ttry {\n\t\t\tconst open = searchParams?.get('openEmailHistory');\n\t\t\tconst corrId = searchParams?.get('corrId');\n\t\t\tif (open === '1') {\n\t\t\t\tsetIsEmailHistoryOpen(true);\n\t\t\t\tif (corrId && corrId !== dialogId) {\n\t\t\t\t\t(window as any).__emailCorrOverride = corrId;\n\t\t\t\t}\n\t\t\t}\n\t\t} catch {}\n\t}, [searchParams, dialogId]);\n\tconst [selectedPost, setSelectedPost] = useState<any>(null);\n\tconst [isLoadingPost, setIsLoadingPost] = useState(false);\n\n\t// –ü—Ä–∞–ø–æ—Ä –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è race condition\n\tconst isLoadingGiftsRef = useRef(false);\n\tconst abortControllerRef = useRef<AbortController | null>(null);\n\n\t// –°—Ç–∞–Ω –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –ø–æ–¥–∞—Ä—É–Ω–∫—É\n\tconst [selectedGift, setSelectedGift] = useState<VirtualGiftItem | null>(null);\n\tconst [isMessageModalOpen, setIsMessageModalOpen] = useState(false);\n\tconst [giftMessage, setGiftMessage] = useState('');\n\tconst [isSendingGift, setIsSendingGift] = useState(false);\n\n\t// –°—Ç–∞–Ω –¥–ª—è TalkTimes exclusive posts\n\tconst [hasExclusivePosts, setHasExclusivePosts] = useState(false);\n\tconst [ttCategories, setTtCategories] = useState<string[]>([]);\n\tconst [ttTier, setTtTier] = useState<'special' | 'specialplus' | undefined>(undefined);\n\t// –ú–æ–¥–∞–ª–∫–∞ –¥–ª—è –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ–≥–æ –ø–æ—Å—Ç—É\n\tconst [isExclusiveModalOpen, setIsExclusiveModalOpen] = useState(false);\n\tconst [exclusiveText, setExclusiveText] = useState('');\n\tconst minExclusiveLength = 100;\n\tconst [attachedPhotos, setAttachedPhotos] = useState<number[]>([]);\n\tconst [attachedVideos, setAttachedVideos] = useState<number[]>([]);\n\tconst [attachedPhotoPreviews, setAttachedPhotoPreviews] = useState<Array<{ idPhoto: number; url: string }>>([]);\n\tconst [attachedVideoPreviews, setAttachedVideoPreviews] = useState<Array<{ idVideo: number; url: string }>>([]);\n\n\t// –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ –≥–ª–æ–±–∞–ª—å–Ω—É –∑–º—ñ–Ω–Ω—É –¥–ª—è Lottie —ñ–Ω—Å—Ç–∞–Ω—Å—ñ–≤\n\tuseEffect(() => {\n\t\tif (!window.activeLottieInstances) {\n\t\t\twindow.activeLottieInstances = new Map();\n\t\t}\n\t\treturn () => {\n\t\t\t// Cleanup –ø—Ä–∏ unmount –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞\n\t\t\tcleanupLottieAnimations();\n\t\t};\n\t}, []);\n\n\t// –§—É–Ω–∫—Ü—ñ—è cleanup –¥–ª—è Lottie –∞–Ω—ñ–º–∞—Ü—ñ–π\n\tconst cleanupLottieAnimations = useCallback(() => {\n\t\tconsole.log('üßπ Cleaning up Lottie animations...');\n\t\tif (typeof window !== 'undefined' && window.activeLottieInstances) {\n\t\t\twindow.activeLottieInstances.forEach((animation, key) => {\n\t\t\t\ttry {\n\t\t\t\t\tif (animation && typeof animation.destroy === 'function') {\n\t\t\t\t\t\tanimation.destroy();\n\t\t\t\t\t\tconsole.log(`‚úÖ Destroyed Lottie animation: ${key}`);\n\t\t\t\t\t}\n\t\t\t\t\t// –¢–∞–∫–æ–∂ –≤–∏–¥–∞–ª—è—î–º–æ event listeners —è–∫—â–æ —î\n\t\t\t\t\tif (animation && typeof animation.removeEventListener === 'function') {\n\t\t\t\t\t\tanimation.removeEventListener('data_ready');\n\t\t\t\t\t\tanimation.removeEventListener('error');\n\t\t\t\t\t\tanimation.removeEventListener('complete');\n\t\t\t\t\t}\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.warn(`‚ö†Ô∏è Error destroying Lottie animation ${key}:`, error);\n\t\t\t\t}\n\t\t\t});\n\t\t\twindow.activeLottieInstances.clear();\n\t\t}\n\t\t\n\t\t// –¢–∞–∫–æ–∂ –æ—á–∏—â—É—î–º–æ –≤—Å—ñ DOM –µ–ª–µ–º–µ–Ω—Ç–∏ –∑ Lottie\n\t\tif (typeof document !== 'undefined') {\n\t\t\tconst lottieContainers = document.querySelectorAll('[data-lottie-url]');\n\t\t\tlottieContainers.forEach(container => {\n\t\t\t\tif (container instanceof HTMLElement) {\n\t\t\t\t\tcontainer.innerHTML = ''; // –û—á–∏—â—É—î–º–æ –≤–º—ñ—Å—Ç\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}, []);\n\n\t// –§—É–Ω–∫—Ü—ñ—è cleanup –¥–ª—è –∞–∫—Ç–∏–≤–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤\n\tconst cleanupActiveRequests = useCallback(() => {\n\t\tconsole.log('üßπ Cleaning up active requests...');\n\t\tif (abortControllerRef.current) {\n\t\t\ttry {\n\t\t\t\tabortControllerRef.current.abort();\n\t\t\t\tconsole.log('‚úÖ Cancelled active gift loading request');\n\t\t\t} catch (error) {\n\t\t\t\tconsole.warn('‚ö†Ô∏è Error aborting request:', error);\n\t\t\t} finally {\n\t\t\t\tabortControllerRef.current = null;\n\t\t\t\tisLoadingGiftsRef.current = false;\n\t\t\t}\n\t\t}\n\t\t\n\t\t// –¢–∞–∫–æ–∂ —Å–∫–∏–¥–∞—î–º–æ –≤—Å—ñ loading —Å—Ç–µ–π—Ç–∏\n\t\tsetIsLoadingGifts(false);\n\t\tsetIsLoadingMore(false);\n\t\tsetIsLoadingHeader(false);\n\t\t\n\t\t// –û—á–∏—â—É—î–º–æ –≤—Å—ñ –º–æ–∂–ª–∏–≤—ñ pending promises\n\t\t// (—Ü–µ –¥–æ–ø–æ–º–æ–∂–µ —É–Ω–∏–∫–Ω—É—Ç–∏ setState –Ω–∞ unmounted –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö)\n\t}, []);\n\n\t// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è Lottie –∞–Ω—ñ–º–∞—Ü—ñ—ó –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞\n\tconst loadLottieForElement = async (container: HTMLElement, gift: VirtualGiftItem) => {\n\t\ttry {\n\t\t\tconsole.log('üé≠ Loading Lottie for gift:', gift.name, gift.animationSrc);\n\n\t\t\t// –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ Lottie –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É —è–∫—â–æ —ó—ó –Ω–µ–º–∞—î\n\t\t\tif (!window.lottie) {\n\t\t\t\tawait new Promise<void>((resolve, reject) => {\n\t\t\t\t\tconst script = document.createElement('script');\n\t\t\t\t\tscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js';\n\t\t\t\t\tscript.onload = () => {\n\t\t\t\t\t\tconsole.log('‚úÖ Lottie library loaded');\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t};\n\t\t\t\t\tscript.onerror = () => {\n\t\t\t\t\t\tconsole.error('‚ùå Failed to load Lottie library');\n\t\t\t\t\t\treject(new Error('Failed to load Lottie'));\n\t\t\t\t\t};\n\t\t\t\t\tdocument.head.appendChild(script);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –∞–Ω—ñ–º–∞—Ü—ñ–π–Ω—ñ –¥–∞–Ω—ñ\n\t\t\tconst response = await fetch(gift.animationSrc);\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow new Error('Failed to fetch Lottie data: ' + response.status);\n\t\t\t}\n\n\t\t\tconst data = await response.json();\n\t\t\tconsole.log('üé≠ Lottie data loaded for:', gift.name);\n\n\t\t\t// –û—á–∏—â—É—î–º–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —ñ —Å—Ç–≤–æ—Ä—é—î–º–æ –∞–Ω—ñ–º–∞—Ü—ñ—é\n\t\t\tcontainer.innerHTML = '';\n\t\t\tconst animation = window.lottie.loadAnimation({\n\t\t\t\tcontainer: container,\n\t\t\t\tanimationData: data,\n\t\t\t\trenderer: 'svg',\n\t\t\t\tloop: true,\n\t\t\t\tautoplay: true,\n\t\t\t\trendererSettings: {\n\t\t\t\t\tpreserveAspectRatio: 'xMidYMid meet'\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —ñ–Ω—Å—Ç–∞–Ω—Å –¥–ª—è cleanup\n\t\t\tconst animationKey = gift.id + '-' + Date.now();\n\t\t\tif (window.activeLottieInstances) {\n\t\t\t\twindow.activeLottieInstances.set(animationKey, animation);\n\t\t\t}\n\n\t\t\tanimation.addEventListener('data_ready', () => {\n\t\t\t\tconsole.log('‚úÖ Lottie animation loaded and playing for:', gift.name);\n\t\t\t});\n\n\t\t\tanimation.addEventListener('error', (error: any) => {\n\t\t\t\tconsole.error('‚ùå Lottie animation error for:', gift.name, error);\n\t\t\t\t// –°–ø—Ä–æ–±—É—î–º–æ fallback\n\t\t\t\tshowLottieFallback(container, gift);\n\t\t\t});\n\n\t\t} catch (error) {\n\t\t\tconsole.error('‚ùå Failed to load Lottie for:', gift.name, error);\n\t\t\tshowLottieFallback(container, gift);\n\t\t}\n\t};\n\n\t// Fallback –¥–ª—è Lottie\n\tconst showLottieFallback = (container: HTMLElement, gift: VirtualGiftItem) => {\n\t\t// –°–ø—Ä–æ–±—É—î–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å—Ç–∞—Ç–∏—á–Ω—É –≤–µ—Ä—Å—ñ—é (PNG)\n\t\tconst staticUrl = gift.animationSrc.replace('.json', '.png');\n\t\tconst img = new Image();\n\n\t\timg.onload = () => {\n\t\t\tcontainer.innerHTML = '<img src=\"' + staticUrl + '\" class=\"w-full h-full object-cover\" alt=\"Static version\" />';\n\t\t};\n\n\t\timg.onerror = () => {\n\t\t\t// –Ø–∫—â–æ —ñ PNG –Ω–µ–º–∞—î, –ø–æ–∫–∞–∑—É—î–º–æ placeholder\n\t\t\tcontainer.innerHTML = '<div class=\"w-full h-full flex items-center justify-center bg-gradient-to-br from-pink-100 to-purple-100\"><div class=\"text-center\"><div class=\"text-2xl mb-1\">üé≠</div><div class=\"text-xs text-gray-600\">Lottie –∞–Ω—ñ–º–∞—Ü—ñ—è</div></div></div>';\n\t\t};\n\n\t\timg.src = staticUrl;\n\t};\n\n\t// –ö–µ—à –¥–ª—è —Å—Ç—ñ–∫–µ—Ä—ñ–≤\n\tconst stickersCache = useRef<{\n\t\tdata: StickerCategory[];\n\t\ttimestamp: number;\n\t\tprofileId: string;\n\t} | null>(null);\n\tconst STICKERS_CACHE_TTL = 30 * 60 * 1000; // 30 —Ö–≤–∏–ª–∏–Ω\n\n\t// –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø: dialogId –º–∞—î —Ñ–æ—Ä–º–∞—Ç \"idProfile-idRegularUser\" (–Ω–∞—à –ø—Ä–æ—Ñ—ñ–ª—å - —Å–ø—ñ–≤—Ä–æ–∑–º–æ–≤–Ω–∏–∫)\n\tconst [idProfile, idRegularUser] = dialogId.split('-').map(Number);\n\tconsole.log('üî¢ Dialog parsing:', { dialogId, idProfile, idRegularUser });\n\n\t// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å—Ç–∏–ª—ñ–≤ –Ω–∞—Å—Ç—Ä–æ—é\n\tconst getMoodStyles = (mood: string | null | undefined) => {\n\t\t// –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞ null/undefined\n\t\tif (!mood || typeof mood !== 'string') {\n\t\t\treturn {\n\t\t\t\ticonColor: 'text-gray-600',\n\t\t\t\ttextColor: 'text-gray-600',\n\t\t\t\tdisplayName: '–ù–µ–≤—ñ–¥–æ–º–æ',\n\t\t\t\ticon: (\n\t\t\t\t\t<svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n\t\t\t\t\t\t<path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z\" clipRule=\"evenodd\" />\n\t\t\t\t\t</svg>\n\t\t\t\t)\n\t\t\t};\n\t\t}\n\n\t\tswitch (mood.toLowerCase()) {\n\t\t\tcase 'real_love':\n\t\t\t\treturn {\n\t\t\t\t\ticonColor: 'text-red-600',\n\t\t\t\t\ttextColor: 'text-red-600',\n\t\t\t\t\tdisplayName: '–õ—é–±–æ–≤',\n\t\t\t\t\ticon: (\n\t\t\t\t\t\t<svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n\t\t\t\t\t\t\t<path fillRule=\"evenodd\" d=\"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z\" clipRule=\"evenodd\" />\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t)\n\t\t\t\t};\n\t\t\tcase 'friendship':\n\t\t\t\treturn {\n\t\t\t\t\ticonColor: 'text-blue-600',\n\t\t\t\t\ttextColor: 'text-blue-600',\n\t\t\t\t\tdisplayName: '–î—Ä—É–∂–±–∞',\n\t\t\t\t\ticon: (\n\t\t\t\t\t\t<svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n\t\t\t\t\t\t\t<path d=\"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z\" />\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t)\n\t\t\t\t};\n\t\t\tcase 'hot_talks':\n\t\t\t\treturn {\n\t\t\t\t\ticonColor: 'text-pink-600',\n\t\t\t\t\ttextColor: 'text-pink-600',\n\t\t\t\t\tdisplayName: '–Ü–Ω—Ç–∏–º',\n\t\t\t\t\ticon: (\n\t\t\t\t\t\t<svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n\t\t\t\t\t\t\t<path d=\"M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0112.12 15.12z\" />\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t)\n\t\t\t\t};\n\t\t\tdefault:\n\t\t\t\treturn {\n\t\t\t\t\ticonColor: 'text-gray-600',\n\t\t\t\t\ttextColor: 'text-gray-600',\n\t\t\t\t\tdisplayName: mood,\n\t\t\t\t\ticon: (\n\t\t\t\t\t\t<svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n\t\t\t\t\t\t\t<path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z\" clipRule=\"evenodd\" />\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t)\n\t\t\t\t};\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tconst s = getSession();\n\t\tif (!s) {\n\t\t\trouter.replace('/login');\n\t\t\treturn;\n\t\t}\n\t\t\n\t\t// –°–∫–∏–¥–∞—î–º–æ —Å—Ç–∞–Ω–∏ –ø—Ä–∏ –∑–º—ñ–Ω—ñ –¥—ñ–∞–ª–æ–≥—É\n\t\tcanLoadMore.current = true;\n\t\tlastScrollTop.current = 0;\n\t\t\n\t\t// –û—á–∏—â—É—î–º–æ timeouts –ø—Ä–∏ –∑–º—ñ–Ω—ñ –¥—ñ–∞–ª–æ–≥—É\n\t\tif (loadingTimeoutRef.current) {\n\t\t\tclearTimeout(loadingTimeoutRef.current);\n\t\t\tloadingTimeoutRef.current = null;\n\t\t}\n\t\tif (unlockTimeoutRef.current) {\n\t\t\tclearTimeout(unlockTimeoutRef.current);\n\t\t\tunlockTimeoutRef.current = null;\n\t\t}\n\t\t\n\t\t// –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —Å—Ç–∞—Ç—É—Å –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è/–±–ª–æ–∫—É–≤–∞–Ω–Ω—è –ø–µ—Ä–µ–¥ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å\n\t\t(async () => {\n\t\t\ttry {\n\t\t\t\tconst [idProfileStr, idRegularStr] = dialogId.split('-');\n\t\t\t\tconst profileNum = parseInt(idProfileStr);\n\t\t\t\tconst interlocutorNum = parseInt(idRegularStr);\n\t\t\t\tif (Number.isFinite(profileNum) && Number.isFinite(interlocutorNum)) {\n\t\t\t\t\tconst res = await apiPost<{ success: boolean; data?: Array<{ blockedByInterlocutor?: boolean }> }>(\n\t\t\t\t\t\t'/api/chats/connections',\n\t\t\t\t\t\t{ profileId: profileNum, idsInterlocutor: [interlocutorNum] }\n\t\t\t\t\t);\n\t\t\t\t\tconst blocked = !!res?.data?.[0]?.blockedByInterlocutor;\n\t\t\t\t\tif (typeof setIsBlockedByInterlocutor === 'function') {\n\t\t\t\t\t\tsetIsBlockedByInterlocutor(blocked);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch {}\n\t\t\t// –ü—ñ—Å–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è\n\t\t\tloadMessages();\n\t\t})();\n\t\t\n\t\t// –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ç–∞ –ø—Ä–æ—Ñ—ñ–ª—é\n\t\tloadUserAndProfileData();\n\t\t\n\t\t// –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –æ–±–º–µ–∂–µ–Ω–Ω—è\n\t\tloadRestrictions();\n\n\t}, [dialogId, router]);\n\n\t// –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –ª—ñ–º—ñ—Ç–∏ –ø–æ–¥–∞—Ä—É–Ω–∫—ñ–≤ –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é\n\tuseEffect(() => {\n\t\tif (sourceProfile?.id && !isLoadingGiftLimit && !giftLimit) {\n\t\t\tloadGiftLimits();\n\t\t}\n\t}, [sourceProfile?.id, isLoadingGiftLimit, giftLimit]);\n\n\tconst loadMessages = async (isInitial = true) => {\n\t\ttry {\n\t\t\tif (isInitial) {\n\t\t\t\tsetIsLoadingMessages(true);\n\t\t\t\tsetMessages([]);\n\t\t\t\tsetCursor(null);\n\t\t\t\tsetHasMoreMessages(true);\n\t\t\t} else {\n\t\t\t\tsetIsLoadingMore(true);\n\t\t\t}\n\n\t\t\t// –ë—É–¥—É—î–º–æ URL –∑ cursor –¥–ª—è –ø–∞–≥—ñ–Ω–∞—Ü—ñ—ó\n\t\t\tconst params = new URLSearchParams();\n\t\t\tif (cursor && !isInitial) {\n\t\t\t\tparams.set('cursor', cursor.toString());\n\t\t\t}\n\t\t\t\n\t\t\tconst messagesUrl = `/api/chats/dialogs/${encodeURIComponent(dialogId)}/messages${params.toString() ? '?' + params.toString() : ''}`;\n\t\t\t\n\t\t\tconst response = await apiGet<{ messages: ChatMessage[]; cursor?: string; hasMore?: boolean }>(messagesUrl);\n\t\t\t\n\t\t\t// –°–æ—Ä—Ç—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑–∞ –¥–∞—Ç–æ—é (—Å—Ç–∞—Ä—ñ—à—ñ —Å–ø–æ—á–∞—Ç–∫—É)\n\t\t\tconst sortedMessages = (response.messages || []).sort((a, b) => \n\t\t\t\tnew Date(a.dateCreated).getTime() - new Date(b.dateCreated).getTime()\n\t\t\t);\n\n\t\t\tif (isInitial) {\n\t\t\t\tsetMessages(sortedMessages);\n\t\t\t\t// –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ cursor –Ω–∞ –Ω–∞–π—Å—Ç–∞—Ä—ñ—à–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–ª—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è\n\t\t\t\tif (sortedMessages.length > 0) {\n\t\t\t\t\tsetCursor(sortedMessages[0].id);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// –î–æ–¥–∞—î–º–æ —Å—Ç–∞—Ä—ñ—à—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞ –ø–æ—á–∞—Ç–æ–∫, –≤–∏–∫–ª—é—á–∞—é—á–∏ –¥—É–±–ª—ñ–∫–∞—Ç–∏\n\t\t\t\tconst existingIds = new Set(messages.map(msg => msg.id));\n\t\t\t\tconst newMessages = sortedMessages.filter(msg => !existingIds.has(msg.id));\n\t\t\t\t\n\t\t\t\tconsole.log(`üìÑ Pagination: loaded ${sortedMessages.length} messages, ${newMessages.length} new, ${sortedMessages.length - newMessages.length} duplicates filtered`);\n\t\t\t\t\n\t\t\t\t// –Ø–∫—â–æ –Ω–µ–º–∞—î –Ω–æ–≤–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –ø—ñ—Å–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó - –∑—É–ø–∏–Ω—è—î–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è\n\t\t\t\tif (newMessages.length === 0) {\n\t\t\t\t\tconsole.log(`‚èπÔ∏è No new messages after filtering, stopping pagination`);\n\t\t\t\t\tsetHasMoreMessages(false);\n\t\t\t\t} else {\n\t\t\t\t\tsetMessages(prev => [...newMessages, ...prev]);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// –û–Ω–æ–≤–ª—é—î–º–æ cursor –Ω–∞ –Ω–∞–π—Å—Ç–∞—Ä—ñ—à–µ –∑ –Ω–æ–≤–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å\n\t\t\t\tif (sortedMessages.length > 0) {\n\t\t\t\t\tconst newCursor = sortedMessages[0].id;\n\t\t\t\t\t// –û–Ω–æ–≤–ª—é—î–º–æ cursor —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –≤—ñ–Ω –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è\n\t\t\t\t\tsetCursor(prevCursor => prevCursor !== newCursor ? newCursor : prevCursor);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —î —â–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è\n\t\t\tif (isInitial) {\n\t\t\t\t// –ü—Ä–∏ –ø–æ—á–∞—Ç–∫–æ–≤–æ–º—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ - –∑–∞–≤–∂–¥–∏ –¥–æ–∑–≤–æ–ª—è—î–º–æ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—é —è–∫—â–æ —î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è\n\t\t\t\tsetHasMoreMessages(response.hasMore !== false && sortedMessages.length > 0);\n\t\t\t} else {\n\t\t\t\t// –ü—Ä–∏ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—ó - –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —î –Ω–æ–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—ñ—Å–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤\n\t\t\t\tconst existingIds = new Set(messages.map(msg => msg.id));\n\t\t\t\tconst actualNewMessages = sortedMessages.filter(msg => !existingIds.has(msg.id));\n\t\t\t\tconst hasRealNewMessages = actualNewMessages.length > 0;\n\t\t\t\t\n\t\t\t\tconsole.log(`üìä Pagination check: received ${sortedMessages.length}, new ${actualNewMessages.length}, hasMore=${response.hasMore}`);\n\t\t\t\t\n\t\t\t\t// –ó—É–ø–∏–Ω—è—î–º–æ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—é —è–∫—â–æ –Ω–µ–º–∞—î –Ω–æ–≤–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∞–±–æ API –∫–∞–∂–µ —â–æ –±—ñ–ª—å—à–µ –Ω–µ–º–∞—î\n\t\t\t\tsetHasMoreMessages(response.hasMore !== false && hasRealNewMessages);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('Failed to load messages:', error);\n\t\t\tif (isInitial) {\n\t\t\t\tsetMessages([]);\n\t\t\t}\n\t\t} finally {\n\t\t\tif (isInitial) {\n\t\t\t\tsetIsLoadingMessages(false);\n\t\t\t\tcanLoadMore.current = true; // –†–æ–∑–±–ª–æ–∫–æ–≤—É—î–º–æ –¥–ª—è –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è\n\t\t\t} else {\n\t\t\t\tsetIsLoadingMore(false);\n\t\t\t\t// –†–æ–∑–±–ª–æ–∫–æ–≤—É—î–º–æ –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, –∞–ª–µ —Ç—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è –Ω–µ–≤–µ–ª–∏–∫–æ—ó –∑–∞—Ç—Ä–∏–º–∫–∏\n\t\t\t\tunlockTimeoutRef.current = setTimeout(() => {\n\t\t\t\t\tcanLoadMore.current = true;\n\t\t\t\t\tconsole.log(`‚úÖ Pagination unlocked, can load more`);\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t}\n\t};\n\n\tconst loadUserAndProfileData = async () => {\n\t\ttry {\n\t\t\tsetIsLoadingHeader(true);\n\t\t\t// –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –ø—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞\n\t\t\tconst userResponse = await apiGet<{ profiles: UserProfile[] }>(`/api/chats/profiles?ids=${idRegularUser}`);\n\t\t\tif (userResponse.profiles && userResponse.profiles.length > 0) {\n\t\t\t\tsetUserProfile(userResponse.profiles[0]);\n\t\t\t}\n\n\t\t\t// –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –¥–∞–Ω—ñ –Ω–∞—à–æ–≥–æ –ø—Ä–æ—Ñ—ñ–ª—é –∑ –±–∞–∑–∏\n\t\t\tconst profilesResponse = await apiGet<SourceProfile[]>('/profiles/my');\n\t\t\tconst profile = profilesResponse.find((p: any) => p.profileId === idProfile.toString());\n\t\t\tif (profile) {\n\t\t\t\tsetSourceProfile(profile);\n\t\t\t\t\n\t\t\t\t// –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –∞–≤–∞—Ç–∞—Ä –Ω–∞—à–æ–≥–æ –ø—Ä–æ—Ñ—ñ–ª—é\n\t\t\t\tconst profileDataResponse = await apiGet<{ profileData: any }>(`/profiles/${profile.id}/profile-data`);\n\t\t\t\tif (profileDataResponse.profileData?.personal?.avatar_large) {\n\t\t\t\t\tsetProfileAvatar(profileDataResponse.profileData.personal.avatar_large);\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('Failed to load user/profile data:', error);\n\t\t} finally {\n\t\t\tsetIsLoadingHeader(false);\n\t\t}\n\t};\n\n\tconst loadRestrictions = async () => {\n\t\ttry {\n\t\t\tsetIsLoadingRestrictions(true);\n\n\t\t\t// –ß–∏—Ç–∞—î–º–æ messagesLeft –∑ localStorage (–æ—Ç—Ä–∏–º–∞–Ω–æ –∑ –¥—ñ–∞–ª–æ–≥—É)\n\t\t\tconst storedMessagesLeft = localStorage.getItem(`messagesLeft_${dialogId}`);\n\t\t\tif (storedMessagesLeft && !isNaN(parseInt(storedMessagesLeft))) {\n\t\t\t\tsetMessagesLeft(parseInt(storedMessagesLeft));\n\t\t\t} else {\n\t\t\t\tconsole.warn(`No valid messagesLeft found in localStorage for ${dialogId}`);\n\t\t\t\tsetMessagesLeft(0); // Fallback –∑–Ω–∞—á–µ–Ω–Ω—è\n\t\t\t}\n\n\t\t\t// –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ lettersLeft —á–µ—Ä–µ–∑ API\n\t\t\tconst response = await apiGet<{ lettersLeft: number }>(`/api/chats/dialogs/${encodeURIComponent(dialogId)}/restrictions`);\n\t\t\tif (typeof response.lettersLeft === 'number') {\n\t\t\t\tsetLettersLeft(response.lettersLeft);\n\t\t\t} else {\n\t\t\t\tconsole.warn('Invalid lettersLeft response:', response);\n\t\t\t\tsetLettersLeft(0);\n\t\t\t}\n\n\t\t\t// üé™ –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ TalkTimes restrictions –¥–ª—è exclusive posts\n\t\t\tif (idRegularUser && idProfile) {\n\t\t\t\tconst ttResult = await checkDialogRestrictions(idProfile, idRegularUser);\n\t\t\t\tlogRestrictionsCheck(idRegularUser, ttResult);\n\t\t\t\t\n\t\t\t\tif (ttResult.success) {\n\t\t\t\t\tsetHasExclusivePosts(ttResult.hasExclusivePosts);\n\t\t\t\t\tsetTtCategories(ttResult.categories);\n\t\t\t\t\tsetTtTier(ttResult.tier);\n\t\t\t\t} else {\n\t\t\t\t\t// Fallback –ø—Ä–∏ –ø–æ–º–∏–ª—Ü—ñ\n\t\t\t\t\tsetHasExclusivePosts(false);\n\t\t\t\t\tsetTtCategories([]);\n\t\t\t\t\tsetTtTier(undefined);\n\t\t\t\t}\n\t\t\t}\n\n\t\t} catch (error) {\n\t\t\tconsole.error('Failed to load restrictions:', error);\n\t\t\t// –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ fallback –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –æ–±–æ—Ö –ª—ñ—á—ñ–ª—å–Ω–∏–∫—ñ–≤\n\t\t\tif (messagesLeft === null) setMessagesLeft(0);\n\t\t\tsetLettersLeft(0);\n\t\t\t// –¢–∞–∫–æ–∂ —Å–∫–∏–¥–∞—î–º–æ TT —Å—Ç–∞–Ω–∏ –ø—Ä–∏ –ø–æ–º–∏–ª—Ü—ñ\n\t\t\tsetHasExclusivePosts(false);\n\t\t\tsetTtCategories([]);\n\t\t\tsetTtTier(undefined);\n\t\t} finally {\n\t\t\tsetIsLoadingRestrictions(false);\n\t\t}\n\t};\n\n\tconst loadPostDetails = async (idPost: number) => {\n\t\ttry {\n\t\t\tconsole.log('üéØ loadPostDetails called:', { idPost, dialogId, idProfile, idRegularUser });\n\t\t\tsetIsLoadingPost(true);\n\t\t\tconst response = await apiPost<{ success: boolean; data?: any; error?: string }>('/api/chats/tt-post-details', {\n\t\t\t\tidPost,\n\t\t\t\tidProfile: idProfile,\n\t\t\t\tidInterlocutor: idRegularUser\n\t\t\t});\n\t\t\tconsole.log('üì§ API request:', { idPost, idProfile, idInterlocutor: idRegularUser });\n\n\t\t\tif (response.success && response.data) {\n\t\t\t\tsetSelectedPost(response.data);\n\t\t\t\tsetIsPostModalOpen(true);\n\t\t\t} else {\n\t\t\t\tconsole.error('Failed to load post details:', response.error);\n\t\t\t\tconsole.error('–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –ø–æ—Å—Ç');\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('Error loading post details:', error);\n\t\t\tconsole.error('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ –ø–æ—Å—Ç–∞');\n\t\t} finally {\n\t\t\tsetIsLoadingPost(false);\n\t\t}\n\t};\n\n\tconst loadGiftLimits = async () => {\n\t\t// –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ race condition –¥–ª—è –ª—ñ–º—ñ—Ç—ñ–≤\n\t\tif (isLoadingGiftLimit) {\n\t\t\tconsole.log('üéÅ Skipping loadGiftLimits - already loading');\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tsetIsLoadingGiftLimit(true);\n\t\t\tconsole.log('üéÅ Loading gift limits for dialog:', dialogId, 'client:', idRegularUser);\n\n\t\t\t// –†–æ–±–∏–º–æ –∑–∞–ø–∏—Ç –¥–æ –Ω–∞—à–æ–≥–æ API –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ª—ñ–º—ñ—Ç—ñ–≤ –ø–æ–¥–∞—Ä—É–Ω–∫—ñ–≤\n\t\t\tconst response = await apiPost<{ success: boolean; data?: VirtualGiftLimit; error?: string }>(`/profiles/${sourceProfile?.id}/gift-limits`, {\n\t\t\t\tclientId: idRegularUser\n\t\t\t});\n\n\t\t\tif (response.success && response.data) {\n\t\t\t\tconsole.log('‚úÖ Gift limits loaded:', response.data);\n\t\t\t\tsetGiftLimit(response.data);\n\t\t\t} else {\n\t\t\t\tconsole.warn('Failed to load gift limits:', response.error);\n\t\t\t\tsetGiftLimit(null);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('Failed to load gift limits:', error);\n\t\t\tsetGiftLimit(null);\n\t\t} finally {\n\t\t\tsetIsLoadingGiftLimit(false);\n\t\t}\n\t};\n\n\tconst loadGifts = async (isInitial = true) => {\n\t\t// –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ race condition\n\t\tif (isLoadingGiftsRef.current) {\n\t\t\tconsole.log('üéÅ Skipping loadGifts - already loading');\n\t\t\treturn;\n\t\t}\n\n\t\t// –°–∫–∞—Å–æ–≤—É—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∑–∞–ø–∏—Ç —è–∫—â–æ –≤—ñ–Ω —ñ—Å–Ω—É—î\n\t\tif (abortControllerRef.current) {\n\t\t\tabortControllerRef.current.abort();\n\t\t}\n\n\t\t// –°—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤–∏–π AbortController\n\t\tabortControllerRef.current = new AbortController();\n\n\t\ttry {\n\t\t\tisLoadingGiftsRef.current = true;\n\n\t\t\tif (isInitial) {\n\t\t\t\tsetIsLoadingGifts(true);\n\t\t\t\tsetGiftItems([]);\n\t\t\t\tsetGiftCursor('');\n\t\t\t\tsetHasMoreGifts(true);\n\t\t\t} else {\n\t\t\t\tsetIsLoadingGifts(true);\n\t\t\t}\n\n\t\t\tconsole.log('üéÅ Loading gifts for client:', idRegularUser, 'cursor:', giftCursor);\n\n\t\t\t// –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —É–≤—ñ–º–∫–Ω–µ–Ω–∏–π mock —Ä–µ–∂–∏–º\n\t\t\tconst isMockMode = process.env.NODE_ENV === 'development' && localStorage.getItem('mockMode') === 'true';\n\t\t\tconsole.log('üé≠ Mock mode:', isMockMode ? 'enabled' : 'disabled');\n\n\t\t\t// –†–æ–±–∏–º–æ –∑–∞–ø–∏—Ç –¥–æ –Ω–∞—à–æ–≥–æ API –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–ø–∏—Å–∫—É –ø–æ–¥–∞—Ä—É–Ω–∫—ñ–≤\n\t\t\tconst response = await apiPost<{ success: boolean; data?: VirtualGiftListResponse; error?: string }>(`/profiles/${sourceProfile?.id}/gift-list`, {\n\t\t\t\tclientId: idRegularUser,\n\t\t\t\tcursor: isInitial ? '' : giftCursor,\n\t\t\t\tlimit: 30\n\t\t\t}, {\n\t\t\t\tsignal: abortControllerRef.current.signal\n\t\t\t});\n\n\t\t\tif (response.success && response.data) {\n\t\t\t\tconsole.log('‚úÖ Gifts loaded:', response.data.items.length, 'items');\n\n\t\t\t\t// –õ–æ–≥—É—î–º–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –ø–µ—Ä—à—ñ –∫—ñ–ª—å–∫–∞ –∑–æ–±—Ä–∞–∂–µ–Ω—å –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏\n\t\t\t\tresponse.data.items.slice(0, 3).forEach((gift, index) => {\n\t\t\t\t\tconst displaySrc = gift.imageSrc || gift.animationSrc;\n\t\t\t\t\tconst isAnimated = !!gift.animationSrc;\n\t\t\t\t\tconst animationType = gift.animationSrc?.endsWith('.json') ? 'JSON/Lottie' :\n\t\t\t\t\t\t\t\t\t\tgift.animationSrc?.endsWith('.gif') || gift.animationSrc?.includes('gif') ? 'GIF' :\n\t\t\t\t\t\t\t\t\t\tgift.animationSrc ? 'Other' : 'Static';\n\t\t\t\t\tconsole.log(`üéÅ Gift ${index + 1}: ${gift.name}${isAnimated ? ` (${animationType})` : ''}, src: ${displaySrc}`);\n\t\t\t\t\tconsole.log(`üéÅ Final URL for ${gift.name}:`, displaySrc.startsWith('http') || displaySrc.startsWith('//')\n\t\t\t\t\t\t? displaySrc.startsWith('//') ? `https:${displaySrc}` : displaySrc\n\t\t\t\t\t\t: `https://talkytimes.com${displaySrc}`);\n\t\t\t\t});\n\n\t\t\t\tif (isInitial) {\n\t\t\t\t\tsetGiftItems(response.data.items);\n\t\t\t\t} else {\n\t\t\t\t\t// –î–æ–¥–∞—î–º–æ –Ω–æ–≤—ñ –ø–æ–¥–∞—Ä—É–Ω–∫–∏ –¥–æ —ñ—Å–Ω—É—é—á–∏—Ö\n\t\t\t\t\tsetGiftItems(prev => [...prev, ...response.data!.items]);\n\t\t\t\t}\n\n\t\t\t\tsetGiftCursor(response.data.cursor);\n\t\t\t\tsetHasMoreGifts(response.data.items.length === 30); // –Ø–∫—â–æ –æ—Ç—Ä–∏–º–∞–ª–∏ –ø–æ–≤–Ω–∏–π –ª—ñ–º—ñ—Ç, –º–æ–∂–ª–∏–≤–æ —î —â–µ\n\t\t\t} else {\n\t\t\t\tconsole.warn('Failed to load gifts:', response.error);\n\t\t\t\tsetGiftItems([]);\n\t\t\t\tsetHasMoreGifts(false);\n\t\t\t}\n\t\t} catch (error: any) {\n\t\t\t// –ù–µ –ª–æ–≥—É—î–º–æ –ø–æ–º–∏–ª–∫–∏ –¥–ª—è —Å–∫–∞—Å–æ–≤–∞–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤\n\t\t\tif (error.name !== 'AbortError') {\n\t\t\t\tconsole.error('‚ùå Failed to load gifts:', error);\n\t\t\t\tsetGiftItems([]);\n\t\t\t\tsetHasMoreGifts(false);\n\t\t\t} else {\n\t\t\t\tconsole.log('üéÅ Gift loading was cancelled');\n\t\t\t}\n\t\t} finally {\n\t\t\tsetIsLoadingGifts(false);\n\t\t\tisLoadingGiftsRef.current = false;\n\t\t\tabortControllerRef.current = null;\n\t\t}\n\t};\n\n\t// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ—á–∏—â–µ–Ω–Ω—è –∫–µ—à–∞ —Å—Ç—ñ–∫–µ—Ä—ñ–≤ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø—Ä–∏–º—É—Å–æ–≤–æ –æ–Ω–æ–≤–∏—Ç–∏)\n\tconst clearStickersCache = () => {\n\t\tstickersCache.current = null;\n\t\tconsole.log('üóëÔ∏è Stickers cache cleared');\n\t};\n\n\tconst loadStickers = async () => {\n\t\ttry {\n\t\t\t// –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –∫–µ—à —Å–ø–æ—á–∞—Ç–∫—É\n\t\t\tconst now = Date.now();\n\t\t\tif (\n\t\t\t\tstickersCache.current &&\n\t\t\t\tstickersCache.current.profileId === idProfile.toString() &&\n\t\t\t\t(now - stickersCache.current.timestamp) < STICKERS_CACHE_TTL\n\t\t\t) {\n\t\t\t\tconsole.log('üìã Using cached stickers (age:', Math.round((now - stickersCache.current.timestamp) / 1000), 'seconds)');\n\t\t\t\tsetStickerCategories(stickersCache.current.data);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetIsLoadingStickers(true);\n\t\t\tconsole.log('üì• Loading stickers from server...');\n\n\t\t\t// –í–∏–∫–ª–∏–∫–∞—î–º–æ API –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å—Ç—ñ–∫–µ—Ä—ñ–≤\n\t\t\tconst response = await apiPost<{ categories: StickerCategory[] }>(`/api/chats/stickers`, {\n\t\t\t\tidInterlocutor: idRegularUser\n\t\t\t});\n\n\t\t\tif (response.categories && Array.isArray(response.categories)) {\n\t\t\t\tsetStickerCategories(response.categories);\n\n\t\t\t\t// –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ –∫–µ—à\n\t\t\t\tstickersCache.current = {\n\t\t\t\t\tdata: response.categories,\n\t\t\t\t\ttimestamp: now,\n\t\t\t\t\tprofileId: idProfile.toString()\n\t\t\t\t};\n\n\t\t\t\tconsole.log(`‚úÖ Loaded ${response.categories.length} sticker categories and cached them`);\n\t\t\t} else {\n\t\t\t\tconsole.warn('Invalid stickers response:', response);\n\t\t\t\tsetStickerCategories([]);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('Failed to load stickers:', error);\n\t\t\t// –û—á–∏—â—É—î–º–æ –∫–µ—à –ø—Ä–∏ –ø–æ–º–∏–ª—Ü—ñ, —â–æ–± –ø—Ä–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ–π —Å–ø—Ä–æ–±—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å–≤—ñ–∂—ñ –¥–∞–Ω—ñ\n\t\t\tstickersCache.current = null;\n\t\t\tsetStickerCategories([]);\n\t\t} finally {\n\t\t\tsetIsLoadingStickers(false);\n\t\t}\n\t};\n\n\t// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ª—ñ—á–∏–ª—å–Ω–∏–∫—ñ–≤ –ø—ñ—Å–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è\n\tconst updateCountersAfterSend = () => {\n\t\t// –ó–º–µ–Ω—à—É—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —è–∫—â–æ –≤—ñ–Ω –±—ñ–ª—å—à–µ 0\n\t\tif (messagesLeft && messagesLeft > 0) {\n\t\t\tconst newMessagesLeft = messagesLeft - 1;\n\t\t\tsetMessagesLeft(newMessagesLeft);\n\t\t\t// –û–Ω–æ–≤–ª—é—î–º–æ localStorage\n\t\t\tlocalStorage.setItem(`messagesLeft_${dialogId}`, newMessagesLeft.toString());\n\t\t}\n\t};\n\n\t// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ä—ñ—à–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å\n\tconst loadMoreMessages = async () => {\n\t\tif (!hasMoreMessages || isLoadingMore || isLoadingMessages || !cursor || !canLoadMore.current) return;\n\t\t\n\t\tcanLoadMore.current = false; // –ë–ª–æ–∫—É—î–º–æ –ø–æ–≤—Ç–æ—Ä–Ω—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è\n\t\tconsole.log(`üîÑ Loading more messages with cursor: ${cursor}`);\n\t\tawait loadMessages(false);\n\t};\n\n\t// –û–±—Ä–æ–±–Ω–∏–∫ —Å–∫—Ä–æ–ª—É –¥–ª—è –ø–∞–≥—ñ–Ω–∞—Ü—ñ—ó\n\tconst handleScroll = (e: React.UIEvent<HTMLDivElement>) => {\n\t\tconst { scrollTop } = e.currentTarget;\n\t\t\n\t\t// –û—á–∏—â—É—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π timeout\n\t\tif (loadingTimeoutRef.current) {\n\t\t\tclearTimeout(loadingTimeoutRef.current);\n\t\t}\n\t\t\n\t\t// –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —Å–∫—Ä–æ–ª–∏–º–æ –≤–≥–æ—Ä—É\n\t\tconst isScrollingUp = scrollTop < lastScrollTop.current;\n\t\tlastScrollTop.current = scrollTop;\n\t\t\n\t\t// –¢–Ü–õ–¨–ö–ò —è–∫—â–æ –¥–æ—Å–∫—Ä–æ–ª–∏–ª–∏ –¥–æ —Å–∞–º–æ–≥–æ –≤–µ—Ä—Ö—É (–º–µ–Ω—à–µ 20px) —ñ —Å–∫—Ä–æ–ª–∏–ª–∏ –≤–≥–æ—Ä—É\n\t\tif (\n\t\t\tscrollTop <= 20 && \n\t\t\tisScrollingUp &&\n\t\t\thasMoreMessages && \n\t\t\t!isLoadingMore && \n\t\t\t!isLoadingMessages &&\n\t\t\tcursor &&\n\t\t\tcanLoadMore.current\n\t\t) {\n\t\t\t// –î–æ–¥–∞—î–º–æ debounce 300ms\n\t\t\tloadingTimeoutRef.current = setTimeout(() => {\n\t\t\t\tconsole.log(`üîÑ At top! Triggering pagination: scrollTop=${scrollTop}, canLoad=${canLoadMore.current}`);\n\t\t\t\tloadMoreMessages();\n\t\t\t}, 300);\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tconst token = getAccessToken();\n\t\tconst apiUrl = typeof window !== 'undefined' ? window.location.origin : (process.env.NEXT_PUBLIC_SOCKET_BASE || process.env.NEXT_PUBLIC_API_URL || 'http://localhost:4000');\n\t\tlet socket: any = null;\n\t\tlet isCleanedUp = false;\n\t\t\n\t\t// –°–¢–ê–†–ò–ô –ö–û–î - –ó–ê–ö–û–ú–ï–ù–¢–û–í–ê–ù–û, –í–ò–ö–û–†–ò–°–¢–û–í–£–Ñ–ú–û WEBSOCKET POOL\n\t\t/*\n\t\tconst connectTimeout = setTimeout(() => {\n\t\t\tif (isCleanedUp) return;\n\t\t\t\n\t\t\tsocket = io(`${apiUrl}/ws`, { \n\t\t\t\ttransports: ['websocket'], \n\t\t\t\tauth: token ? { token } : undefined,\n\t\t\t\tforceNew: true, // –ó–∞–≤–∂–¥–∏ —Å—Ç–≤–æ—Ä—é—î–º–æ –Ω–æ–≤–µ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è\n\t\t\t\ttimeout: 5000 // –¢–∞–π–º–∞—É—Ç –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è 5 —Å–µ–∫—É–Ω–¥\n\t\t\t});\n\t\t\t\n\t\t\t// –û–±—Ä–æ–±–ª—è—î–º–æ –ø–æ–º–∏–ª–∫–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è\n\t\t\tsocket.on('connect_error', (error: Error) => {\n\t\t\t\tconsole.warn('üîå WebSocket connection error:', error.message);\n\t\t\t});\n\t\t\t\n\t\t\tsocket.on('disconnect', (reason: string) => {\n\t\t\t\tconsole.log('üîå WebSocket disconnected:', reason);\n\t\t\t});\n\t\t\t\n\t\t\tsocket.on('connect', () => {\n\t\t\t\tif (isCleanedUp) return;\n\t\t\t\tconsole.log('üîå WebSocket connected for dialog:', dialogId);\n\t\t\t\t// –ü—ñ–¥–∫–ª—é—á–∞—î–º–æ—Å—è –¥–æ –∫—ñ–º–Ω–∞—Ç–∏ –¥—ñ–∞–ª–æ–≥—É —Ç—ñ–ª—å–∫–∏ –ø—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è\n\t\t\t\tsocket.emit('join', { dialogId });\n\t\t\t});\n\t\t\t\n\t\t\t// –û–±—Ä–æ–±–ª—è—î–º–æ –Ω–æ–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ RTM\n\t\t\tsocket.on('message', (payload: ChatMessage) => {\n\t\t\t\tif (isCleanedUp) return;\n\t\t\t\tconsole.log('üì® RTM: Received new message', payload);\n\t\t\t\t\n\t\t\t\tsetMessages((prev) => {\n\t\t\t\t\t// –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤–∂–µ —ñ—Å–Ω—É—î\n\t\t\t\t\tconst exists = prev.some(msg => msg.id === payload.id);\n\t\t\t\t\tif (exists) {\n\t\t\t\t\t\treturn prev;\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tconst newMessages = [...prev, payload].sort((a, b) => \n\t\t\t\t\t\tnew Date(a.dateCreated).getTime() - new Date(b.dateCreated).getTime()\n\t\t\t\t\t);\n\t\t\t\t\t\n\t\t\t\t\t// –û–Ω–æ–≤–ª—é—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —è–∫—â–æ —Ü–µ –Ω–∞—à–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è\n\t\t\t\t\tif (payload.idUserFrom === idProfile) {\n\t\t\t\t\t\tupdateCountersAfterSend();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\treturn newMessages;\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\t// –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–æ–∫—Ä—É—á—É—î–º–æ –¥–æ –Ω–∏–∑—É –ø—Ä–∏ –Ω–æ–≤–æ–º—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—ñ\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tbottomRef.current?.scrollIntoView({ behavior: 'smooth' });\n\t\t\t\t}, 100);\n\t\t\t});\n\t\t\t\n\t\t\t// –û–±—Ä–æ–±–ª—è—î–º–æ –∑–º—ñ–Ω–∏ –æ–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å—É\n\t\t\tsocket.on('user_online_status', (data: { userId: number; isOnline: boolean }) => {\n\t\t\t\tif (isCleanedUp) return;\n\t\t\t\tconsole.log('üë§ RTM: User online status changed', data);\n\t\t\t\t\n\t\t\t\t// –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç—É—Å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —è–∫—â–æ —Ü–µ –Ω–∞—à —Å–ø—ñ–≤—Ä–æ–∑–º–æ–≤–Ω–∏–∫\n\t\t\t\tif (data.userId === idRegularUser) {\n\t\t\t\t\tsetUserProfile(prev => prev ? { ...prev, is_online: data.isOnline } : null);\n\t\t\t\t}\n\t\t\t});\n\t\t}, 100); // –ó–∞—Ç—Ä–∏–º–∫–∞ 100–º—Å –¥–ª—è —É–Ω–∏–∫–Ω–µ–Ω–Ω—è –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤\n\t\t*/\n\t\t\n\t\treturn () => {\n\t\t\t// –°–¢–ê–†–ò–ô CLEANUP –ö–û–î - –ó–ê–ö–û–ú–ï–ù–¢–û–í–ê–ù–û\n\t\t\t/*\n\t\t\tisCleanedUp = true;\n\t\t\tclearTimeout(connectTimeout);\n\t\t\t\n\t\t\t// –Ø–∫—â–æ socket —Å—Ç–≤–æ—Ä–µ–Ω–∏–π, –∑–∞–∫—Ä–∏–≤–∞—î–º–æ –π–æ–≥–æ\n\t\t\tif (socket && socket.connected) {\n\t\t\t\tsocket.emit('leave', { dialogId });\n\t\t\t\tsocket.disconnect();\n\t\t\t}\n\t\t\t*/\n\t\t\t\n\t\t\t// –û—á–∏—â—É—î–º–æ timeouts –ø—Ä–∏ unmount\n\t\t\tif (loadingTimeoutRef.current) {\n\t\t\t\tclearTimeout(loadingTimeoutRef.current);\n\t\t\t}\n\t\t\tif (unlockTimeoutRef.current) {\n\t\t\t\tclearTimeout(unlockTimeoutRef.current);\n\t\t\t}\n\t\t};\n\t}, [dialogId, idProfile, idRegularUser]);\n\n\t\t// –û–±—Ä–æ–±–∫–∞ –∑–∞–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–∏—Ö –≤—ñ–∫–æ–Ω –ø–æ Escape\n\tuseEffect(() => {\n\t\tconst handleEscape = (event: KeyboardEvent) => {\n\t\t\tif (event.key === 'Escape') {\n\t\t\t\tif (isStickerModalOpen) {\n\t\t\t\t\tsetIsStickerModalOpen(false);\n\t\t\t\t}\n\t\t\t\tif (isGiftModalOpen) {\n\t\t\t\t\tsetIsGiftModalOpen(false);\n\t\t\t\t}\n\t\t\t\tif (isMessageModalOpen) {\n\t\t\t\t\tsetIsMessageModalOpen(false);\n\t\t\t\t}\n\t\t\t\tif (isEmailHistoryOpen) {\n\t\t\t\t\tsetIsEmailHistoryOpen(false);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tif (isStickerModalOpen || isGiftModalOpen || isMessageModalOpen || isEmailHistoryOpen) {\n\t\t\tdocument.addEventListener('keydown', handleEscape);\n\t\t}\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener('keydown', handleEscape);\n\t\t};\n\t}, [isStickerModalOpen, isGiftModalOpen, isMessageModalOpen, isEmailHistoryOpen]);\n\n\t// Cleanup Lottie –∞–Ω—ñ–º–∞—Ü—ñ–π —Ç–∞ –∑–∞–ø–∏—Ç—ñ–≤ –ø—Ä–∏ –∑–∞–∫—Ä–∏—Ç—Ç—ñ –º–æ–¥–∞–ª—å–Ω–∏—Ö –≤—ñ–∫–æ–Ω\n\tuseEffect(() => {\n\t\tif (!isGiftModalOpen && !isMessageModalOpen) {\n\t\t\tcleanupLottieAnimations();\n\t\t\tcleanupActiveRequests();\n\t\t}\n\t}, [isGiftModalOpen, isMessageModalOpen]);\n\n\t// –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ —ñ–Ω–ø—É—Ç –ø–æ–ª–µ –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —á–∞—Ç—É\n\tuseEffect(() => {\n\t\t// –ù–µ–≤–µ–ª–∏–∫–∞ –∑–∞—Ç—Ä–∏–º–∫–∞ —â–æ–± –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ–≤–Ω—ñ—Å—Ç—é –∑–∞–≤–∞–Ω—Ç–∞–∂–∏–≤—Å—è\n\t\tconst timer = setTimeout(() => {\n\t\t\tif (inputRef.current) {\n\t\t\t\tinputRef.current.focus();\n\t\t\t\t// –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –≤–∏—Å–æ—Ç–∏ textarea\n\t\t\t\tautoResizeTextarea(inputRef.current);\n\t\t\t}\n\t\t}, 100);\n\n\t\treturn () => clearTimeout(timer);\n\t}, []);\n\n\t// –ì–ª–æ–±–∞–ª—å–Ω–∏–π cleanup –ø—Ä–∏ unmount –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞\n\tuseEffect(() => {\n\t\treturn () => {\n\t\t\tconsole.log('üßπ Component unmounting, cleaning up all resources...');\n\n\t\t\t// –û—á–∏—â—É—î–º–æ –≤—Å—ñ timeouts\n\t\t\tif (loadingTimeoutRef.current) {\n\t\t\t\tclearTimeout(loadingTimeoutRef.current);\n\t\t\t\tloadingTimeoutRef.current = null;\n\t\t\t}\n\t\t\tif (unlockTimeoutRef.current) {\n\t\t\t\tclearTimeout(unlockTimeoutRef.current);\n\t\t\t\tunlockTimeoutRef.current = null;\n\t\t\t}\n\t\t\t\n\t\t\t// –û—á–∏—â—É—î–º–æ Lottie –∞–Ω—ñ–º–∞—Ü—ñ—ó\n\t\t\tcleanupLottieAnimations();\n\t\t\t\n\t\t\t// –û—á–∏—â—É—î–º–æ –∞–∫—Ç–∏–≤–Ω—ñ –∑–∞–ø–∏—Ç–∏\n\t\t\tcleanupActiveRequests();\n\t\t\t\n\t\t\t// –û—á–∏—â—É—î–º–æ –≥–ª–æ–±–∞–ª—å–Ω—ñ event listeners —è–∫—â–æ —î\n\t\t\tif (typeof window !== 'undefined') {\n\t\t\t\t// –í–∏–¥–∞–ª—è—î–º–æ –≤—Å—ñ –º–æ–∂–ª–∏–≤—ñ event listeners\n\t\t\t\twindow.removeEventListener('beforeunload', cleanupLottieAnimations);\n\t\t\t\twindow.removeEventListener('unload', cleanupLottieAnimations);\n\t\t\t}\n\t\t};\n\t}, []); // –ü–æ—Ä–æ–∂–Ω—ñ–π –º–∞—Å–∏–≤ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π - –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –ø—Ä–∏ unmount\n\n\t// –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ WebSocket pool –¥–ª—è —Ü—å–æ–≥–æ –ø—Ä–æ—Ñ—ñ–ª—é —Ç–∞ –¥—ñ–∞–ª–æ–≥—É\n\tuseDialogWebSocket({\n\t\tprofileId: idProfile.toString(),\n\t\tdialogId,\n\t\tonMessage: (payload: ChatMessage) => {\n\t\t\tconsole.log('üì® RTM Pool: Received new message', payload);\n\n\t\t\t// –ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è –≤—Ö—ñ–¥–Ω–æ–≥–æ payload\n\t\t\tconst normalized: ChatMessage = {\n\t\t\t\tid: Number((payload as any).id) || Date.now(),\n\t\t\t\tidUserFrom: Number((payload as any).idUserFrom),\n\t\t\t\tidUserTo: Number((payload as any).idUserTo),\n\t\t\t\ttype: (payload as any).type || 'text',\n\t\t\t\tdateCreated: (() => {\n\t\t\t\t\tconst d = new Date((payload as any).dateCreated || Date.now());\n\t\t\t\t\treturn isNaN(d.getTime()) ? new Date().toISOString() : d.toISOString();\n\t\t\t\t})(),\n\t\t\t\tcontent: {\n\t\t\t\t\tmessage: (payload as any).content?.message || (payload as any).message?.message || (payload as any).text || '',\n\t\t\t\t\turl: (payload as any).content?.url,\n\t\t\t\t\tid: (payload as any).content?.id\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tsetMessages((prev) => {\n\t\t\t\t// –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤–∂–µ —ñ—Å–Ω—É—î\n\t\t\t\tconst exists = prev.some(msg => msg.id === normalized.id);\n\t\t\t\tif (exists) {\n\t\t\t\t\treturn prev;\n\t\t\t\t}\n\n\t\t\t\t// –Ø–∫—â–æ —Ü–µ —Å—Ç—ñ–∫–µ—Ä –≤—ñ–¥ –Ω–∞—Å —ñ —É –Ω–∞—Å —î –ª–æ–∫–∞–ª—å–Ω–∞ –≤–µ—Ä—Å—ñ—è –∑ —Ç–∏–º—á–∞—Å–æ–≤–∏–º ID,\n\t\t\t\t// –∑–∞–º—ñ–Ω—é—î–º–æ —ó—ó –Ω–∞ —Å–ø—Ä–∞–≤–∂–Ω—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞\n\t\t\t\tif (normalized.type === 'sticker' && normalized.idUserFrom === idProfile) {\n\t\t\t\t\tconst localStickerIndex = prev.findIndex(msg =>\n\t\t\t\t\t\tmsg.type === 'sticker' &&\n\t\t\t\t\t\tmsg.idUserFrom === idProfile &&\n\t\t\t\t\t\tmsg.idUserTo === idRegularUser &&\n\t\t\t\t\t\tmsg.content.id === normalized.content.id &&\n\t\t\t\t\t\t(msg as any).isSending === true\n\t\t\t\t\t);\n\n\t\t\t\t\tif (localStickerIndex !== -1) {\n\t\t\t\t\t\tconst newMessages = [...prev];\n\t\t\t\t\t\tnewMessages[localStickerIndex] = normalized;\n\t\t\t\t\t\treturn newMessages.sort((a, b) =>\n\t\t\t\t\t\t\tnew Date(a.dateCreated).getTime() - new Date(b.dateCreated).getTime()\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst newMessages = [...prev, normalized].sort((a, b) =>\n\t\t\t\t\tnew Date(a.dateCreated).getTime() - new Date(b.dateCreated).getTime()\n\t\t\t\t);\n\n\t\t\t\t// –û–Ω–æ–≤–ª—é—î–º–æ –ª—ñ—á—ñ–ª—å–Ω–∏–∫ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å —è–∫—â–æ —Ü–µ –Ω–∞—à–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è\n\t\t\t\tif (normalized.idUserFrom === idProfile) {\n\t\t\t\t\tupdateCountersAfterSend();\n\t\t\t\t}\n\n\t\t\t\treturn newMessages;\n\t\t\t});\n\n\t\t\t// –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–æ–∫—Ä—É—á—É—î–º–æ –¥–æ –Ω–∏–∑—É –ø—Ä–∏ –Ω–æ–≤–æ–º—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—ñ\n\t\t\tsetTimeout(() => {\n\t\t\t\tbottomRef.current?.scrollIntoView({ behavior: 'smooth' });\n\t\t\t}, 100);\n\t\t},\n\t\tonUserOnlineStatus: (data: { userId: number; isOnline: boolean }) => {\n\t\t\tconsole.log('üë§ RTM Pool: User online status changed', data);\n\n\t\t\t// –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞—Ç—É—Å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —è–∫—â–æ —Ü–µ –Ω–∞—à —Å–ø—ñ–≤—Ä–æ–∑–º–æ–≤–Ω–∏–∫\n\t\t\tif (data.userId === idRegularUser) {\n\t\t\t\tsetUserProfile(prev => prev ? { ...prev, is_online: data.isOnline } : null);\n\t\t\t}\n\t\t},\n\t\tonDialogLimitChanged: (data: { idUser: number; idInterlocutor: number; limitLeft: number }) => {\n\t\t\t// –û–Ω–æ–≤–ª—é—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫ –ª–∏—à–µ –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –¥—ñ–∞–ª–æ–≥—É\n\t\t\tif (data.idUser === idProfile && data.idInterlocutor === idRegularUser) {\n\t\t\t\tsetMessagesLeft(data.limitLeft ?? messagesLeft);\n\t\t\t\tif (typeof data.limitLeft === 'number') {\n\t\t\t\t\tlocalStorage.setItem(`messagesLeft_${dialogId}`, String(data.limitLeft));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\tasync function send() {\n\t\tif (!text.trim()) return;\n\t\tawait apiPost(`/api/chats/dialogs/${encodeURIComponent(dialogId)}/text`, { text });\n\t\tsetText('');\n\t\t// –°–ø–æ–≤—ñ—â–∞—î–º–æ —Å–ø–∏—Å–æ–∫ ¬´–í—Ö—ñ–¥–Ω—ñ¬ª –ø—Ä–æ –≤–∏—Ö—ñ–¥–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ü—å–æ–≥–æ –¥—ñ–∞–ª–æ–≥—É\n\t\ttry {\n\t\t\twindow.dispatchEvent(new CustomEvent('dialog:sent', { detail: { profileId: idProfile, clientId: idRegularUser, kind: 'text' } }));\n\t\t} catch {}\n\t}\n\n\t// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –µ–º–æ–¥–∑—ñ –¥–æ —Ç–µ–∫—Å—Ç—É\n\tconst handleEmojiSelect = (emoji: string) => {\n\t\tsetText(prev => prev + emoji);\n\t};\n\n\t// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è textarea\n\tconst autoResizeTextarea = (textarea: HTMLTextAreaElement) => {\n\t\ttextarea.style.height = 'auto';\n\t\tconst scrollHeight = textarea.scrollHeight;\n\t\tconst maxHeight = 120; // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –≤–∏—Å–æ—Ç–∞ –≤ –ø—ñ–∫—Å–µ–ª—è—Ö\n\t\tconst newHeight = Math.min(scrollHeight, maxHeight);\n\t\ttextarea.style.height = newHeight + 'px';\n\t};\n\n\t// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –µ–º–æ–¥–∑—ñ –¥–æ —Ç–µ–∫—Å—Ç—É –ø–æ—Å—Ç—ñ–≤\n\tconst handlePostEmojiSelect = (emoji: string) => {\n\t\tsetExclusiveText(prev => prev + emoji);\n\t};\n\n\t// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –µ–º–æ–¥–∑—ñ –¥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –ø–æ–¥–∞—Ä—É–Ω–∫—ñ–≤\n\tconst handleGiftEmojiSelect = (emoji: string) => {\n\t\tsetGiftMessage(prev => prev + emoji);\n\t};\n\n\t// –û–±—Ä–æ–±–∫–∞ –≤–∏–±–æ—Ä—É —Ñ–æ—Ç–æ –∑ –≥–∞–ª–µ—Ä–µ—ó\n\tconst handlePhotoSelect = async (selectedPhotos: Photo[]) => {\n\t\tconsole.log('Selected photos:', selectedPhotos);\n\n\t\t// –û–ø—Ç–∏–º—ñ—Å—Ç–∏—á–Ω–µ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ —Ñ–æ—Ç–æ –æ–¥—Ä–∞–∑—É\n\t\tconst localPhotoMessage: ChatMessage = {\n\t\t\tid: Date.now(),\n\t\t\tdateCreated: new Date().toISOString(),\n\t\t\tidUserFrom: idProfile,\n\t\t\tidUserTo: idRegularUser,\n\t\t\ttype: 'photo_batch',\n\t\t\tcontent: {\n\t\t\t\tphotos: selectedPhotos.map(p => ({ id: p.idPhoto, url: p.urls.urlPreview }))\n\t\t\t},\n\t\t\tisSending: true\n\t\t};\n\n\t\tsetMessages(prev => [...prev, localPhotoMessage].sort((a, b) =>\n\t\t\tnew Date(a.dateCreated).getTime() - new Date(b.dateCreated).getTime()\n\t\t));\n\t\tsetTimeout(() => bottomRef.current?.scrollIntoView({ behavior: 'smooth' }), 50);\n\n\t\tsetIsChatGalleryOpen(false);\n\t};\n\n\t// –û–±—Ä–æ–±–∫–∞ –≤–∏–±–æ—Ä—É –ø–æ–¥–∞—Ä—É–Ω–∫—É\n\tconst handleGiftSelect = async (gift: VirtualGiftItem) => {\n\t\tconsole.log('üéÅ Selected gift:', gift);\n\t\tconsole.log('Dialog info:', { idProfile, idRegularUser });\n\n\t\t// –ó–∞–∫—Ä–∏–≤–∞—î–º–æ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –ø–æ–¥–∞—Ä—É–Ω–∫—ñ–≤\n\t\tsetIsGiftModalOpen(false);\n\n\t\t// –í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ –¥—ñ–∞–ª–æ–≥ –≤–≤–µ–¥–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è\n\t\tsetSelectedGift(gift);\n\t\tsetGiftMessage(''); // –û—á–∏—â—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è\n\t\tsetIsMessageModalOpen(true);\n\t};\n\n\tconst handleSendGift = async () => {\n\t\tif (!selectedGift || !sourceProfile?.id) return;\n\n\t\ttry {\n\t\t\tsetIsSendingGift(true);\n\n\t\t\tconsole.log('üì§ Sending gift:', {\n\t\t\t\tgiftId: selectedGift.id,\n\t\t\t\tfromProfile: sourceProfile.id,\n\t\t\t\ttoClient: idRegularUser,\n\t\t\t\tmessage: giftMessage\n\t\t\t});\n\n\t\t\tconst response = await apiPost<{ success: boolean; data?: any; error?: string }>(`/profiles/${sourceProfile.id}/send-gift`, {\n\t\t\t\tclientId: idRegularUser,\n\t\t\t\tgiftId: selectedGift.id,\n\t\t\t\tmessage: giftMessage\n\t\t\t});\n\n\t\t\tif (response.success) {\n\t\t\t\tconsole.log('‚úÖ Gift sent successfully:', response.data);\n\n\t\t\t\t// –ü–æ–∫–∞–∑—É—î–º–æ —É—Å–ø—ñ—à–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è\n\t\t\t\tconsole.log(`üéÅ –ü–æ–¥–∞—Ä—É–Ω–æ–∫ \"${selectedGift.name}\" –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ!`);\n\n\t\t\t\t// –ó–∞–∫—Ä–∏–≤–∞—î–º–æ –¥—ñ–∞–ª–æ–≥\n\t\t\t\tsetIsMessageModalOpen(false);\n\t\t\t\tsetSelectedGift(null);\n\t\t\t\tsetGiftMessage('');\n\n\t\t\t\t// –ú–æ–∂–ª–∏–≤–æ –æ–Ω–æ–≤–∏—Ç–∏ –ª—ñ–º—ñ—Ç –ø–æ–¥–∞—Ä—É–Ω–∫—ñ–≤\n\t\t\t\tloadGiftLimits();\n\n\t\t\t\t// –°–ø–æ–≤—ñ—â–∞—î–º–æ —Å–ø–∏—Å–æ–∫ ¬´–í—Ö—ñ–¥–Ω—ñ¬ª –ø—Ä–æ –≤–∏—Ö—ñ–¥–Ω–µ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è\n\t\t\t\ttry {\n\t\t\t\t\twindow.dispatchEvent(new CustomEvent('dialog:sent', { detail: { profileId: idProfile, clientId: idRegularUser, kind: 'gift' } }));\n\t\t\t\t} catch {}\n\n\t\t\t} else {\n\t\t\t\tconsole.error('‚ùå Failed to send gift:', response.error);\n\t\t\t\tconsole.error(`‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏: ${response.error || '–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞'}`);\n\t\t\t}\n\n\t\t} catch (error: any) {\n\t\t\tconsole.error('‚ùå Error sending gift:', error);\n\t\t\tconsole.error(`‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏: ${error.message || '–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞'}`);\n\t\t} finally {\n\t\t\tsetIsSendingGift(false);\n\t\t}\n\t};\n\n\t// –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –±—ñ–ª—å—à–µ –ø–æ–¥–∞—Ä—É–Ω–∫—ñ–≤ –¥–ª—è –ø–∞–≥—ñ–Ω–∞—Ü—ñ—ó\n\tconst loadMoreGifts = async () => {\n\t\tif (!hasMoreGifts || isLoadingGifts || !giftCursor || isLoadingGiftsRef.current) {\n\t\t\tconsole.log('üîÑ Skipping loadMoreGifts - conditions not met');\n\t\t\treturn;\n\t\t}\n\t\tconsole.log('üîÑ Loading more gifts with cursor:', giftCursor);\n\t\tawait loadGifts(false);\n\t};\n\n\t// –û–±—Ä–æ–±–∫–∞ –≤–∏–±–æ—Ä—É —Å—Ç—ñ–∫–µ—Ä–∞\n\tconst handleStickerSelect = async (sticker: Sticker) => {\n\t\tconsole.log('Selected sticker:', sticker);\n\t\tconsole.log('Dialog info:', { idProfile, idRegularUser });\n\n\t\t// –°—Ç–≤–æ—Ä—é—î–º–æ –ª–æ–∫–∞–ª—å–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Å—Ç—ñ–∫–µ—Ä–∞ –¥–ª—è –Ω–µ–≥–∞–π–Ω–æ–≥–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è\n\t\tconst localStickerMessage: ChatMessage = {\n\t\t\tid: Date.now(), // –¢–∏–º—á–∞—Å–æ–≤–∏–π ID –¥–æ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∑ —Å–µ—Ä–≤–µ—Ä–∞\n\t\t\tdateCreated: new Date().toISOString(),\n\t\t\tidUserFrom: idProfile,\n\t\t\tidUserTo: idRegularUser,\n\t\t\ttype: 'sticker',\n\t\t\tcontent: {\n\t\t\t\tid: sticker.id,\n\t\t\t\turl: sticker.url\n\t\t\t},\n\t\t\tisSending: true // –ü–æ–∑–Ω–∞—á–∞—î–º–æ —â–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è\n\t\t};\n\n\t\t// –î–æ–¥–∞—î–º–æ —Å—Ç—ñ–∫–µ—Ä –¥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –Ω–µ–≥–∞–π–Ω–æ\n\t\tsetMessages(prev => [...prev, localStickerMessage].sort((a, b) =>\n\t\t\tnew Date(a.dateCreated).getTime() - new Date(b.dateCreated).getTime()\n\t\t));\n\n\t\t// –ü—Ä–æ–∫—Ä—É—á—É—î–º–æ –¥–æ–Ω–∏–∑—É –¥–ª—è –ø–æ–∫–∞–∑—É –Ω–æ–≤–æ–≥–æ —Å—Ç—ñ–∫–µ—Ä–∞\n\t\tsetTimeout(() => {\n\t\t\tbottomRef.current?.scrollIntoView({ behavior: 'smooth' });\n\t\t}, 100);\n\n\t\t// –ó–∞–∫—Ä–∏–≤–∞—î–º–æ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –æ–¥—Ä–∞–∑—É\n\t\tsetIsStickerModalOpen(false);\n\n\t\ttry {\n\t\t\t// –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –Ω–æ–≤–∏–π API –∑ —Ç—ñ–ª—å–∫–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏\n\t\t\tconst response = await apiPost('/api/chats/send-sticker', {\n\t\t\t\tstickerId: sticker.id,\n\t\t\t\tidRegularUser,\n\t\t\t\tidProfile // –î–æ–¥–∞—î–º–æ idProfile —è–≤–Ω–æ\n\t\t\t});\n\n\t\t\tif (response.success) {\n\t\t\t\tconsole.log('‚úÖ Successfully sent sticker');\n\t\t\t\t// –°—Ç—ñ–∫–µ—Ä –±—É–¥–µ –¥–æ–¥–∞–Ω–∏–π –≤ —á–∞—Ç —á–µ—Ä–µ–∑ WebSocket/RTM, –∞–ª–µ –≤—ñ–Ω –≤–∂–µ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –ª–æ–∫–∞–ª—å–Ω–æ\n\t\t\t\t// –ü–æ–∑–Ω–∞—á–∞—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —è–∫ —É—Å–ø—ñ—à–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–µ\n\t\t\t\tsetMessages(prev => prev.map(msg =>\n\t\t\t\t\tmsg.id === localStickerMessage.id\n\t\t\t\t\t\t? { ...msg, isSending: false }\n\t\t\t\t\t\t: msg\n\t\t\t\t));\n\t\t\t\t// –°–ø–æ–≤—ñ—â–∞—î–º–æ —Å–ø–∏—Å–æ–∫ ¬´–í—Ö—ñ–¥–Ω—ñ¬ª –ø—Ä–æ –≤–∏—Ö—ñ–¥–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è\n\t\t\t\ttry {\n\t\t\t\t\twindow.dispatchEvent(new CustomEvent('dialog:sent', { detail: { profileId: idProfile, clientId: idRegularUser, kind: 'sticker' } }));\n\t\t\t\t} catch {}\n\t\t\t} else {\n\t\t\t\tconsole.error('Failed to send sticker:', response.error);\n\t\t\t\t// –ü–æ–∑–Ω–∞—á–∞—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —è–∫ –ø–æ–º–∏–ª–∫–æ–≤–µ\n\t\t\t\tsetMessages(prev => prev.map(msg =>\n\t\t\t\t\tmsg.id === localStickerMessage.id\n\t\t\t\t\t\t? { ...msg, isSending: false, error: true }\n\t\t\t\t\t\t: msg\n\t\t\t\t));\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('Error sending sticker:', error);\n\t\t\tconsole.error('Request details:', {\n\t\t\t\tstickerId: sticker.id,\n\t\t\t\tidRegularUser,\n\t\t\t\tidProfile\n\t\t\t});\n\t\t\t// –ü–æ–∑–Ω–∞—á–∞—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —è–∫ –ø–æ–º–∏–ª–∫–æ–≤–µ\n\t\t\tsetMessages(prev => prev.map(msg =>\n\t\t\t\tmsg.id === localStickerMessage.id\n\t\t\t\t\t? { ...msg, isSending: false, error: true }\n\t\t\t\t\t: msg\n\t\t\t));\n\t\t}\n\t};\n\n\t// –û–±—Ä–æ–±–∫–∞ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ —Å—Ç—ñ–∫–µ—Ä—ñ–≤\n\tconst handleStickerModalOpen = () => {\n\t\tsetIsStickerModalOpen(true);\n\t\tsetActiveCategoryIndex(0); // –°–∫–∏–¥–∞—î–º–æ –∞–∫—Ç–∏–≤–Ω—É –∫–∞—Ç–µ–≥–æ—Ä—ñ—é\n\t\t// –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Å—Ç—ñ–∫–µ—Ä–∏ —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –≤–æ–Ω–∏ —â–µ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ\n\t\tif (stickerCategories.length === 0) {\n\t\t\tloadStickers();\n\t\t}\n\t};\n\n\t// –û–±—Ä–æ–±–∫–∞ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ –ø–æ–¥–∞—Ä—É–Ω–∫—ñ–≤\n\tconst handleGiftModalOpen = () => {\n\t\tsetIsGiftModalOpen(true);\n\t\t// –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –ø–æ–¥–∞—Ä—É–Ω–∫–∏ —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –≤–æ–Ω–∏ —â–µ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ\n\t\tif (giftItems.length === 0) {\n\t\t\tloadGifts();\n\t\t}\n\t};\n\n\t// –û–±—Ä–æ–±–∫–∞ –∫–ª—ñ–∫—É –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é –≤ –±–æ–∫–æ–≤—ñ–π –ø–∞–Ω–µ–ª—ñ\n\tconst handleCategoryClick = (categoryIndex: number) => {\n\t\tsetActiveCategoryIndex(categoryIndex);\n\n\t\t// –ó–Ω–∞—Ö–æ–¥–∏–º–æ –µ–ª–µ–º–µ–Ω—Ç —Å–µ–∫—Ü—ñ—ó –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó —Ç–∞ —Å–∫—Ä–æ–ª–∏–º–æ –¥–æ –Ω—å–æ–≥–æ\n\t\tconst categoryElement = document.getElementById(`sticker-category-${categoryIndex}`);\n\t\tif (categoryElement && stickerScrollRef.current) {\n\t\t\tconst container = stickerScrollRef.current;\n\t\t\tconst elementTop = categoryElement.offsetTop;\n\t\t\tconst containerHeight = container.clientHeight;\n\t\t\tconst elementHeight = categoryElement.clientHeight;\n\n\t\t\t// –†–æ–∑—Ä–∞—Ö–æ–≤—É—î–º–æ –ø–æ–∑–∏—Ü—ñ—é –¥–ª—è —Ü–µ–Ω—Ç—Ä—É–≤–∞–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ\n\t\t\tconst scrollTop = elementTop - (containerHeight / 2) + (elementHeight / 2);\n\n\t\t\tcontainer.scrollTo({\n\t\t\t\ttop: Math.max(0, scrollTop),\n\t\t\t\tbehavior: 'smooth'\n\t\t\t});\n\t\t}\n\t};\n\n    // –í—ñ–¥–∫—Ä–∏—Ç—Ç—è –ø—Ä–µ–≤ º—é —Ñ–æ—Ç–æ (–æ—Ç—Ä–∏–º—É—î–º–æ –æ—Ä–∏–≥—ñ–Ω–∞–ª —á–µ—Ä–µ–∑ –±–µ–∫–µ–Ω–¥)\n    const openPhotoPreview = async (previewUrl: string) => {\n        try {\n            setIsImagePreviewOpen(true);\n            setImagePreviewLoading(true);\n            setImagePreviewUrl(previewUrl);\n            const res = await apiPost('/api/chats/photo-original', {\n                profileId: idProfile.toString(),\n                idRegularUser,\n                previewUrl\n            });\n            const original = (res && (res.url || res.data?.url)) ? (res.url || res.data?.url) : null;\n            if (original) setImagePreviewUrl(original as string);\n        } catch (e) {\n            // –∑–∞–ª–∏—à–∞—î–º–æ –ø—Ä–µ–≤ º—é —è–∫ fallback\n        } finally {\n            setImagePreviewLoading(false);\n        }\n    };\n\n\tconst formatDateTime = (dateString: string) => {\n\t\tconst date = new Date(dateString);\n\t\tif (isNaN(date.getTime())) {\n\t\t\treturn '‚Äî';\n\t\t}\n\t\t// –ó–∞–≤–∂–¥–∏ –ø–æ–∫–∞–∑—É—î–º–æ –¥–∞—Ç—É —ñ —á–∞—Å\n\t\tconst dateStr = date.toLocaleDateString('uk-UA', {\n\t\t\tday: '2-digit',\n\t\t\tmonth: '2-digit',\n\t\t\tyear: 'numeric'\n\t\t});\n\t\tconst timeStr = date.toLocaleTimeString('uk-UA', { \n\t\t\thour: '2-digit', \n\t\t\tminute: '2-digit' \n\t\t});\n\t\treturn `${dateStr} ${timeStr}`;\n\t};\n\n\tconst renderMessage = (message: ChatMessage & { _idx?: number }) => {\n\t\t// –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø: idProfile - —Ü–µ –Ω–∞—à –ø—Ä–æ—Ñ—ñ–ª—å, idRegularUser - —Å–ø—ñ–≤—Ä–æ–∑–º–æ–≤–Ω–∏–∫\n\t\tconst isFromProfile = message.idUserFrom === idProfile;\n\t\tconst isFromUser = message.idUserFrom === idRegularUser;\n\t\tconst uniqueKey = String(message.id ?? `${message.idUserFrom}-${message.idUserTo}-${message.dateCreated || ''}`) + `-${message._idx ?? 0}`;\n\t\t\n\t\t// –°–∏—Å—Ç–µ–º–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—Ç—å—Å—è –ø–æ-–æ—Å–æ–±–ª–∏–≤–æ–º—É\n\t\tif (message.type === 'system') {\n\t\t\treturn (\n\t\t\t\t<div key={uniqueKey} className=\"flex justify-center mb-4\">\n\t\t\t\t\t<div className=\"text-center text-gray-500 text-sm\">\n\t\t\t\t\t\t{message.content?.message && (\n\t\t\t\t\t\t\t<p className=\"whitespace-pre-wrap break-words\">{message.content.message}</p>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<p className=\"text-xs mt-1 text-gray-400\">\n\t\t\t\t\t\t\t{formatDateTime(message.dateCreated)}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\t\t\n\t\treturn (\n\t\t\t<div key={uniqueKey} className={`flex ${isFromProfile ? 'justify-end' : 'justify-start'} mb-4`}>\n\t\t\t\t<div\n\t\t\t\t\tclassName={`${message.type === 'post' ? 'w-[240px]' : message.type === 'virtual_gift' ? 'w-40' : 'max-w-xs lg:max-w-md'} ${(message.type === 'photo_batch' || message.type === 'photo') ? 'px-0 pt-0 pb-1' : message.type === 'virtual_gift' ? 'p-0' : message.type === 'post' ? 'p-0' : 'px-4 py-2'} rounded-lg ${\n\t\t\t\t\t\tmessage.type === 'post' && (message as any).content?.isPurchased\n\t\t\t\t\t\t\t? 'bg-purple-500 text-white'\n\t\t\t\t\t\t\t: (message.type === 'like_newsfeed_post' || message.type === 'wink' || message.type === 'likephoto')\n\t\t\t\t\t\t\t? 'bg-gray-200 text-gray-800'\n\t\t\t\t\t\t\t: message.type === 'reply_newsfeed_post'\n\t\t\t\t\t\t\t? isFromProfile\n\t\t\t\t\t\t\t\t? 'bg-gray-200 text-gray-800'\n\t\t\t\t\t\t\t\t: 'bg-purple-500 text-white'\n\t\t\t\t\t\t\t: (message.type === 'photo_batch' || message.type === 'photo' || message.type === 'virtual_gift')\n\t\t\t\t\t\t\t? isFromProfile\n\t\t\t\t\t\t\t\t? 'bg-gray-200 text-gray-800'\n\t\t\t\t\t\t\t\t: 'bg-purple-500 text-white'\n\t\t\t\t\t\t\t: isFromProfile\n\t\t\t\t\t\t\t? 'bg-gray-200 text-gray-800'\n\t\t\t\t\t\t\t: 'bg-purple-500 text-white'\n\t\t\t\t\t} ${message.type === 'post' ? 'cursor-pointer hover:opacity-90 transition-opacity' : ''}`}\n\t\t\t\t\tonClick={message.type === 'post' ? () => {\n\t\t\t\t\t\tconst content = (message as any).content;\n\t\t\t\t\t\tif (content?.idPost) {\n\t\t\t\t\t\t\tloadPostDetails(content.idPost);\n\t\t\t\t\t\t}\n\t\t\t\t\t} : undefined}\n\t\t\t\t>\n\t\t\t\t\t{/* –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å */}\n\t\t\t\t\t{(message.type === 'message' || message.type === 'text') && message.content?.message && (\n\t\t\t\t\t\t<p className=\"text-sm whitespace-pre-wrap break-words\">{message.content.message}</p>\n\t\t\t\t\t)}\n\t\t\t\t\t{message.type === 'likephoto' && (\n\t\t\t\t\t\t<div className=\"text-sm\">\n\t\t\t\t\t\t\t<p>‚ù§Ô∏è –í–ø–æ–¥–æ–±–∞–≤ —Ñ–æ—Ç–æ</p>\n\t\t\t\t\t\t\t{message.content?.url && (\n\t\t\t\t\t\t\t\t<img src={message.content.url} alt=\"Photo\" className=\"mt-2 rounded max-w-full h-auto\" />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t\t{message.type === 'wink' && (\n\t\t\t\t\t\t<div className=\"text-sm\">\n\t\t\t\t\t\t\t<p>üòâ –ü—ñ–¥–º–æ—Ä–≥–Ω—É–≤</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t\t{message.type === 'photo' && message.content?.url && (\n\t\t\t\t\t\t<div className=\"text-sm\">\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tsrc={message.content.url}\n\t\t\t\t\t\t\t\talt=\"Photo\"\n\t\t\t\t\t\t\t\tclassName=\"rounded w-40 h-40 object-cover cursor-zoom-in\"\n\t\t\t\t\t\t\t\tonClick={() => message.content.url && openPhotoPreview(message.content.url)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t\t{message.type === 'virtual_gift' && (message as any).content && (() => {\n\t\t\t\t\t\tconst content = (message as any).content;\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div className=\"text-sm p-4\">\n\t\t\t\t\t\t\t\t{/* –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø–æ–¥–∞—Ä—É–Ω–∫–∞ */}\n\t\t\t\t\t\t\t\t{content.imageSrc && (\n\t\t\t\t\t\t\t\t\t<div className=\"mb-2 -mx-4 -mt-4\">\n\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\tsrc={content.imageSrc}\n\t\t\t\t\t\t\t\t\t\t\talt={`Virtual gift ${content.id || ''}`}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded w-40 h-40 object-cover cursor-zoom-in\"\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => content.imageSrc && openPhotoPreview(content.imageSrc)}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t{/* –ß—ñ–ø \"–í—ñ—Ä—Ç—É–∞–ª—å–Ω–∏–π –ø–æ–¥–∞—Ä—É–Ω–æ–∫\" */}\n\t\t\t\t\t\t\t\t<div className={`inline-block text-xs px-2 py-1 rounded mb-2 ${\n\t\t\t\t\t\t\t\t\t!isFromProfile ? 'bg-pink-500 text-white' : 'bg-pink-600 text-white'\n\t\t\t\t\t\t\t\t}`}>\n\t\t\t\t\t\t\t\t\t–í—ñ—Ä—Ç—É–∞–ª—å–Ω–∏–π –ø–æ–¥–∞—Ä—É–Ω–æ–∫\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t{/* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è */}\n\t\t\t\t\t\t\t\t{content.message && (\n\t\t\t\t\t\t\t\t\t<p className=\"whitespace-pre-wrap break-words italic text-black\">\n\t\t\t\t\t\t\t\t\t\t{content.message}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t);\n\t\t\t\t\t})()}\n\t\t\t\t\t{message.type === 'photo_batch' && (message as any).content?.photos?.length > 0 && (() => {\n\t\t\t\t\t\tconst photos = (((message as any).content?.photos) || []) as Array<{ id: number; url: string }>;\n\t\t\t\t\t\tif (photos.length === 1) {\n\t\t\t\t\t\t\tconst p = photos[0];\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<div className=\"text-sm\">\n\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\tkey={`${message.id}-${p.id || 0}`}\n\t\t\t\t\t\t\t\t\t\tsrc={p.url}\n\t\t\t\t\t\t\t\t\t\talt={`Photo ${p.id || 0}`}\n\t\t\t\t\t\t\t\t\t\tclassName=\"rounded w-40 h-40 object-cover cursor-zoom-in\"\n\t\t\t\t\t\t\t\t\t\tonClick={() => openPhotoPreview(p.url)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst gridCols = photos.length >= 5 ? 3 : 2;\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div className={`grid gap-0 text-sm ${gridCols === 3 ? 'grid-cols-3' : 'grid-cols-2'}`}>\n\t\t\t\t\t\t\t\t{photos.map((p, idx) => (\n\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\tkey={`${message.id}-${p.id || idx}`}\n\t\t\t\t\t\t\t\t\t\tsrc={p.url}\n\t\t\t\t\t\t\t\t\t\talt={`Photo ${p.id || idx}`}\n\t\t\t\t\t\t\t\t\t\tclassName=\"rounded w-40 h-40 object-cover cursor-zoom-in\"\n\t\t\t\t\t\t\t\t\t\tonClick={() => openPhotoPreview(p.url)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t);\n\t\t\t\t\t})()}\n\t\t\t\t\t{message.type === 'sticker' && message.content?.url && (\n\t\t\t\t\t\t<div className=\"text-sm relative\">\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tsrc={message.content.url}\n\t\t\t\t\t\t\t\talt={`Sticker ${message.content.id || ''}`}\n\t\t\t\t\t\t\t\tclassName={`max-w-[124px] max-h-[124px] object-contain rounded-md ${\n\t\t\t\t\t\t\t\t\tmessage.isSending ? 'opacity-70' : message.error ? 'opacity-50' : ''\n\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{/* –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ */}\n\t\t\t\t\t\t\t{message.isSending && (\n\t\t\t\t\t\t\t\t<div className=\"absolute -bottom-1 -right-1\">\n\t\t\t\t\t\t\t\t\t<div className=\"w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"w-2 h-2 border border-white border-t-transparent rounded-full animate-spin\"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{/* –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–º–∏–ª–∫–∏ */}\n\t\t\t\t\t\t\t{message.error && (\n\t\t\t\t\t\t\t\t<div className=\"absolute -bottom-1 -right-1\">\n\t\t\t\t\t\t\t\t\t<div className=\"w-4 h-4 bg-red-500 rounded-full flex items-center justify-center\">\n\t\t\t\t\t\t\t\t\t\t<svg className=\"w-2 h-2 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n\t\t\t\t\t\t\t\t\t\t\t<path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t\t{message.type === 'like_newsfeed_post' && (message as any).content && (() => {\n\t\t\t\t\t\tconst content = (message as any).content;\n\t\t\t\t\t\tconst photos = content.photos || [];\n\t\t\t\t\t\tconst hasPhotos = photos.length > 0;\n\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div className=\"text-sm\">\n\t\t\t\t\t\t\t\t{/* –¢–µ–∫—Å—Ç \"–£–ø–æ–¥–æ–±–∞–≤ –≤–∞—à –ø–æ—Å—Ç\" */}\n\t\t\t\t\t\t\t\t<p className=\"mb-2\">‚ù§Ô∏è –£–ø–æ–¥–æ–±–∞–≤ –≤–∞—à –ø–æ—Å—Ç</p>\n\n\t\t\t\t\t\t\t\t{/* –§–æ—Ç–æ —è–∫—â–æ —î */}\n\t\t\t\t\t\t\t\t{hasPhotos && photos.length > 0 && (\n\t\t\t\t\t\t\t\t\t<div className=\"mb-2\">\n\t\t\t\t\t\t\t\t\t\t{photos.length === 1 ? (\n\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\tsrc={photos[0].url}\n\t\t\t\t\t\t\t\t\t\t\t\talt=\"Post photo\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded w-32 h-32 object-cover cursor-zoom-in\"\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => openPhotoPreview(photos[0].url)}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t{photos.slice(0, 4).map((photo: any, idx: number) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={`${message.id}-photo-${idx}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={photo.url}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talt={`Post photo ${idx + 1}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded w-16 h-16 object-cover cursor-zoom-in\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => openPhotoPreview(photo.url)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t\t\t{photos.length > 4 && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-16 h-16 bg-gray-300 rounded flex items-center justify-center text-xs text-gray-600\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t+{photos.length - 4}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t{/* –¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ —è–∫—â–æ —î */}\n\t\t\t\t\t\t\t\t{content.text && (\n\t\t\t\t\t\t\t\t\t<p className=\"whitespace-pre-wrap break-words italic text-sm opacity-75\">\n\t\t\t\t\t\t\t\t\t\t{content.text}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t);\n\t\t\t\t\t})()}\n\t\t\t\t\t{message.type === 'reply_newsfeed_post' && (message as any).content && (() => {\n\t\t\t\t\t\tconst content = (message as any).content;\n\t\t\t\t\t\tconst photos = content.photos || [];\n\t\t\t\t\t\tconst hasPhotos = photos.length > 0;\n\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div className=\"text-sm\">\n\t\t\t\t\t\t\t\t{/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ \"–í—ñ–¥–ø–æ–≤—ñ–≤ –Ω–∞ –ø–æ—Å—Ç\" */}\n\t\t\t\t\t\t\t\t<p className={`text-xs mb-2 ${isFromProfile ? 'text-gray-500' : 'text-white'}`}>–í—ñ–¥–ø–æ–≤—ñ–≤ –Ω–∞ –ø–æ—Å—Ç</p>\n\n\t\t\t\t\t\t\t\t{/* –¶–∏—Ç–∞—Ç–∞ –ø–æ—Å—Ç—É –∑ —Ñ–æ—Ç–æ */}\n\t\t\t\t\t\t\t\t{(content.text || hasPhotos) && (\n\t\t\t\t\t\t\t\t\t<div className=\"mb-3 p-3 bg-gray-100 rounded-lg border-l-4 border-blue-500\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex gap-3\">\n\t\t\t\t\t\t\t\t\t\t\t{/* –ú–∞–ª–µ–Ω—å–∫–µ –ø—Ä–µ–≤'—é —Ñ–æ—Ç–æ —è–∫—â–æ —î */}\n\t\t\t\t\t\t\t\t\t\t\t{hasPhotos && photos.length > 0 && (\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-shrink-0\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={photos[0].url}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"Post preview\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded w-16 h-16 object-cover cursor-zoom-in\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => openPhotoPreview(photos[0].url)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t\t\t\t{/* –¢–µ–∫—Å—Ç –ø–æ—Å—Ç—É –ø—Ä–æ—Ñ—ñ–ª—è */}\n\t\t\t\t\t\t\t\t\t\t\t{content.text && (\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"whitespace-pre-wrap break-words text-sm italic text-gray-700\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{content.text}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t{/* –¢–µ–∫—Å—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –∫–ª—ñ—î–Ω—Ç–∞ - –∑–≤–∏—á–∞–π–Ω–∏–π —Ç–µ–∫—Å—Ç –±–µ–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */}\n\t\t\t\t\t\t\t\t{content.replyText && (\n\t\t\t\t\t\t\t\t\t<p className=\"whitespace-pre-wrap break-words text-sm font-medium\">\n\t\t\t\t\t\t\t\t\t\t{content.replyText}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t);\n\t\t\t\t\t})()}\n\t\t\t\t\t{message.type === 'post' && (message as any).content && (() => {\n\t\t\t\t\t\tconst content = (message as any).content;\n\t\t\t\t\t\tconst photos = content.photos || [];\n\t\t\t\t\t\tconst hasPhotos = photos.length > 0;\n\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div className=\"text-sm p-4\">\n\t\t\t\t\t\t\t\t{/* –ì–∞–ª–µ—Ä–µ—è —Ñ–æ—Ç–æ */}\n\t\t\t\t\t\t\t\t{hasPhotos && (\n\t\t\t\t\t\t\t\t\t<div className=\"flex -mx-4 -mt-4 mb-2 overflow-hidden rounded-t-lg\">\n\t\t\t\t\t\t\t\t\t\t{/* –õ—ñ–≤–∞ –∫–æ–ª–æ–Ω–∫–∞ - –ø–µ—Ä—à–µ —Ñ–æ—Ç–æ 160x160 */}\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex-shrink-0\">\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"relative w-40 h-40\">\n\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={photos[0].url}\n\t\t\t\t\t\t\t\t\t\t\t\t\talt={`Post photo 1`}\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-full object-cover\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t{/* –ß—ñ–ø —Å—Ç–∞—Ç—É—Å—É */}\n\t\t\t\t\t\t\t\t\t\t\t\t<div className={`absolute top-2 left-2 text-xs px-2 py-1 rounded ${\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontent.isPurchased\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-purple-500 text-white'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'bg-black/70 text-white'\n\t\t\t\t\t\t\t\t\t\t\t\t}`}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{content.isPurchased ? '–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–æ' : '–ù–µ –≤—ñ–¥–∫—Ä–∏—Ç–æ'}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t{/* –ü—Ä–∞–≤–∞ –∫–æ–ª–æ–Ω–∫–∞ - –¥—Ä—É–≥–µ —Ç–∞ —Ç—Ä–µ—Ç—î —Ñ–æ—Ç–æ 80x80 */}\n\t\t\t\t\t\t\t\t\t\t{photos.length > 1 && (\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t\t\t{/* –î—Ä—É–≥–µ —Ñ–æ—Ç–æ */}\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"relative w-20 h-20\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={photos[1].url}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talt={`Post photo 2`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-full object-cover\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t{/* –¢—Ä–µ—Ç—î —Ñ–æ—Ç–æ */}\n\t\t\t\t\t\t\t\t\t\t\t\t{photos.length > 2 && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"relative w-20 h-20\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={photos[2].url}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt={`Post photo 3`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-full object-cover\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö —Ñ–æ—Ç–æ */}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{photos.length > 3 && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"absolute inset-0 bg-black/60 flex items-center justify-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-white font-bold text-sm\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+{photos.length - 3}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t{/* –¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ */}\n\t\t\t\t\t\t\t\t{content.textPreview && (\n\t\t\t\t\t\t\t\t\t<p className=\"mt-2 whitespace-pre-wrap break-words\">{content.textPreview}</p>\n\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t{/* –Ø–∫—â–æ –Ω–µ–º–∞—î —Ñ–æ—Ç–æ, –∞–ª–µ —î —ñ–Ω—à—ñ –¥–∞–Ω—ñ */}\n\t\t\t\t\t\t\t\t{!hasPhotos && (\n\t\t\t\t\t\t\t\t\t<div className=\"text-xs text-gray-400 mt-1\">\n\t\t\t\t\t\t\t\t\t\t{content.idPost && `Post ID: ${content.idPost}`}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t);\n\t\t\t\t\t})()}\n\t\t\t\t\t{/* –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –Ω–µ–≤—ñ–¥–æ–º–∏—Ö —Ç–∏–ø—ñ–≤ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –¥–ª—è –¥–µ–±–∞–≥—É */}\n\t\t\t\t\t{!['message', 'text', 'likephoto', 'photo', 'photo_batch', 'sticker', 'system', 'post', 'virtual_gift', 'like_newsfeed_post', 'wink', 'reply_newsfeed_post'].includes(message.type) && (\n\t\t\t\t\t\t<div className=\"text-sm italic text-gray-500\">\n\t\t\t\t\t\t\t–¢–∏–ø –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: {message.type}\n\t\t\t\t\t\t\t{message.content?.message && <p className=\"mt-1\">{message.content.message}</p>}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t\t<p className={`text-xs mt-1 ml-2 ${\n\t\t\t\t\t\t(message.type === 'post' && (message as any).content?.isPurchased) ||\n\t\t\t\t\t\t((message.type === 'photo_batch' || message.type === 'photo' || message.type === 'virtual_gift') && !isFromProfile)\n\t\t\t\t\t\t\t? 'text-white'\n\t\t\t\t\t\t\t: (message.type === 'like_newsfeed_post' || message.type === 'wink' || message.type === 'likephoto')\n\t\t\t\t\t\t\t? 'text-gray-500'\n\t\t\t\t\t\t\t: message.type === 'reply_newsfeed_post'\n\t\t\t\t\t\t\t? isFromProfile\n\t\t\t\t\t\t\t\t? 'text-gray-500'\n\t\t\t\t\t\t\t\t: 'text-purple-200'\n\t\t\t\t\t\t\t: isFromProfile\n\t\t\t\t\t\t\t? 'text-gray-500'\n\t\t\t\t\t\t\t: 'text-purple-200'\n\t\t\t\t\t}`}>\n\t\t\t\t\t\t{formatDateTime(message.dateCreated)}\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t};\n\n\tconst [isClientProfileOpen, setIsClientProfileOpen] = useState(false);\n\tconst [isMyProfileOpen, setIsMyProfileOpen] = useState(false);\n\n\treturn (\n\t\t<div className=\"flex flex-col h-full\">\n\t\t\t{/* –•–µ–¥–µ—Ä –¥—ñ–∞–ª–æ–≥—É */}\n\t\t\t{isLoadingHeader ? (\n\t\t\t\t<ChatHeaderSkeleton />\n\t\t\t) : (\n\t\t\t\t<div className=\"bg-white border-b border-gray-200 p-4\">\n\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t{/* –õ—ñ–≤–∞ —á–∞—Å—Ç–∏–Ω–∞ - —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ */}\n\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t\t{/* –ê–≤–∞—Ç–∞—Ä –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ */}\n\t\t\t\t\t\t\t<div className=\"relative flex-shrink-0\">\n\t\t\t\t\t\t\t\t<div className=\"w-11 h-11 rounded-full overflow-hidden bg-gray-200 cursor-pointer\" onClick={() => setIsClientProfileOpen(true)}>\n\t\t\t\t\t\t\t\t\t{userProfile?.personal?.avatar_small ? (\n\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\tsrc={userProfile.personal.avatar_small}\n\t\t\t\t\t\t\t\t\t\t\talt={userProfile.name}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-full object-cover\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<div className=\"w-full h-full flex items-center justify-center text-white bg-purple-500 text-sm font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t{userProfile?.name?.charAt(0).toUpperCase() || 'U'}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{/* –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –æ–Ω–ª–∞–π–Ω */}\n\t\t\t\t\t\t\t\t{userProfile?.is_online && (\n\t\t\t\t\t\t\t\t\t<div className=\"absolute top-0 left-0 w-3 h-3 bg-green-500 rounded-full border border-white\"></div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t{/* –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ */}\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div className=\"font-medium text-gray-900\">\n\t\t\t\t\t\t\t\t\t{userProfile?.name || `–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á ${idRegularUser}`}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"text-sm text-gray-500\">\n\t\t\t\t\t\t\t\t\t{idRegularUser}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* –ü—Ä–∞–≤–∞ —á–∞—Å—Ç–∏–Ω–∞ - —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –ø—Ä–æ—Ñ—ñ–ª—å */}\n\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t\t{/* –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –ø—Ä–æ—Ñ—ñ–ª—å */}\n\t\t\t\t\t\t\t<div className=\"text-right\">\n\t\t\t\t\t\t\t\t<div className=\"font-medium text-gray-900\">\n\t\t\t\t\t\t\t\t\t{sourceProfile?.displayName || '–ù–µ–≤—ñ–¥–æ–º–∏–π'}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"text-sm text-gray-500\">\n\t\t\t\t\t\t\t\t\t{idProfile}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t{/* –ê–≤–∞—Ç–∞—Ä –ø—Ä–æ—Ñ—ñ–ª—é */}\n\t\t\t\t\t\t\t<div className=\"relative flex-shrink-0\">\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName=\"w-11 h-11 rounded-full overflow-hidden bg-gray-200 cursor-pointer\"\n\t\t\t\t\t\t\t\t\tonClick={() => setIsMyProfileOpen(true)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{profileAvatar ? (\n\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\tsrc={profileAvatar}\n\t\t\t\t\t\t\t\t\t\t\talt={sourceProfile?.displayName || 'Profile'}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-full object-cover\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<div className=\"w-full h-full flex items-center justify-center text-white bg-blue-500 text-sm font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t{sourceProfile?.displayName?.charAt(0).toUpperCase() || 'P'}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t{/* –õ—ñ—á–∏–ª—å–Ω–∏–∫–∏ –æ–±–º–µ–∂–µ–Ω—å (–ø—ñ–¥ —Ö–µ–¥–µ—Ä–æ–º, –ø–æ–≤–µ—Ä—Ö —ñ—Å—Ç–æ—Ä—ñ—ó) */}\n\t\t\t<div className=\"relative\">\n\t\t\t\t<div className=\"absolute top-2 left-4 z-10 flex items-center gap-2\">\n\t\t\t\t\t{/* –õ—ñ—á–∏–ª—å–Ω–∏–∫ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å */}\n\t\t\t\t\t<div className=\"flex items-center gap-1 bg-white/90 backdrop-blur-sm rounded-full px-2 py-1 shadow-sm border border-gray-200/50\">\n\t\t\t\t\t\t<div className=\"w-4 h-4 flex items-center justify-center\">\n\t\t\t\t\t\t\t<svg className=\"w-3 h-3 text-blue-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n\t\t\t\t\t\t\t\t<path fillRule=\"evenodd\" d=\"M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z\" clipRule=\"evenodd\" />\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{isLoadingRestrictions ? (\n\t\t\t\t\t\t\t<div className=\"w-4 h-3 bg-gray-200 rounded animate-pulse\"></div>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<span className={`text-xs font-medium ${messagesLeft === 0 ? 'text-red-600' : messagesLeft && messagesLeft <= 3 ? 'text-orange-600' : 'text-green-600'}`}>\n\t\t\t\t\t\t\t\t{messagesLeft ?? '‚Äî'}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* –õ—ñ—á–∏–ª—å–Ω–∏–∫ –ª–∏—Å—Ç—ñ–≤ */}\n\t\t\t\t\t<div className=\"flex items-center gap-1 bg-white/90 backdrop-blur-sm rounded-full px-2 py-1 shadow-sm border border-gray-200/50\">\n\t\t\t\t\t\t<div className=\"w-4 h-4 flex items-center justify-center\">\n\t\t\t\t\t\t\t<svg className=\"w-3 h-3 text-purple-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n\t\t\t\t\t\t\t\t<path d=\"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z\" />\n\t\t\t\t\t\t\t\t<path d=\"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z\" />\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{isLoadingRestrictions ? (\n\t\t\t\t\t\t\t<div className=\"w-4 h-3 bg-gray-200 rounded animate-pulse\"></div>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<span className={`text-xs font-medium ${lettersLeft === 0 ? 'text-red-600' : lettersLeft === 1 ? 'text-orange-600' : lettersLeft && lettersLeft >= 2 ? 'text-green-600' : 'text-gray-500'}`}>\n\t\t\t\t\t\t\t\t{lettersLeft ?? '‚Äî'}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* –ß—ñ–ø –Ω–∞—Å—Ç—Ä–æ—é */}\n\t\t\t\t\t{userProfile?.personal && (() => {\n\t\t\t\t\t\t// –ü–æ–∫–∞–∑—É—î–º–æ —á—ñ–ø –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ mood –≤—ñ–¥—Å—É—Ç–Ω—ñ–π (–∑ fallback)\n\t\t\t\t\t\tconst moodStyles = getMoodStyles(userProfile.personal.mood);\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-1 bg-white/90 backdrop-blur-sm rounded-full px-2 py-1 shadow-sm border border-gray-200/50\">\n\t\t\t\t\t\t\t\t<div className={`w-4 h-4 flex items-center justify-center ${moodStyles.iconColor}`}>\n\t\t\t\t\t\t\t\t\t{moodStyles.icon}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span className={`text-xs font-medium ${moodStyles.textColor}`}>\n\t\t\t\t\t\t\t\t\t{moodStyles.displayName}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t);\n\t\t\t\t\t})()}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* –û–±–ª–∞—Å—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å */}\n\t\t\t<div \n\t\t\t\tref={scrollContainerRef}\n\t\t\t\tclassName=\"flex-1 overflow-auto p-4 bg-gray-50 flex flex-col-reverse custom-scroll\"\n\t\t\t\tonScroll={handleScroll}\n\t\t\t>\n\t\t\t\t{isLoadingMessages ? (\n\t\t\t\t\t<div className=\"space-y-2 flex flex-col-reverse\">\n\t\t\t\t\t\t{/* –ü–æ–∫–∞–∑—É—î–º–æ –∫—ñ–ª—å–∫–∞ skeleton –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å */}\n\t\t\t\t\t\t<MessageSkeleton isFromProfile={false} />\n\t\t\t\t\t\t<MessageSkeleton isFromProfile={true} />\n\t\t\t\t\t\t<MessageSkeleton isFromProfile={false} />\n\t\t\t\t\t\t<MessageSkeleton isFromProfile={true} />\n\t\t\t\t\t\t<MessageSkeleton isFromProfile={false} />\n\t\t\t\t\t</div>\n\t\t\t\t) : messages.length === 0 ? (\n\t\t\t\t\t<div className=\"flex items-center justify-center h-full text-gray-500\">\n\t\t\t\t\t\t<p>–ù–µ–º–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å</p>\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\t<div className=\"space-y-2 flex flex-col-reverse\">\n\t\t\t\t\t\t<div ref={bottomRef} />\n\t\t\t\t\t\t{messages.slice().reverse().map((m, idx) => renderMessage({ ...m, _idx: idx } as any))}\n\t\t\t\t\t\t\n\t\t\t\t\t\t{/* –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –±—ñ–ª—å—à–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –≤–≥–æ—Ä—ñ */}\n\t\t\t\t\t\t{isLoadingMore && (\n\t\t\t\t\t\t\t<div className=\"flex justify-center py-4\">\n\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 text-gray-500 text-sm\">\n\t\t\t\t\t\t\t\t\t<div className=\"animate-spin w-4 h-4 border-2 border-gray-300 border-t-purple-500 rounded-full\"></div>\n\t\t\t\t\t\t\t\t\t–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ä—ñ—à–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å...\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* –ü–æ–ª–µ –≤–≤–æ–¥—É */}\n\t\t\t<div className=\"bg-white border-t border-gray-200 p-4\">\n\t\t\t\t{isBlockedByInterlocutor ? (\n\t\t\t\t\t<div className=\"text-center text-red-600 font-medium\">–í–∞—Å –±—É–ª–æ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–æ</div>\n\t\t\t\t) : (\n\t\t\t\t<div className=\"flex gap-2 items-center\">\n\t\t\t\t\t{/* –ö–Ω–æ–ø–∫–∞ –∞—Ç–∞—á–º–µ–Ω—Ç—É */}\n\t\t\t\t\t<button\n\t\t\t\t\t\tonClick={() => setIsChatGalleryOpen(true)}\n\t\t\t\t\t\tclassName=\"flex-shrink-0 p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors\"\n\t\t\t\t\t\ttitle=\"–ü—Ä–∏–∫—Ä—ñ–ø–∏—Ç–∏ –º–µ–¥—ñ–∞\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t<path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\" />\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\n\t\t\t\t\t{/* –ö–Ω–æ–ø–∫–∞ –ª–∏—Å—Ç–∞ */}\n\t\t\t\t\t<button\n\t\t\t\t\t\tonClick={() => setIsEmailHistoryOpen(true)}\n\t\t\t\t\t\tclassName=\"flex-shrink-0 p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors\"\n\t\t\t\t\t\ttitle=\"–Ü—Å—Ç–æ—Ä—ñ—è –ª–∏—Å—Ç—É–≤–∞–Ω–Ω—è\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t<path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" />\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\n\t\t\t\t\t{/* –ö–Ω–æ–ø–∫–∞ —Å—Ç—ñ–∫–µ—Ä–∞ */}\n\t\t\t\t\t<button\n\t\t\t\t\t\tonClick={handleStickerModalOpen}\n\t\t\t\t\t\tclassName=\"flex-shrink-0 p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors\"\n\t\t\t\t\t\ttitle=\"–í–∏–±—Ä–∞—Ç–∏ —Å—Ç—ñ–∫–µ—Ä\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t<circle cx=\"12\" cy=\"12\" r=\"10\"/>\n\t\t\t\t\t\t\t<circle cx=\"9\" cy=\"9\" r=\"1\"/>\n\t\t\t\t\t\t\t<circle cx=\"15\" cy=\"9\" r=\"1\"/>\n\t\t\t\t\t\t\t<path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M7 14c1 1 3 1 5 0\"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\n\t\t\t\t\t{/* –ö–Ω–æ–ø–∫–∞ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∏—Ö –ø–æ–¥–∞—Ä—É–Ω–∫—ñ–≤ */}\n\t\t\t\t\t{(giftLimit && (giftLimit.limit > 0 || giftLimit.canSendWithoutLimit)) && (\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonClick={handleGiftModalOpen}\n\t\t\t\t\t\t\tclassName=\"flex-shrink-0 p-2 text-pink-500 hover:text-pink-700 hover:bg-pink-50 rounded-lg transition-colors relative\"\n\t\t\t\t\t\t\ttitle={`–í—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ –ø–æ–¥–∞—Ä—É–Ω–∫–∏ (${giftLimit.canSendWithoutLimit ? '–±–µ–∑ –ª—ñ–º—ñ—Ç—É' : `${giftLimit.limit} –∑–∞–ª–∏—à–∏–ª–æ—Å—å`})`}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t\t<path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t{/* –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫—ñ–ª—å–∫–æ—Å—Ç—ñ, —è–∫—â–æ —î –ª—ñ–º—ñ—Ç */}\n\t\t\t\t\t\t\t{!giftLimit.canSendWithoutLimit && giftLimit.limit > 0 && (\n\t\t\t\t\t\t\t\t<span className=\"absolute -top-1 -right-1 bg-pink-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium\">\n\t\t\t\t\t\t\t\t\t{giftLimit.limit > 99 ? '99+' : giftLimit.limit}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{/* –Ü–∫–æ–Ω–∫–∞ –º–æ–ª–Ω—ñ—ó –¥–ª—è exclusive posts */}\n\t\t\t\t\t{hasExclusivePosts && (\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonClick={() => setIsExclusiveModalOpen(true)}\n\t\t\t\t\t\t\tclassName={`flex-shrink-0 p-2 rounded-lg transition-colors relative ${ttTier === 'specialplus' ? 'text-red-600 hover:text-red-700' : 'text-yellow-500 hover:text-yellow-600'}`}\n\t\t\t\t\t\t\ttitle={`${ttTier === 'specialplus' ? '‚ö° SpecialPlus' : '‚ö° Special'} ‚Äî –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó: ${ttCategories.join(', ')}`}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg className=\"w-6 h-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t\t<path d=\"M13 10V3L4 14h7v7l9-11h-7z\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t<div className={`absolute inset-0 rounded-lg opacity-20 animate-pulse ${ttTier === 'specialplus' ? 'bg-red-500' : 'bg-yellow-400'}`}></div>\n\t\t\t\t\t\t\t{ttTier === 'specialplus' && (\n\t\t\t\t\t\t\t\t<div className=\"absolute -top-1 -right-1 w-4 h-4 rounded-full bg-white text-red-600 flex items-center justify-center text-[10px] font-extrabold leading-none\">+</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t)}\n\n\t\t\t\t\t<div className=\"flex-1 relative\">\n\t\t\t\t\t\t{/* –õ—ñ—á–∏–ª—å–Ω–∏–∫ —Å–∏–º–≤–æ–ª—ñ–≤ –Ω–∞–¥ —ñ–Ω–ø—É—Ç–æ–º */}\n\t\t\t\t\t\t<div className={`absolute top-0 right-2 text-xs z-10 ${\n\t\t\t\t\t\t\ttext.length > 250 ? 'text-red-500' :\n\t\t\t\t\t\t\ttext.length > 200 ? 'text-yellow-500' : 'text-gray-400'\n\t\t\t\t\t\t}`}>\n\t\t\t\t\t\t\t{text.length}/300\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\tref={inputRef}\n\t\t\t\t\t\t\tclassName=\"w-full border border-gray-300 rounded-lg px-4 py-3 pr-12 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none overflow-hidden\"\n\t\t\t\t\t\t\tplaceholder=\"–ù–∞–ø–∏—à—ñ—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è...\"\n\t\t\t\t\t\t\tvalue={text}\n\t\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\t\tsetText(e.target.value);\n\t\t\t\t\t\t\t\tautoResizeTextarea(e.target);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tonKeyPress={(e) => e.key === 'Enter' && !e.shiftKey && send()}\n\t\t\t\t\t\t\tmaxLength={300}\n\t\t\t\t\t\t\trows={1}\n\t\t\t\t\t\t\tstyle={{ minHeight: '48px', maxHeight: '120px' }}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{/* –ö–Ω–æ–ø–∫–∞ –µ–º–æ–¥–∑—ñ */}\n\t\t\t\t\t\t<div className=\"absolute right-2 top-1/2 transform -translate-y-1/2\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tonClick={() => setIsEmojiPickerOpen(!isEmojiPickerOpen)}\n\t\t\t\t\t\t\t\tclassName=\"text-gray-400 hover:text-gray-600 p-1 rounded transition-colors\"\n\t\t\t\t\t\t\t\ttitle=\"–î–æ–¥–∞—Ç–∏ –µ–º–æ–¥–∑—ñ\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tüòÄ\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t{/* EmojiPicker */}\n\t\t\t\t\t\t\t<EmojiPicker\n\t\t\t\t\t\t\t\tisOpen={isEmojiPickerOpen}\n\t\t\t\t\t\t\t\tonEmojiSelect={handleEmojiSelect}\n\t\t\t\t\t\t\t\tonClose={() => setIsEmojiPickerOpen(false)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName=\"bg-purple-500 hover:bg-purple-600 text-white w-10 h-10 rounded-lg transition-colors flex items-center justify-center\"\n\t\t\t\t\t\tonClick={send}\n\t\t\t\t\t\ttitle=\"–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t<path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\" />\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* –ú–µ–¥—ñ–∞ –≥–∞–ª–µ—Ä–µ—è */}\n\t\t\t{/* –ì–∞–ª–µ—Ä–µ—è –¥–ª—è –∑–≤–∏—á–∞–π–Ω–æ–≥–æ —á–∞—Ç—É */}\n\t\t\t<MediaGallery\n\t\t\t\tprofileId={idProfile.toString()}\n\t\t\t\tisOpen={isChatGalleryOpen}\n\t\t\t\tonClose={() => setIsChatGalleryOpen(false)}\n\t\t\t\tonPhotoSelect={handlePhotoSelect}\n\t\t\t\tmaxSelection={6}\n\t\t\t\tcontext=\"chat\"\n\t\t\t\tidRegularUser={idRegularUser}\n\t\t\t\tmode=\"send\"\n\t\t\t\tallowAudio={true}\n\t\t\t/>\n\n\t\t\t{/* –ì–∞–ª–µ—Ä–µ—è –¥–ª—è –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è –≤ –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ–º—É –ø–æ—Å—Ç—ñ */}\n\t\t\t<MediaGallery\n\t\t\t\tprofileId={idProfile.toString()}\n\t\t\t\tisOpen={isAttachGalleryOpen}\n\t\t\t\tonClose={() => setIsAttachGalleryOpen(false)}\n\t\t\t\tonPhotoSelect={() => {}}\n\t\t\t\tmaxSelection={6}\n\t\t\t\tcontext=\"chat\"\n\t\t\t\tidRegularUser={idRegularUser}\n\t\t\t\tmode=\"attach\"\n\t\t\t\tactionLabel=\"–ü—Ä–∏–∫—Ä—ñ–ø–∏—Ç–∏\"\n\t\t\t\tallowAudio={false}\n\t\t\t\tallowedPhotoTabs={ttTier === 'specialplus' ? ['special','special_plus'] : ['special']}\n\t\t\t\tisSpecialPlusAllowed={ttTier === 'specialplus'}\n\t\t\t\tonAttach={({ photos, videos }) => {\n\t\t\t\t\tsetAttachedPhotos(photos.map(p => p.idPhoto));\n\t\t\t\t\tsetAttachedVideos(videos.map(v => v.idVideo));\n\t\t\t\t\tsetAttachedPhotoPreviews(photos.map(p => ({ idPhoto: p.idPhoto, url: p.urls.urlPreview })));\n\t\t\t\t\tsetAttachedVideoPreviews(videos.map(v => ({ idVideo: v.idVideo, url: v.urls.urlThumbnail })));\n\t\t\t\t\tsetIsAttachGalleryOpen(false);\n\t\t\t\t}}\n\t\t\t/>\n\n\t\t\t{/* –Ü—Å—Ç–æ—Ä—ñ—è –ª–∏—Å—Ç—É–≤–∞–Ω–Ω—è */}\n\t\t\t<EmailHistory\n\t\t\t\tisOpen={isEmailHistoryOpen}\n\t\t\t\tonClose={() => setIsEmailHistoryOpen(false)}\n\t\t\t\tprofileId={idProfile.toString()}\n\t\t\t\tclientId={idRegularUser.toString()}\n\t\t\t\tcorrespondenceId={(typeof window !== 'undefined' && (window as any).__emailCorrOverride) || dialogId}\n\t\t\t\tlettersLeft={lettersLeft}\n\t\t\t/>\n\n\t\t\t{/* –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ–≥–æ –ø–æ—Å—Ç—É */}\n\t\t\t{isExclusiveModalOpen && (\n\t\t\t\t<div className=\"fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center p-4\">\n\t\t\t\t\t<div className=\"bg-white rounded-lg w-full max-w-2xl p-4 space-y-4\">\n\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t<h3 className=\"text-lg font-semibold\">–ï–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏–π –ø–æ—Å—Ç</h3>\n\t\t\t\t\t\t\t<button onClick={() => setIsExclusiveModalOpen(false)} className=\"text-gray-500 hover:text-gray-700\">‚úï</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<label className=\"block text-sm text-gray-600 mb-1\">–¢–µ–∫—Å—Ç (–º—ñ–Ω—ñ–º—É–º {minExclusiveLength} —Å–∏–º–≤–æ–ª—ñ–≤)</label>\n\t\t\t\t\t\t\t<div className=\"relative\">\n\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\tvalue={exclusiveText}\n\t\t\t\t\t\t\t\t\tonChange={(e) => setExclusiveText(e.target.value)}\n\t\t\t\t\t\t\t\t\trows={4}\n\t\t\t\t\t\t\t\t\tclassName=\"w-full border rounded-md p-2 pr-12 focus:outline-none focus:ring-2 focus:ring-purple-500\"\n\t\t\t\t\t\t\t\t\tplaceholder=\"–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç—É...\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t{/* –ö–Ω–æ–ø–∫–∞ –µ–º–æ–¥–∑—ñ */}\n\t\t\t\t\t\t\t\t<div className=\"absolute right-2 top-2\">\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\tonClick={() => setIsPostEmojiPickerOpen(!isPostEmojiPickerOpen)}\n\t\t\t\t\t\t\t\t\t\tclassName=\"text-gray-400 hover:text-gray-600 p-1 rounded transition-colors\"\n\t\t\t\t\t\t\t\t\t\ttitle=\"–î–æ–¥–∞—Ç–∏ –µ–º–æ–¥–∑—ñ\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\tüòÄ\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t{/* EmojiPicker */}\n\t\t\t\t\t\t\t\t\t<EmojiPicker\n\t\t\t\t\t\t\t\t\t\tisOpen={isPostEmojiPickerOpen}\n\t\t\t\t\t\t\t\t\t\tonEmojiSelect={handlePostEmojiSelect}\n\t\t\t\t\t\t\t\t\t\tonClose={() => setIsPostEmojiPickerOpen(false)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className={`${exclusiveText.length < minExclusiveLength ? 'text-red-600' : 'text-gray-500'} text-sm mt-1`}>\n\t\t\t\t\t\t\t\t–ó–∞–ª–∏—à–∏–ª–æ—Å—å: {Math.max(0, minExclusiveLength - exclusiveText.length)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-600\">–ü—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω—ñ –º–µ–¥—ñ–∞</span>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tonClick={() => setIsAttachGalleryOpen(true)}\n\t\t\t\t\t\t\t\t\tclassName=\"px-3 py-1.5 rounded-md bg-gray-100 hover:bg-gray-200 text-sm\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t–î–æ–¥–∞—Ç–∏ –∑ –≥–∞–ª–µ—Ä–µ—ó\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex flex-wrap gap-2\">\n\t\t\t\t\t\t\t\t{attachedPhotoPreviews.map(p => (\n\t\t\t\t\t\t\t\t\t<div key={`p-${p.idPhoto}`} className=\"relative w-16 h-16 rounded-md overflow-hidden border border-gray-200\">\n\t\t\t\t\t\t\t\t\t\t<img src={p.url} alt={`–§–æ—Ç–æ ${p.idPhoto}`} className=\"w-full h-full object-cover\" />\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\tsetAttachedPhotos(prev => prev.filter(id => id !== p.idPhoto));\n\t\t\t\t\t\t\t\t\t\t\t\tsetAttachedPhotoPreviews(prev => prev.filter(x => x.idPhoto !== p.idPhoto));\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"absolute -top-1 -right-1 bg-white/90 border border-gray-300 rounded-full w-5 h-5 text-[10px] flex items-center justify-center shadow\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"–ü—Ä–∏–±—Ä–∞—Ç–∏ —Ñ–æ—Ç–æ\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t‚úï\n\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t{attachedVideoPreviews.map(v => (\n\t\t\t\t\t\t\t\t\t<div key={`v-${v.idVideo}`} className=\"relative w-16 h-16 rounded-md overflow-hidden border border-gray-200\">\n\t\t\t\t\t\t\t\t\t\t<img src={v.url} alt={`–í—ñ–¥–µ–æ ${v.idVideo}`} className=\"w-full h-full object-cover\" />\n\t\t\t\t\t\t\t\t\t\t<span className=\"absolute bottom-0 right-0 m-0.5 text-[10px] px-1 py-0.5 rounded bg-black/60 text-white\">‚ñ∂</span>\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\tsetAttachedVideos(prev => prev.filter(id => id !== v.idVideo));\n\t\t\t\t\t\t\t\t\t\t\t\tsetAttachedVideoPreviews(prev => prev.filter(x => x.idVideo !== v.idVideo));\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"absolute -top-1 -right-1 bg-white/90 border border-gray-300 rounded-full w-5 h-5 text-[10px] flex items-center justify-center shadow\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"–ü—Ä–∏–±—Ä–∞—Ç–∏ –≤—ñ–¥–µ–æ\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t‚úï\n\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t{attachedPhotos.length === 0 && attachedVideos.length === 0 && (\n\t\t\t\t\t\t\t\t\t<div className=\"text-sm text-gray-400\">–ù—ñ—á–æ–≥–æ –Ω–µ –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–æ</div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"flex items-center justify-between pt-2 border-t\">\n\t\t\t\t\t\t\t<div className=\"text-xs text-gray-500\">\n\t\t\t\t\t\t\t\t–ü—Ä–∞–≤–∏–ª–∞: –º–∞–∫—Å–∏–º—É–º 1 –≤—ñ–¥–µ–æ –∞–±–æ 1 –≤—ñ–¥–µ–æ + –±—É–¥—å-—è–∫–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ñ–æ—Ç–æ, –∞–±–æ ‚â•4 —Ñ–æ—Ç–æ –±–µ–∑ –≤—ñ–¥–µ–æ. Special+ —Ñ–æ—Ç–æ –¥–æ–∑–≤–æ–ª–µ–Ω—ñ –ª–∏—à–µ –¥–ª—è tier=SpecialPlus.\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"space-x-2\">\n\t\t\t\t\t\t\t\t<button onClick={() => setIsExclusiveModalOpen(false)} className=\"px-4 py-2 rounded-md bg-gray-100 hover:bg-gray-200\">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tonClick={async () => {\n\t\t\t\t\t\t\t\t\t\tif (exclusiveText.length < minExclusiveLength) return;\n\t\t\t\t\t\t\t\t\t\tconst hasVideo = attachedVideos.length > 0;\n\t\t\t\t\t\t\t\t\t\tif (hasVideo) {\n\t\t\t\t\t\t\t\t\t\t\tif (attachedVideos.length > 1) return;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tif (attachedPhotos.length > 0 && attachedPhotos.length < 4) return;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\tconst res = await apiPost<{ success: boolean; error?: string }>(\n\t\t\t\t\t\t\t\t\t\t\t\t'/api/chats/tt-send-post',\n\t\t\t\t\t\t\t\t\t\t\t\t{ profileId: idProfile, idRegularUser, idsGalleryPhotos: attachedPhotos, idsGalleryVideos: attachedVideos, text: exclusiveText }\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\tif (res.success) {\n\t\t\t\t\t\t\t\t\t\t\t\tsetIsExclusiveModalOpen(false);\n\t\t\t\t\t\t\t\t\t\t\t\tsetExclusiveText('');\n\t\t\t\t\t\t\t\t\t\t\t\tsetAttachedPhotos([]);\n\t\t\t\t\t\t\t\t\t\t\t\tsetAttachedVideos([]);\n\t\t\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\t\t\twindow.dispatchEvent(new CustomEvent('dialog:sent', { detail: { profileId: idProfile, clientId: idRegularUser, kind: 'post' } }));\n\t\t\t\t\t\t\t\t\t\t\t\t} catch {}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} catch {}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tdisabled={\n\t\t\t\t\t\t\t\t\t\texclusiveText.length < minExclusiveLength ||\n\t\t\t\t\t\t\t\t\t\t(attachedVideos.length === 0 && (attachedPhotos.length === 0 || attachedPhotos.length < 4)) ||\n\t\t\t\t\t\t\t\t\t\t(attachedVideos.length > 1)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 rounded-md bg-purple-600 text-white disabled:bg-gray-300\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t{/* –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ —Å—Ç—ñ–∫–µ—Ä—ñ–≤ */}\n\t\t\t{isStickerModalOpen && (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\"\n\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\t// –ó–∞–∫—Ä–∏–≤–∞—î–º–æ —Ç—ñ–ª—å–∫–∏ –ø—Ä–∏ –∫–ª—ñ–∫—É –Ω–∞ backdrop, –Ω–µ –Ω–∞ –∫–æ–Ω—Ç–µ–Ω—Ç\n\t\t\t\t\t\tif (e.target === e.currentTarget) {\n\t\t\t\t\t\t\tsetIsStickerModalOpen(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"bg-white rounded-lg shadow-xl max-w-7xl w-full max-h-[85vh] overflow-hidden\">\n\t\t\t\t\t\t{/* –•–µ–¥–µ—Ä –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ */}\n\t\t\t\t\t\t<div className=\"flex items-center justify-between p-3 border-b border-gray-200\">\n\t\t\t\t\t\t\t<h3 className=\"text-lg font-semibold text-gray-900\">–í–∏–±–µ—Ä—ñ—Ç—å —Å—Ç—ñ–∫–µ—Ä</h3>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tonClick={() => setIsStickerModalOpen(false)}\n\t\t\t\t\t\t\t\tclassName=\"text-gray-400 hover:text-gray-600 transition-colors p-1\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t\t\t<path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* –ö–æ–Ω—Ç–µ–Ω—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞ */}\n\t\t\t\t\t\t<div className=\"flex h-[70vh]\">\n\t\t\t\t\t\t\t{isLoadingStickers ? (\n\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center w-full\">\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 text-gray-500\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"animate-spin w-6 h-6 border-2 border-gray-300 border-t-purple-500 rounded-full\"></div>\n\t\t\t\t\t\t\t\t\t\t–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç—ñ–∫–µ—Ä—ñ–≤...\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : stickerCategories.length === 0 ? (\n\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center w-full\">\n\t\t\t\t\t\t\t\t\t<p className=\"text-gray-500\">–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Å—Ç—ñ–∫–µ—Ä–∏</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t{/* –ë–æ–∫–æ–≤–∞ –ø–∞–Ω–µ–ª—å –∑ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º–∏ */}\n\t\t\t\t\t\t\t\t\t<div className=\"w-20 bg-gray-50 border-r border-gray-200 overflow-y-auto custom-scroll\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"p-2 space-y-2\">\n\t\t\t\t\t\t\t\t\t\t\t{stickerCategories.map((category, categoryIndex) => (\n\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={categoryIndex}\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleCategoryClick(categoryIndex)}\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`cursor-pointer rounded-lg transition-all duration-200 p-1 m-1 ${\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tactiveCategoryIndex === categoryIndex\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-purple-200 ring-2 ring-purple-400'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: 'hover:bg-gray-200'\n\t\t\t\t\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={category.name}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{category.stickers.length > 0 && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={category.stickers[0].url}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt={category.name}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-11 h-11 mx-auto object-cover rounded-md hover:scale-150 transition-transform\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloading=\"lazy\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t{/* –û—Å–Ω–æ–≤–Ω–∞ –æ–±–ª–∞—Å—Ç—å –∑ —Å—Ç—ñ–∫–µ—Ä–∞–º–∏ */}\n\t\t\t\t\t\t\t\t\t<div ref={stickerScrollRef} className=\"flex-1 overflow-y-auto custom-scroll\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"p-3\">\n\t\t\t\t\t\t\t\t\t\t\t{stickerCategories.map((category, categoryIndex) => (\n\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={categoryIndex}\n\t\t\t\t\t\t\t\t\t\t\t\t\tid={`sticker-category-${categoryIndex}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"mb-6 last:mb-0\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-8 xl:grid-cols-10 2xl:grid-cols-12 gap-3\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{category.stickers.map((sticker) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={sticker.id}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleStickerSelect(sticker)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-24 h-24 overflow-hidden hover:scale-150 transition-transform\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttitle={`–°—Ç—ñ–∫–µ—Ä ${sticker.id}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={sticker.url}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt={`Sticker ${sticker.id}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-full object-cover rounded-md\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloading=\"lazy\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t{/* –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∏—Ö –ø–æ–¥–∞—Ä—É–Ω–∫—ñ–≤ */}\n\t\t\t{isGiftModalOpen && (\n\t\t\t\t<div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4\">\n\t\t\t\t\t<div className=\"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[80vh] flex flex-col\">\n\t\t\t\t\t\t{/* –•–µ–¥–µ—Ä */}\n\t\t\t\t\t\t<div className=\"flex items-center justify-between p-4 border-b border-gray-200\">\n\t\t\t\t\t\t\t<h3 className=\"text-lg font-semibold text-gray-900\">–í—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ –ø–æ–¥–∞—Ä—É–Ω–∫–∏</h3>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tonClick={() => setIsGiftModalOpen(false)}\n\t\t\t\t\t\t\t\tclassName=\"text-gray-400 hover:text-gray-600 p-1\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t\t\t<path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* –ö–æ–Ω—Ç–µ–Ω—Ç */}\n\t\t\t\t\t\t<div className=\"flex-1 overflow-y-auto p-4 custom-scroll\">\n\n\n\t\t\t\t\t\t\t{isLoadingGifts && giftItems.length === 0 ? (\n\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center h-32\">\n\t\t\t\t\t\t\t\t\t<div className=\"text-gray-500\">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : giftItems.length === 0 ? (\n\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center h-32\">\n\t\t\t\t\t\t\t\t\t<div className=\"text-gray-500\">–ù–µ–º–∞—î –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –ø–æ–¥–∞—Ä—É–Ω–∫—ñ–≤</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3\">\n\t\t\t\t\t\t\t\t\t{giftItems.map((gift) => (\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tkey={gift.id}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"border border-gray-200 rounded-lg p-3 hover:border-pink-300 transition-colors cursor-pointer\"\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleGiftSelect(gift)}\n\t\t\t\t\t\t\t\t\t\t\ttitle={`${gift.name} - ${gift.cost} –º–æ–Ω–µ—Ç${gift.animationSrc ? ' (–∞–Ω—ñ–º–æ–≤–∞–Ω–∏–π)' : ''}`}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{/* –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∞–±–æ –∞–Ω—ñ–º–∞—Ü—ñ—è */}\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"relative w-full aspect-square mb-2 bg-gray-100 rounded-md overflow-hidden\">\n\t\t\t\t\t\t\t\t\t\t\t\t{gift.imageSrc || gift.animationSrc ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{gift.animationSrc && gift.animationSrc.endsWith('.json') ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/* Lottie –∞–Ω—ñ–º–∞—Ü—ñ—è –∞–±–æ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π JSON */\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<LottieErrorBoundary\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonError={(error, errorInfo) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.error(`üé≠ Lottie error for gift \"${gift.name}\":`, error);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—É –ª–æ–≥—ñ–∫—É –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫ —Ç—É—Ç\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* –°–ø—Ä–æ–±—É—î–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —è–∫ Lottie JSON */}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-full\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-lottie-url={gift.animationSrc}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbackground: 'linear-gradient(135deg, #fce7f3 0%, #e9d5ff 100%)',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talignItems: 'center',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tjustifyContent: 'center'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-3xl mb-2 animate-pulse\">üíñ</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-xs text-gray-600 font-medium\">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞–Ω—ñ–º–∞—Ü—ñ—ó...</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-xs text-gray-500 mt-1\">Lottie</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Lottie –±—É–¥–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ —á–µ—Ä–µ–∑ useEffect */}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tref={(el) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (el && gift.animationSrc && !el.hasAttribute('data-lottie-loaded')) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tel.setAttribute('data-lottie-loaded', 'true');\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tel.setAttribute('data-gift-id', gift.id.toString());\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tel.setAttribute('data-animation-src', gift.animationSrc);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ Lottie –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloadLottieForElement(el, gift);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}, 100);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-full\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata-lottie-url={gift.animationSrc}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbackground: 'linear-gradient(135deg, #fce7f3 0%, #e9d5ff 100%)',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talignItems: 'center',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tjustifyContent: 'center'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-3xl mb-2 animate-pulse\">üíñ</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-xs text-gray-600 font-medium\">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞–Ω—ñ–º–∞—Ü—ñ—ó...</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-xs text-gray-500 mt-1\">Lottie</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –∞–Ω—ñ–º–∞—Ü—ñ—ó */}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"absolute top-1 right-1 bg-pink-500 text-white text-xs px-1 py-0.5 rounded flex items-center gap-0.5\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tüé≠\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs\">Lottie</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</LottieErrorBoundary>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : gift.animationSrc && (gift.animationSrc.endsWith('.gif') || gift.animationSrc.includes('gif')) ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/* GIF –∞–Ω—ñ–º–∞—Ü—ñ—è */\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgift.animationSrc.startsWith('http') || gift.animationSrc.startsWith('//')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? gift.animationSrc.startsWith('//') ? `https:${gift.animationSrc}` : gift.animationSrc\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: `https://talkytimes.com${gift.animationSrc}`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt={gift.name}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-full object-cover\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloading=\"lazy\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonError={(e) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.error(`GIF failed for ${gift.name}:`, e.target.src);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst target = e.target as HTMLImageElement;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget.src = `https://picsum.photos/64/64?random=${gift.id}`;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget.onerror = null;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/* –ó–≤–∏—á–∞–π–Ω–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è */\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(gift.imageSrc || gift.animationSrc).startsWith('http') || (gift.imageSrc || gift.animationSrc).startsWith('//')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? (gift.imageSrc || gift.animationSrc).startsWith('//') ? `https:${gift.imageSrc || gift.animationSrc}` : (gift.imageSrc || gift.animationSrc)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: `https://talkytimes.com${gift.imageSrc || gift.animationSrc}`\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt={gift.name}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-full object-cover\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloading=\"lazy\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonError={(e) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst target = e.target as HTMLImageElement;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (gift.animationSrc) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// –°–ø—Ä–æ–±—É—î–º–æ —è–∫ GIF\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget.src = gift.animationSrc.replace('.json', '.gif');\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget.src = `https://picsum.photos/64/64?random=${gift.id}`;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget.onerror = null;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –∞–Ω—ñ–º–∞—Ü—ñ—ó –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ */}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{gift.animationSrc && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"absolute top-1 right-1 bg-pink-500 text-white text-xs px-1 py-0.5 rounded flex items-center gap-0.5\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{gift.animationSrc.endsWith('.json') ? 'üé≠' : 'üé¨'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{gift.animationSrc.endsWith('.json') ? 'JSON' :\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t gift.animationSrc.endsWith('.gif') || gift.animationSrc.includes('gif') ? 'GIF' : 'üé¨'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-full h-full bg-gray-200 flex items-center justify-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<svg className=\"w-6 h-6 text-gray-400\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t{/* –ù–∞–∑–≤–∞ */}\n\t\t\t\t\t\t\t\t\t\t\t<h4 className=\"text-xs font-medium text-gray-900 text-center mb-1 truncate flex items-center justify-center gap-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t{gift.name}\n\t\t\t\t\t\t\t\t\t\t\t\t{gift.animationSrc && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-pink-500 text-xs\" title={\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tgift.animationSrc.endsWith('.json') ? 'Lottie –∞–Ω—ñ–º–∞—Ü—ñ—è (JSON)' :\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tgift.animationSrc.endsWith('.gif') || gift.animationSrc.includes('gif') ? 'GIF –∞–Ω—ñ–º–∞—Ü—ñ—è' :\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'–ê–Ω—ñ–º–æ–≤–∞–Ω–∏–π –ø–æ–¥–∞—Ä—É–Ω–æ–∫'\n\t\t\t\t\t\t\t\t\t\t\t\t\t}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{gift.animationSrc.endsWith('.json') ? 'üé≠' : 'üé¨'}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</h4>\n\n\t\t\t\t\t\t\t\t\t\t\t{/* –í–∞—Ä—Ç—ñ—Å—Ç—å */}\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center gap-1 text-xs text-pink-600 font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t\t<svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t\t{gift.cost}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t{/* –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –¥–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ø–æ–¥–∞—Ä—É–Ω–∫—É */}\n\t\t\t{isMessageModalOpen && selectedGift && (\n\t\t\t\t<div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4\">\n\t\t\t\t\t<div className=\"bg-white rounded-lg shadow-xl w-full max-w-md\">\n\t\t\t\t\t\t{/* –•–µ–¥–µ—Ä */}\n\t\t\t\t\t\t<div className=\"flex items-center justify-between p-4 border-b border-gray-200\">\n\t\t\t\t\t\t\t<h3 className=\"text-lg font-semibold text-gray-900\">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –ø–æ–¥–∞—Ä—É–Ω–æ–∫</h3>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tonClick={() => setIsMessageModalOpen(false)}\n\t\t\t\t\t\t\t\tclassName=\"text-gray-400 hover:text-gray-600 p-1\"\n\t\t\t\t\t\t\t\tdisabled={isSendingGift}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t\t\t<path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* –ö–æ–Ω—Ç–µ–Ω—Ç */}\n\t\t\t\t\t\t<div className=\"p-6\">\n\t\t\t\t\t\t\t{/* –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥ –≤–∏–±—Ä–∞–Ω–æ–≥–æ –ø–æ–¥–∞—Ä—É–Ω–∫—É */}\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-3 mb-4 p-3 bg-pink-50 rounded-lg\">\n\t\t\t\t\t\t\t\t<div className=\"relative w-12 h-12 bg-gray-100 rounded-md overflow-hidden flex-shrink-0\">\n\t\t\t\t\t\t\t\t\t{selectedGift.imageSrc || selectedGift.animationSrc ? (\n\t\t\t\t\t\t\t\t\t\tselectedGift.animationSrc && selectedGift.animationSrc.endsWith('.json') ? (\n\t\t\t\t\t\t\t\t\t\t\t<LottieErrorBoundary\n\t\t\t\t\t\t\t\t\t\t\t\tonError={(error, errorInfo) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.error(`üé≠ Lottie error in message modal for gift \"${selectedGift.name}\":`, error);\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-full h-full flex items-center justify-center bg-gradient-to-br from-pink-100 to-purple-100\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-lg\">üé≠</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</LottieErrorBoundary>\n\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\tsrc={\n\t\t\t\t\t\t\t\t\t\t\t\t\t(selectedGift.imageSrc || selectedGift.animationSrc).startsWith('http') || (selectedGift.imageSrc || selectedGift.animationSrc).startsWith('//')\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? (selectedGift.imageSrc || selectedGift.animationSrc).startsWith('//') ? `https:${selectedGift.imageSrc || selectedGift.animationSrc}` : (selectedGift.imageSrc || selectedGift.animationSrc)\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: `https://talkytimes.com${selectedGift.imageSrc || selectedGift.animationSrc}`\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\talt={selectedGift.name}\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-full object-cover\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<div className=\"w-full h-full bg-gray-200 flex items-center justify-center\">\n\t\t\t\t\t\t\t\t\t\t\t<svg className=\"w-4 h-4 text-gray-400\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t\t\t\t\t\t<path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"/>\n\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t{selectedGift.animationSrc && (\n\t\t\t\t\t\t\t\t\t\t<div className=\"absolute top-0 right-0 bg-pink-500 text-white text-xs px-1 py-0.5 rounded\">\n\t\t\t\t\t\t\t\t\t\t\tüé¨\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"flex-1 min-w-0\">\n\t\t\t\t\t\t\t\t\t<h4 className=\"font-medium text-gray-900 truncate\">{selectedGift.name}</h4>\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-1 text-sm text-pink-600\">\n\t\t\t\t\t\t\t\t\t\t<svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t\t\t\t\t<path d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"/>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t{selectedGift.cost}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{/* –ü–æ–ª–µ –≤–≤–µ–¥–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è */}\n\t\t\t\t\t\t\t<div className=\"mb-4\">\n\t\t\t\t\t\t\t\t<label htmlFor=\"gift-message\" className=\"block text-sm font-medium text-gray-700 mb-2\">\n\t\t\t\t\t\t\t\t\t–û—Å–æ–±–∏—Å—Ç–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (–Ω–µ –æ–±–æ–≤'—è–∑–∫–æ–≤–æ)\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<div className=\"relative\">\n\t\t\t\t\t\t\t\t\t<textarea\n\t\t\t\t\t\t\t\t\t\tid=\"gift-message\"\n\t\t\t\t\t\t\t\t\t\tvalue={giftMessage}\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => setGiftMessage(e.target.value)}\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"–ù–∞–ø–∏—à—ñ—Ç—å —Ç–µ–ø–ª–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ø–æ–¥–∞—Ä—É–Ω–∫—É...\"\n\t\t\t\t\t\t\t\t\t\tclassName=\"w-full px-3 py-2 pr-12 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-pink-500 focus:border-pink-500 resize-none\"\n\t\t\t\t\t\t\t\t\t\trows={3}\n\t\t\t\t\t\t\t\t\t\tmaxLength={200}\n\t\t\t\t\t\t\t\t\t\tdisabled={isSendingGift}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t{/* –ö–Ω–æ–ø–∫–∞ –µ–º–æ–¥–∑—ñ */}\n\t\t\t\t\t\t\t\t\t<div className=\"absolute right-2 top-2\">\n\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => setIsGiftEmojiPickerOpen(!isGiftEmojiPickerOpen)}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"text-gray-400 hover:text-gray-600 p-1 rounded transition-colors disabled:opacity-50\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"–î–æ–¥–∞—Ç–∏ –µ–º–æ–¥–∑—ñ\"\n\t\t\t\t\t\t\t\t\t\t\tdisabled={isSendingGift}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\tüòÄ\n\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t{/* EmojiPicker */}\n\t\t\t\t\t\t\t\t\t\t<EmojiPicker\n\t\t\t\t\t\t\t\t\t\t\tisOpen={isGiftEmojiPickerOpen}\n\t\t\t\t\t\t\t\t\t\t\tonEmojiSelect={handleGiftEmojiSelect}\n\t\t\t\t\t\t\t\t\t\t\tonClose={() => setIsGiftEmojiPickerOpen(false)}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"text-xs text-gray-500 mt-1 text-right\">\n\t\t\t\t\t\t\t\t\t{giftMessage.length}/200\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{/* –ö–Ω–æ–ø–∫–∏ –¥—ñ–π */}\n\t\t\t\t\t\t\t<div className=\"flex gap-3\">\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tonClick={() => setIsMessageModalOpen(false)}\n\t\t\t\t\t\t\t\t\tclassName=\"flex-1 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n\t\t\t\t\t\t\t\t\tdisabled={isSendingGift}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t–í—ñ–¥–º—ñ–Ω–∏—Ç–∏\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tonClick={handleSendGift}\n\t\t\t\t\t\t\t\t\tdisabled={isSendingGift}\n\t\t\t\t\t\t\t\t\tclassName=\"flex-1 px-4 py-2 bg-pink-500 hover:bg-pink-600 text-white rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{isSendingGift ? (\n\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t<svg className=\"animate-spin h-4 w-4\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t\t\t\t\t\t<circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" fill=\"none\"/>\n\t\t\t\t\t\t\t\t\t\t\t\t<path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"/>\n\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t–ù–∞–¥—Å–∏–ª–∞—é...\n\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t\t\t<svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t\t\t\t\t\t<path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\" />\n\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t–ù–∞–¥—ñ—Å–ª–∞—Ç–∏\n\t\t\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t<ImagePreviewModal isOpen={isImagePreviewOpen} src={imagePreviewUrl} isLoading={imagePreviewLoading} onClose={() => setIsImagePreviewOpen(false)} />\n\t\t{sourceProfile?.id && (\n\t\t\t<ClientPublicProfileModal\n\t\t\t\tisOpen={isClientProfileOpen}\n\t\t\t\tonClose={() => setIsClientProfileOpen(false)}\n\t\t\t\tprofileId={sourceProfile.id}\n\t\t\t\tclientId={idRegularUser}\n\t\t\t/>\n\t\t)}\n\t\t{sourceProfile?.id && (\n\t\t\t<MyPublicProfileModal\n\t\t\t\tisOpen={isMyProfileOpen}\n\t\t\t\tonClose={() => setIsMyProfileOpen(false)}\n\t\t\t\tprofileId={sourceProfile.id}\n\t\t\t/>\n\t\t)}\n\n\t\t{/* –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –ø–æ—Å—Ç–∞ */}\n\t\t{isPostModalOpen && selectedPost && (\n\t\t\t<div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4\">\n\t\t\t\t<div className=\"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden\">\n\t\t\t\t\t{/* –•–µ–¥–µ—Ä */}\n\t\t\t\t\t<div className=\"flex items-center justify-between p-4 border-b border-gray-200\">\n\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t\t<h3 className=\"text-lg font-semibold text-gray-900\">–ü–æ—Å—Ç</h3>\n\t\t\t\t\t\t\t<div className={`px-3 py-1 rounded-full text-sm font-medium ${\n\t\t\t\t\t\t\t\tselectedPost.isPurchased\n\t\t\t\t\t\t\t\t\t? 'bg-green-100 text-green-800'\n\t\t\t\t\t\t\t\t\t: 'bg-yellow-100 text-yellow-800'\n\t\t\t\t\t\t\t}`}>\n\t\t\t\t\t\t\t\t{selectedPost.isPurchased ? '–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–æ' : '–ù–µ –≤—ñ–¥–∫—Ä–∏—Ç–æ'}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tonClick={() => setIsPostModalOpen(false)}\n\t\t\t\t\t\t\tclassName=\"text-gray-400 hover:text-gray-600 p-1\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t\t<path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* –ö–æ–Ω—Ç–µ–Ω—Ç */}\n\t\t\t\t\t<div className=\"flex-1 overflow-y-auto p-6 custom-scroll\">\n\t\t\t\t\t\t{/* –î–∞—Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ */}\n\t\t\t\t\t\t{selectedPost.dateSent && (\n\t\t\t\t\t\t\t<div className=\"mb-4 text-sm text-gray-600\">\n\t\t\t\t\t\t\t\t<strong>–î–∞—Ç–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏:</strong> {new Date(selectedPost.dateSent).toLocaleString('uk-UA')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{/* –¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ */}\n\t\t\t\t\t\t{selectedPost.text && (\n\t\t\t\t\t\t\t<div className=\"mb-6\">\n\t\t\t\t\t\t\t\t<p className=\"text-gray-800 whitespace-pre-wrap leading-relaxed\">{selectedPost.text}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{/* –ú–µ–¥—ñ–∞ */}\n\t\t\t\t\t\t{(selectedPost.photos?.length > 0 || selectedPost.videos?.length > 0) && (\n\t\t\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t\t\t{/* –§–æ—Ç–æ */}\n\t\t\t\t\t\t\t\t{selectedPost.photos?.length > 0 && (\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<h4 className=\"text-sm font-medium text-gray-700 mb-3\">–§–æ—Ç–æ ({selectedPost.photos.length})</h4>\n\t\t\t\t\t\t\t\t\t\t<div className=\"grid grid-cols-2 md:grid-cols-3 gap-3\">\n\t\t\t\t\t\t\t\t\t\t\t{selectedPost.photos.map((photo: any, index: number) => (\n\t\t\t\t\t\t\t\t\t\t\t\t<div key={photo.id || index} className=\"relative\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={photo.url}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talt={`Photo ${index + 1}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-32 object-cover rounded-lg cursor-zoom-in hover:opacity-90 transition-opacity\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => openPhotoPreview(photo.url)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t{/* –í—ñ–¥–µ–æ */}\n\t\t\t\t\t\t\t\t{selectedPost.videos?.length > 0 && (\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<h4 className=\"text-sm font-medium text-gray-700 mb-3\">–í—ñ–¥–µ–æ ({selectedPost.videos.length})</h4>\n\t\t\t\t\t\t\t\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n\t\t\t\t\t\t\t\t\t\t\t{selectedPost.videos.map((video: any, index: number) => (\n\t\t\t\t\t\t\t\t\t\t\t\t<div key={video.id || index} className=\"relative\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<video\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={video.url}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-32 object-cover rounded-lg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontrols\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{/* –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –æ–ø–ª–∞—Ç—É */}\n\t\t\t\t\t\t{selectedPost.price && (\n\t\t\t\t\t\t\t<div className=\"mt-6 pt-4 border-t border-gray-200\">\n\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-600\">–í–∞—Ä—Ç—ñ—Å—Ç—å:</span>\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-1\">\n\t\t\t\t\t\t\t\t\t\t<svg className=\"w-4 h-4 text-yellow-500\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t\t\t\t\t\t<path d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\"/>\n\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium\">{selectedPost.price}</span>\n\t\t\t\t\t\t\t\t\t\t{selectedPost.priceWithDiscount && selectedPost.priceWithDiscount !== selectedPost.price && (\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-500 ml-1\">({selectedPost.priceWithDiscount})</span>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{selectedPost.discountPercent > 0 && (\n\t\t\t\t\t\t\t\t\t<div className=\"text-xs text-green-600 mt-1\">\n\t\t\t\t\t\t\t\t\t\t–ó–Ω–∏–∂–∫–∞: {selectedPost.discountPercent}%\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t)}\n\t\t</div>\n\n);\n}\n","import { useEffect, useCallback, useState } from 'react';\nimport { useWebSocketPool } from '@/contexts/WebSocketPoolContext';\nimport { useToast } from '@/contexts/ToastContext';\nimport { Socket } from 'socket.io-client';\n\n// –î–µ–¥—É–±–ª—ñ–∫–∞—Ü—ñ—è —Ç–æ—Å—Ç—ñ–≤ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥—ñ (–∫–ª—é—á -> timestamp)\nconst processedToasts = new Map<string, number>();\nconst TOAST_DEDUP_TTL_MS = 30_000;\n\ninterface UseDialogWebSocketOptions {\n  profileId: string;\n  dialogId: string;\n  onMessage?: (message: any) => void;\n  onUserOnlineStatus?: (data: { userId: number; isOnline: boolean }) => void;\n  onDialogLimitChanged?: (data: { idUser: number; idInterlocutor: number; limitLeft: number }) => void;\n}\n\nexport function useDialogWebSocket({\n  profileId,\n  dialogId,\n  onMessage,\n  onUserOnlineStatus,\n  onDialogLimitChanged\n}: UseDialogWebSocketOptions) {\n  const { getSocketForProfile, joinDialog, leaveDialog } = useWebSocketPool();\n  const { showToast } = useToast();\n  const [socket, setSocket] = useState<Socket | null>(null);\n\n  // –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ –¥—ñ–∞–ª–æ–≥—É –∑ debounce\n  useEffect(() => {\n    if (!profileId || !dialogId) return;\n\n\n    \n    // –î–æ–¥–∞—î–º–æ –Ω–µ–≤–µ–ª–∏–∫—É –∑–∞—Ç—Ä–∏–º–∫—É —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ —Å–ø–∞–º—É –ø—Ä–∏ React StrictMode\n    const connectTimer = setTimeout(() => {\n      joinDialog(profileId, dialogId);\n    }, 50);\n\n    return () => {\n      clearTimeout(connectTimer);\n  \n      leaveDialog(profileId, dialogId);\n    };\n  }, [profileId, dialogId, joinDialog, leaveDialog]);\n\n  // –û—Ç—Ä–∏–º—É—î–º–æ —Å–æ–∫–µ—Ç –æ–¥–∏–Ω —Ä–∞–∑ —ñ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ —Å—Ç–µ–π—Ç—ñ\n  useEffect(() => {\n    if (!profileId) return;\n\n    const currentSocket = getSocketForProfile(profileId);\n    setSocket(currentSocket);\n  }, [profileId, getSocketForProfile]);\n\n  // –ü—ñ–¥–ø–∏—Å–∫–∞ –Ω–∞ –ø–æ–¥—ñ—ó\n  useEffect(() => {\n    if (!socket) return;\n\n    const handleMessage = (payload: any) => {\n      onMessage?.(payload);\n    };\n\n    const handleUserOnlineStatus = (data: { userId: number; isOnline: boolean }) => {\n      onUserOnlineStatus?.(data);\n    };\n\n    const handleDialogLimitChanged = (data: { idUser: number; idInterlocutor: number; limitLeft: number }) => {\n      onDialogLimitChanged?.(data);\n    };\n\n    const handleMessageToast = (data: any) => {\n      // –ü–æ–∫–∞–∑—É—î–º–æ toast —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–µ –≤—ñ–¥ –Ω–∞—Å\n      if (data.idUserFrom?.toString?.() === profileId) return;\n\n      // –ö–ª—é—á –¥–ª—è –¥–µ–¥—É–±–ª—ñ–∫–∞—Ü—ñ—ó (–ø–æ–∫—Ä–∏–≤–∞—î —ñ email, —ñ message)\n      const toastType = data.type || 'new_message';\n      const idPart = data.messageId || data.emailId || data.id || data.dialogId || '';\n      const timePart = data.dateCreated || '';\n      const key = `${toastType}:${idPart}:${timePart}`;\n\n      const now = Date.now();\n      // –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä–∏—Ö –∑–∞–ø–∏—Å—ñ–≤\n      for (const [k, ts] of processedToasts) {\n        if (now - ts > TOAST_DEDUP_TTL_MS) processedToasts.delete(k);\n      }\n      const last = processedToasts.get(key);\n      if (last && now - last <= TOAST_DEDUP_TTL_MS) {\n        // –¥—É–±–ª—å ‚Äî —ñ–≥–Ω–æ—Ä—É—î–º–æ\n        return;\n      }\n      processedToasts.set(key, now);\n\n      showToast({\n        messageId: data.messageId,\n        idUserFrom: data.idUserFrom,\n        idUserTo: data.idUserTo,\n        dateCreated: data.dateCreated,\n        type: toastType === 'new_email' ? 'new_email' : 'new_message',\n        dialogId: data.dialogId\n      });\n    };\n\n    // –ü—ñ–¥–ø–∏—Å—É—î–º–æ—Å—è –Ω–∞ –ø–æ–¥—ñ—ó\n    socket.on('message', handleMessage);\n    socket.on('user_online_status', handleUserOnlineStatus);\n    socket.on('message_toast', handleMessageToast);\n    socket.on('dialog_limit_changed', handleDialogLimitChanged);\n\n    return () => {\n      // –í—ñ–¥–ø–∏—Å—É—î–º–æ—Å—è –≤—ñ–¥ –ø–æ–¥—ñ–π\n      socket.off('message', handleMessage);\n      socket.off('user_online_status', handleUserOnlineStatus);\n      socket.off('message_toast', handleMessageToast);\n      socket.off('dialog_limit_changed', handleDialogLimitChanged);\n    };\n  }, [socket, onMessage, onUserOnlineStatus]);\n\n  return {\n    socket,\n    isConnected: socket?.connected || false\n  };\n}\n","'use client';\n\nimport React, { useState, useRef, useEffect } from 'react';\n\ninterface AudioPlayerProps {\n  src: string;\n  title: string;\n  duration: number;\n  audioId?: number;\n  onPlay?: () => void;\n  onPause?: () => void;\n  onEnded?: () => void;\n  onRegister?: (audioId: number, element: HTMLAudioElement) => void;\n  onUnregister?: (audioId: number) => void;\n}\n\nexport const AudioPlayer: React.FC<AudioPlayerProps> = ({\n  src,\n  duration,\n  audioId,\n  onPlay,\n  onPause,\n  onEnded,\n  onRegister,\n  onUnregister\n}) => {\n  const audioRef = useRef<HTMLAudioElement>(null);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [currentTime, setCurrentTime] = useState(0);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —á–∞—Å—É\n  const formatTime = (seconds: number): string => {\n    const mins = Math.floor(seconds / 60);\n    const secs = Math.floor(seconds % 60);\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  };\n\n  // –û–±—Ä–æ–±–∫–∞ –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è/–ø–∞—É–∑–∏\n  const togglePlayPause = async () => {\n    if (!audioRef.current) return;\n\n    try {\n      if (isPlaying) {\n        audioRef.current.pause();\n        setIsPlaying(false);\n        onPause?.();\n      } else {\n        setIsLoading(true);\n        setError(null);\n        await audioRef.current.play();\n        setIsPlaying(true);\n        setIsLoading(false);\n        onPlay?.();\n      }\n    } catch (err) {\n      setIsLoading(false);\n      setError('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞—É–¥—ñ–æ');\n      console.error('Audio playback error:', err);\n    }\n  };\n\n  // –û–±—Ä–æ–±–∫–∞ –∑–º—ñ–Ω–∏ –ø–æ–∑–∏—Ü—ñ—ó\n  const handleSeek = (e: React.MouseEvent<HTMLDivElement>) => {\n    if (!audioRef.current) return;\n\n    const rect = e.currentTarget.getBoundingClientRect();\n    const clickX = e.clientX - rect.left;\n    const width = rect.width;\n    const newTime = (clickX / width) * duration;\n    \n    audioRef.current.currentTime = newTime;\n    setCurrentTime(newTime);\n  };\n\n  // –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∞—É–¥—ñ–æ –µ–ª–µ–º–µ–Ω—Ç–∞\n  useEffect(() => {\n    const audio = audioRef.current;\n    if (!audio || !audioId) return;\n\n    onRegister?.(audioId, audio);\n\n    return () => {\n      onUnregister?.(audioId);\n    };\n  }, [audioId, onRegister, onUnregister]);\n\n  // –û–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π –∞—É–¥—ñ–æ –µ–ª–µ–º–µ–Ω—Ç–∞\n  useEffect(() => {\n    const audio = audioRef.current;\n    if (!audio) return;\n\n    const handleTimeUpdate = () => {\n      setCurrentTime(audio.currentTime);\n    };\n\n    const handleEnded = () => {\n      setIsPlaying(false);\n      setCurrentTime(0);\n      onEnded?.();\n    };\n\n    const handleLoadStart = () => {\n      setIsLoading(true);\n    };\n\n    const handleCanPlay = () => {\n      setIsLoading(false);\n      setError(null);\n    };\n\n    const handleError = () => {\n      setIsLoading(false);\n      setError('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞—É–¥—ñ–æ');\n      setIsPlaying(false);\n    };\n\n    audio.addEventListener('timeupdate', handleTimeUpdate);\n    audio.addEventListener('ended', handleEnded);\n    audio.addEventListener('loadstart', handleLoadStart);\n    audio.addEventListener('canplay', handleCanPlay);\n    audio.addEventListener('error', handleError);\n\n    return () => {\n      audio.removeEventListener('timeupdate', handleTimeUpdate);\n      audio.removeEventListener('ended', handleEnded);\n      audio.removeEventListener('loadstart', handleLoadStart);\n      audio.removeEventListener('canplay', handleCanPlay);\n      audio.removeEventListener('error', handleError);\n    };\n  }, [onEnded]);\n\n  // –û—á–∏—â–µ–Ω–Ω—è –ø—Ä–∏ –∑–º—ñ–Ω—ñ src\n  useEffect(() => {\n    setIsPlaying(false);\n    setCurrentTime(0);\n    setError(null);\n  }, [src]);\n\n  const progress = duration > 0 ? (currentTime / duration) * 100 : 0;\n\n  return (\n    <div className=\"w-full\">\n      <audio ref={audioRef} src={src} preload=\"metadata\" />\n      \n      {/* –ö–æ–Ω—Ç—Ä–æ–ª–∏ */}\n      <div className=\"flex items-center space-x-3\">\n        {/* –ö–Ω–æ–ø–∫–∞ –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è/–ø–∞—É–∑–∏ */}\n        <button\n          onClick={togglePlayPause}\n          disabled={isLoading || !!error}\n          className={`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center transition-colors ${\n            error \n              ? 'bg-red-500 cursor-not-allowed' \n              : isLoading \n              ? 'bg-gray-400 cursor-wait' \n              : 'bg-blue-500 hover:bg-blue-600'\n          } text-white`}\n          title={error || (isLoading ? '–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...' : isPlaying ? '–ü–∞—É–∑–∞' : '–í—ñ–¥—Ç–≤–æ—Ä–∏—Ç–∏')}\n        >\n          {error ? (\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n            </svg>\n          ) : isLoading ? (\n            <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-white\"></div>\n          ) : isPlaying ? (\n            <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path d=\"M6 4h4v16H6V4zm8 0h4v16h-4V4z\" />\n            </svg>\n          ) : (\n            <svg className=\"w-5 h-5 ml-0.5\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path d=\"M8 5v14l11-7z\" />\n            </svg>\n          )}\n        </button>\n\n        {/* –ü—Ä–æ–≥—Ä–µ—Å –±–∞—Ä */}\n        <div className=\"flex-1\">\n          <div \n            className=\"h-2 bg-gray-200 rounded-full cursor-pointer relative overflow-hidden\"\n            onClick={handleSeek}\n          >\n            {/* –ü—Ä–æ–≥—Ä–µ—Å */}\n            <div \n              className=\"h-full bg-blue-500 rounded-full transition-all duration-100\"\n              style={{ width: `${progress}%` }}\n            />\n            \n            {/* –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ–∑–∏—Ü—ñ—ó */}\n            <div \n              className=\"absolute top-1/2 w-3 h-3 bg-blue-600 rounded-full transform -translate-y-1/2 -translate-x-1/2 shadow-sm\"\n              style={{ left: `${progress}%` }}\n            />\n          </div>\n          \n          {/* –ß–∞—Å */}\n          <div className=\"flex justify-between text-xs text-gray-500 mt-1\">\n            <span>{formatTime(currentTime)}</span>\n            <span>{formatTime(duration)}</span>\n          </div>\n        </div>\n      </div>\n\n      {/* –ü–æ–º–∏–ª–∫–∞ */}\n      {error && (\n        <div className=\"mt-2 text-xs text-red-600 text-center\">\n          {error}\n        </div>\n      )}\n    </div>\n  );\n};\n","'use client';\n\nimport React, { useState, useEffect, useCallback, useMemo, useRef } from 'react';\nimport { apiGet, apiPost } from '@/lib/api';\nimport { AudioPlayer } from './AudioPlayer';\n\nexport interface PhotoTag {\n  code: string;\n  description: string;\n}\n\nexport interface PhotoUrls {\n  urlOriginal: string;\n  urlPreview: string;\n  urlStandard: string;\n}\n\nexport interface VideoUrls {\n  urlMp4Hd: string;\n  urlMp4Sd: string;\n  urlThumbnail: string;\n}\n\nexport interface PhotoStatus {\n  code: string;\n  description: string;\n}\n\nexport interface Photo {\n  idPhoto: number;\n  idUser: number;\n  status: PhotoStatus;\n  tags: PhotoTag[];\n  declineReasons: string[];\n  comment: string;\n  urls: PhotoUrls;\n  canDisagree: boolean;\n}\n\nexport interface Video {\n  idVideo: number;\n  idUser: number;\n  status: PhotoStatus;\n  tags: PhotoTag[];\n  declineReasons: string[];\n  comment: string;\n  urls: VideoUrls;\n  duration: number;\n}\n\nexport interface PhotoConnectionStatus {\n  idPhoto: number;\n  status: 'accessed' | 'sent' | null;\n}\n\nexport interface VideoConnectionStatus {\n  idVideo: number;\n  status: 'accessed' | 'sent' | null;\n}\n\nexport interface AudioUrls {\n  mp3: string;\n  ogg: string;\n}\n\nexport interface Audio {\n  id: number;\n  idUser: number;\n  status: string;\n  // –û–±—á–∏—Å–ª–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å –∑—ñ —Å—Ç–æ—Ä–æ–Ω–∏ –¥—ñ–∞–ª–æ–≥—É (–∑ –º–∞–ø–∏ —Å—Ç–∞—Ç—É—Å—ñ–≤)\n  statusComputed?: 'accessed' | 'sent' | null;\n  title: string;\n  duration: number;\n  dateCreated: string;\n  dateUpdated: string;\n  declineReasons: string[];\n  urls: AudioUrls;\n}\n\nexport interface AudioGalleryResponse {\n  cursor: string;\n  items: Audio[];\n}\n\nexport interface AudioConnectionStatus {\n  idAudio: number;\n  status: 'accessed' | 'sent' | null;\n}\n\ninterface CachedPhotoData {\n  idPhoto: number;\n  idProfile: number;\n  idUser: number;\n  urlPreview: string;\n  urlOriginal: string;\n  status: 'accessed' | 'sent' | null;\n  category: 'regular' | 'special' | 'temporary';\n  lastAccessed: number; // timestamp –∫–æ–ª–∏ –æ—Å—Ç–∞–Ω–Ω—ñ–π —Ä–∞–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–æ—Å—å\n  tags: PhotoTag[]; // –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó\n}\n\nexport interface GalleryResponse {\n  cursor: string;\n  photos: Photo[];\n}\n\nexport interface VideoGalleryResponse {\n  cursor: string;\n  videos: Video[];\n}\n\ninterface MediaGalleryProps {\n  profileId: string;\n  isOpen: boolean;\n  onClose: () => void;\n  onPhotoSelect: (photos: Photo[]) => void;\n  maxSelection?: number;\n  context?: 'chat' | 'profile' | 'other'; // –ö–æ–Ω—Ç–µ–∫—Å—Ç –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –≥–∞–ª–µ—Ä–µ—ó\n  idRegularUser?: number; // ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ç–æ –≤ —á–∞—Ç\n  // –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –¥–ª—è —Ä–µ–∂–∏–º—É –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è (–±–µ–∑ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –Ω–∞ –±–µ–∫)\n  mode?: 'send' | 'attach';\n  actionLabel?: string; // –¢–µ–∫—Å—Ç –Ω–∞ –∫–Ω–æ–ø—Ü—ñ –¥—ñ—ó\n  allowAudio?: boolean; // –ü—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è –Ω–µ –ø–æ–∫–∞–∑—É—î –∞—É–¥—ñ–æ\n  allowedPhotoTabs?: Array<'regular' | 'special' | 'special_plus' | 'temporary'>; // –Ø–∫—ñ –≤–∫–ª–∞–¥–∫–∏ —Ñ–æ—Ç–æ –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏\n  isSpecialPlusAllowed?: boolean; // –ö–µ—Ä—É–≤–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø–æ–º –¥–æ special_plus\n  onAttach?: (payload: { photos: Photo[]; videos: Video[] }) => void; // –ö–æ–ª–±–µ–∫ –¥–ª—è —Ä–µ–∂–∏–º—É attach\n}\n\nexport function MediaGallery({ \n  profileId, \n  isOpen, \n  onClose, \n  onPhotoSelect, \n  maxSelection = 6,\n  context = 'other',\n  idRegularUser,\n  mode = 'send',\n  actionLabel,\n  allowAudio = true,\n  allowedPhotoTabs,\n  isSpecialPlusAllowed = true,\n  onAttach\n}: MediaGalleryProps) {\n  // –í–∞–ª—ñ–¥–∞—Ü—ñ—è props\n  if (!profileId || isNaN(parseInt(profileId))) {\n    throw new Error('MediaGallery: profileId must be a valid number string');\n  }\n  \n  if (context === 'chat' && !idRegularUser) {\n    console.warn('MediaGallery: idRegularUser is required when context is \"chat\"');\n  }\n  const [photos, setPhotos] = useState<Photo[]>([]);\n  const [videos, setVideos] = useState<Video[]>([]);\n  const [selectedPhotos, setSelectedPhotos] = useState<Photo[]>([]);\n  const [selectedVideos, setSelectedVideos] = useState<Video[]>([]);\n  const [audios, setAudios] = useState<Audio[]>([]);\n  const [selectedAudios, setSelectedAudios] = useState<Audio[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [regularCursor, setRegularCursor] = useState('');\n  const [temporaryCursor, setTemporaryCursor] = useState('');\n  const [videoCursor, setVideoCursor] = useState('');\n  const [audioCursor, setAudioCursor] = useState('');\n  const [hasMore, setHasMore] = useState(true);\n  const [hasMoreVideos, setHasMoreVideos] = useState(true);\n  const [hasMoreAudios, setHasMoreAudios] = useState(true);\n\n  const [photoType, setPhotoType] = useState<'regular' | 'special' | 'special_plus' | 'temporary'>(mode === 'attach' ? 'special' : 'regular');\n  const [activeTab, setActiveTab] = useState<'regular' | 'special' | 'special_plus' | 'temporary'>(mode === 'attach' ? 'special' : 'regular');\n  const [mediaType, setMediaType] = useState<'photo' | 'video' | 'audio'>('photo');\n  \n  const [fullSizePhoto, setFullSizePhoto] = useState<Photo | null>(null);\n  const [fullSizeVideo, setFullSizeVideo] = useState<Video | null>(null);\n  const [photoStatuses, setPhotoStatuses] = useState<Map<number, 'accessed' | 'sent' | null>>(new Map());\n  const [videoStatuses, setVideoStatuses] = useState<Map<number, 'accessed' | 'sent' | null>>(new Map());\n  const [audioStatuses, setAudioStatuses] = useState<Map<number, 'accessed' | 'sent' | null>>(new Map());\n  const [statusFilter, setStatusFilter] = useState<'all' | 'available' | 'accessed' | 'sent'>('all');\n  const [statusRequestedPhotos, setStatusRequestedPhotos] = useState<Set<number>>(new Set()); // –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ —Å—Ç–∞—Ç—É—Å—ñ–≤\n  const [statusRequestedVideos, setStatusRequestedVideos] = useState<Set<number>>(new Set()); // –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ —Å—Ç–∞—Ç—É—Å—ñ–≤ –≤—ñ–¥–µ–æ\n  const [statusRequestedAudios, setStatusRequestedAudios] = useState<Set<number>>(new Set()); // –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ —Å—Ç–∞—Ç—É—Å—ñ–≤ –∞—É–¥—ñ–æ\n  const [temporaryPhotoIds, setTemporaryPhotoIds] = useState<Set<number>>(new Set()); // –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è temporary —Ñ–æ—Ç–æ\n  \n  // –°—Ç–∞–Ω –¥–ª—è –∞—É–¥—ñ–æ –ø–ª–µ—î—Ä–∞\n  const [currentPlayingAudio, setCurrentPlayingAudio] = useState<Audio | null>(null);\n  const audioPlayersRef = useRef<Map<number, HTMLAudioElement>>(new Map());\n  const [autoLoadAttempts, setAutoLoadAttempts] = useState(0); // –õ—ñ—á–∏–ª—å–Ω–∏–∫ —Å–ø—Ä–æ–± –∞–≤—Ç–æ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è\n\n  // –ö–µ—à —Ñ—É–Ω–∫—Ü—ñ—ó\n  const UNIFIED_PHOTO_CACHE_KEY = `gallery_unified_photos_${profileId}`;\n  const FILTER_CACHE_KEY = `gallery_filters_${profileId}`;\n  const CACHE_DURATION = 24 * 60 * 60 * 1000; // 24 –≥–æ–¥–∏–Ω–∏\n\n  // –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ —î–¥–∏–Ω–∏–º –∫–µ—à–µ–º —Ñ–æ—Ç–æ\n  const loadUnifiedPhotoCache = useCallback((): Map<number, CachedPhotoData> => {\n    try {\n      const cachedData = localStorage.getItem(UNIFIED_PHOTO_CACHE_KEY);\n      if (!cachedData) return new Map();\n\n      const parsedData = JSON.parse(cachedData) as Record<string, CachedPhotoData>;\n      const now = Date.now();\n      const validData = new Map<number, CachedPhotoData>();\n\n      // –§—ñ–ª—å—Ç—Ä—É—î–º–æ –∑–∞—Å—Ç–∞—Ä—ñ–ª—ñ –¥–∞–Ω—ñ —Ç–∞ –æ–Ω–æ–≤–ª—é—î–º–æ lastAccessed\n      Object.entries(parsedData).forEach(([idPhoto, photoData]) => {\n        const age = now - photoData.lastAccessed;\n        if (age <= CACHE_DURATION) {\n          // –û–Ω–æ–≤–ª—é—î–º–æ lastAccessed –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ (–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ)\n          validData.set(parseInt(idPhoto), {\n            ...photoData,\n            lastAccessed: now\n          });\n        }\n      });\n\n      // –ü–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–∫–ª—é—á–∞—î–º–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–µ—à—É\n      // if (process.env.NODE_ENV === 'development' && validData.size > 0) {\n      //   console.log('üì¶ Loaded from unified cache:', validData.size, 'photos');\n      // }\n      return validData;\n    } catch (error) {\n      console.warn('Failed to load unified photo cache:', error);\n      return new Map();\n    }\n  }, [UNIFIED_PHOTO_CACHE_KEY, CACHE_DURATION]);\n\n  // Debounced save function –¥–ª—è –∑–º–µ–Ω—à–µ–Ω–Ω—è —á–∞—Å—Ç–æ—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è\n  const debouncedSave = useRef<NodeJS.Timeout | null>(null);\n  \n  const saveUnifiedPhotoCache = useCallback((cacheMap: Map<number, CachedPhotoData>) => {\n    // –°–∫–∞—Å–æ–≤—É—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ç–∞–π–º–µ—Ä\n    if (debouncedSave.current) {\n      clearTimeout(debouncedSave.current);\n    }\n    \n    // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –Ω–æ–≤–∏–π —Ç–∞–π–º–µ—Ä –Ω–∞ 500–º—Å\n    debouncedSave.current = setTimeout(() => {\n      try {\n        // –ö–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ Map –≤ –æ–±'—î–∫—Ç –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è\n        const cacheObject = Object.fromEntries(cacheMap);\n        localStorage.setItem(UNIFIED_PHOTO_CACHE_KEY, JSON.stringify(cacheObject));\n        // –ü–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–∫–ª—é—á–∞—î–º–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–µ—à—É\n        // if (process.env.NODE_ENV === 'development' && cacheMap.size > 1000) {\n        //   console.log('üì¶ Unified cache saved:', cacheMap.size, 'photos');\n        // }\n      } catch (error) {\n        console.warn('Failed to save unified photo cache:', error);\n      }\n    }, 500);\n  }, [UNIFIED_PHOTO_CACHE_KEY]);\n\n  // Cleanup debounced save on unmount\n  useEffect(() => {\n    return () => {\n      console.log('üßπ MediaGallery unmounting, cleaning up resources...');\n      \n      // –û—á–∏—â—É—î–º–æ debounced save\n      if (debouncedSave.current) {\n        clearTimeout(debouncedSave.current);\n        debouncedSave.current = null;\n      }\n    };\n  }, []);\n\n  // –ú–µ–º–æ—ñ–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ special —Ç–µ–≥—ñ–≤\n  const hasTag = useCallback((photo: Photo, code: string) => photo.tags?.some(tag => tag.code === code) ?? false, []);\n  const isSpecialPhoto = useCallback((photo: Photo) => hasTag(photo, 'special') || hasTag(photo, 'special_plus'), [hasTag]);\n  const isSpecialPlusPhoto = useCallback((photo: Photo) => hasTag(photo, 'special_plus'), [hasTag]);\n  const isSpecialExactPhoto = useCallback((photo: Photo) => hasTag(photo, 'special') && !hasTag(photo, 'special_plus'), [hasTag]);\n\n  // –ú–µ–º–æ—ñ–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ temporary —Ñ–æ—Ç–æ\n  const isTemporaryPhoto = useCallback((photo: Photo) => {\n    // Temporary —Ñ–æ—Ç–æ - —Ü–µ —Ç—ñ —â–æ –ø—Ä–∏–π—à–ª–∏ –∑ –∑–∞–ø–∏—Ç—É isTemporary=true\n    return temporaryPhotoIds.has(photo.idPhoto);\n  }, [temporaryPhotoIds]);\n\n  const addPhotosToUnifiedCache = useCallback((photos: Photo[], isTemporary: boolean = false) => {\n    try {\n      const cacheMap = loadUnifiedPhotoCache();\n      const now = Date.now();\n      let newCount = 0;\n\n      photos.forEach(photo => {\n        if (!cacheMap.has(photo.idPhoto)) {\n          // –í–∏–∑–Ω–∞—á–∞—î–º–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é —Ñ–æ—Ç–æ\n          let category: 'regular' | 'special' | 'temporary' = 'regular';\n          if (isTemporary) {\n            category = 'temporary';\n          } else if (isSpecialPhoto(photo)) {\n            category = 'special';\n          }\n\n          cacheMap.set(photo.idPhoto, {\n            idPhoto: photo.idPhoto,\n            idProfile: parseInt(profileId),\n            idUser: photo.idUser,\n            urlPreview: photo.urls.urlPreview,\n            urlOriginal: photo.urls.urlOriginal,\n            status: null, // –ë—É–¥–µ –æ–Ω–æ–≤–ª–µ–Ω–æ –ø—ñ–∑–Ω—ñ—à–µ\n            category,\n            lastAccessed: now,\n            tags: photo.tags\n          });\n          newCount++;\n        } else {\n          // –û–Ω–æ–≤–ª—é—î–º–æ lastAccessed –¥–ª—è —ñ—Å–Ω—É—é—á–∏—Ö —Ñ–æ—Ç–æ\n          const existing = cacheMap.get(photo.idPhoto)!;\n          cacheMap.set(photo.idPhoto, {\n            ...existing,\n            lastAccessed: now\n          });\n        }\n      });\n\n      if (newCount > 0) {\n        saveUnifiedPhotoCache(cacheMap);\n        console.log('üì¶ Added to unified cache:', newCount, 'new photos, total:', cacheMap.size);\n      }\n\n      return cacheMap;\n    } catch (error) {\n      console.warn('Failed to add photos to unified cache:', error);\n      return loadUnifiedPhotoCache();\n    }\n  }, [loadUnifiedPhotoCache, saveUnifiedPhotoCache, profileId, isSpecialPhoto]);\n\n  // –ú–µ–º–æ—ñ–∑–æ–≤–∞–Ω–∏–π –∫–µ—à –¥–ª—è –∑–º–µ–Ω—à–µ–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ–π –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è\n  const [cachedPhotoMap, setCachedPhotoMap] = useState<Map<number, CachedPhotoData> | null>(null);\n  \n  const getCachedPhotoMap = useCallback(() => {\n    if (!cachedPhotoMap) {\n      const loaded = loadUnifiedPhotoCache();\n      setCachedPhotoMap(loaded);\n      return loaded;\n    }\n    return cachedPhotoMap;\n  }, [cachedPhotoMap, loadUnifiedPhotoCache]);\n\n  const updatePhotoStatusesInCache = useCallback((statuses: Map<number, 'accessed' | 'sent' | null>) => {\n    try {\n      const cacheMap = getCachedPhotoMap(); // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –º–µ–º–æ—ñ–∑–æ–≤–∞–Ω–∏–π –∫–µ—à\n      const now = Date.now();\n      let updatedCount = 0;\n\n      statuses.forEach((status, idPhoto) => {\n        if (cacheMap.has(idPhoto)) {\n          const existing = cacheMap.get(idPhoto)!;\n          cacheMap.set(idPhoto, {\n            ...existing,\n            status,\n            lastAccessed: now // –û–Ω–æ–≤–ª—é—î–º–æ —á–∞—Å –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ —Å—Ç–∞—Ç—É—Å—É\n          });\n          updatedCount++;\n        }\n      });\n\n      if (updatedCount > 0) {\n        setCachedPhotoMap(new Map(cacheMap)); // –û–Ω–æ–≤–ª—é—î–º–æ –º–µ–º–æ—ñ–∑–æ–≤–∞–Ω–∏–π —Å—Ç–µ–π—Ç\n        saveUnifiedPhotoCache(cacheMap); // Debounced –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è\n      }\n\n      return cacheMap;\n    } catch (error) {\n      console.warn('Failed to update photo statuses in unified cache:', error);\n      return getCachedPhotoMap();\n    }\n  }, [getCachedPhotoMap, saveUnifiedPhotoCache, setCachedPhotoMap]);\n\n  // –¶–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ –ª–æ–≥—ñ–∫–∞ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó —Ñ–æ—Ç–æ\n  const filterPhotosByTypeAndStatus = useCallback((\n    photos: Photo[], \n    photoType: 'regular' | 'special' | 'special_plus' | 'temporary', \n    statusFilter: 'all' | 'available' | 'accessed' | 'sent',\n    context: string\n  ): Photo[] => {\n    let filtered = photos;\n\n    // –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∑–∞ —Ç–∏–ø–æ–º (—Ç—ñ–ª—å–∫–∏ –≤ —á–∞—Ç—ñ)\n    if (context === 'chat') {\n      switch (photoType) {\n        case 'regular':\n          filtered = photos.filter(photo => !isSpecialPhoto(photo) && !isTemporaryPhoto(photo));\n          break;\n        case 'special':\n          // –õ–∏—à–µ —Ç–æ—á–Ω—ñ special (–±–µ–∑ special_plus)\n          filtered = photos.filter(photo => isSpecialExactPhoto(photo));\n          break;\n        case 'special_plus':\n          filtered = photos.filter(photo => isSpecialPlusPhoto(photo));\n          break;\n        case 'temporary':\n          // –¢–∏–º—á–∞—Å–æ–≤—ñ —Ñ–æ—Ç–æ - —Ç—ñ–ª—å–∫–∏ —Ç—ñ —â–æ temporary –∞–ª–µ –ù–ï special\n          filtered = photos.filter(photo => isTemporaryPhoto(photo) && !isSpecialPhoto(photo));\n          break;\n        default:\n          filtered = photos;\n      }\n    }\n\n    // –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∑–∞ —Å—Ç–∞—Ç—É—Å–æ–º\n    if (statusFilter !== 'all') {\n      filtered = filtered.filter(photo => {\n        const status = photoStatuses.get(photo.idPhoto);\n        switch (statusFilter) {\n          case 'available':\n            return status === null || typeof status === 'undefined';\n          case 'accessed':\n            return status === 'accessed'; // –¢—ñ–ª—å–∫–∏ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç—ñ\n          case 'sent':\n            return status === 'sent'; // –¢—ñ–ª—å–∫–∏ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ\n          default:\n            return true;\n        }\n      });\n    }\n\n    return filtered;\n  }, [isSpecialPhoto, isTemporaryPhoto, photoStatuses]);\n\n  // –§—É–Ω–∫—Ü—ñ—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –≤—ñ–¥–µ–æ –∑–∞ —Å—Ç–∞—Ç—É—Å–æ–º\n  const filterVideosByStatus = useCallback((\n    videos: Video[], \n    statusFilter: 'all' | 'available' | 'accessed' | 'sent'\n  ): Video[] => {\n    // –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∑–∞ —Å—Ç–∞—Ç—É—Å–æ–º\n    if (statusFilter !== 'all') {\n      return videos.filter(video => {\n        const status = videoStatuses.get(video.idVideo);\n        switch (statusFilter) {\n          case 'available':\n            return status === null || typeof status === 'undefined';\n          case 'accessed':\n            return status === 'accessed'; // –¢—ñ–ª—å–∫–∏ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç—ñ\n          case 'sent':\n            return status === 'sent'; // –¢—ñ–ª—å–∫–∏ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ\n          default:\n            return true;\n        }\n      });\n    }\n\n    return videos;\n  }, [videoStatuses]);\n\n  const convertCacheToPhotos = useCallback((cacheMap: Map<number, CachedPhotoData>): Photo[] => {\n    return Array.from(cacheMap.values()).map(cached => ({\n      idPhoto: cached.idPhoto,\n      idUser: cached.idUser,\n      urls: {\n        urlPreview: cached.urlPreview,\n        urlOriginal: cached.urlOriginal,\n        urlStandard: cached.urlPreview // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ preview —è–∫ standard\n      },\n      tags: cached.tags,\n      comment: '', // –ù–µ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ –∫–µ—à—ñ\n      canDisagree: false, // –ù–µ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –≤ –∫–µ—à—ñ\n      status: { code: '', description: '' }, // –î–æ–¥–∞—î–º–æ –ø–æ–ª–µ status\n      declineReasons: [] // –î–æ–¥–∞—î–º–æ –ø–æ–ª–µ declineReasons\n    })).sort((a, b) => b.idPhoto - a.idPhoto);\n  }, []);\n\n\n\n\n\n  // –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—î–º–æ activeTab –∑ photoType\n  useEffect(() => {\n    setPhotoType(activeTab);\n    // –°–∫–∏–¥–∞—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫ —Å–ø—Ä–æ–± –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Ä–æ–∑–¥—ñ–ª—É\n    setAutoLoadAttempts(0);\n  }, [activeTab]);\n\n  // –°–∫–∏–¥–∞—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫ —Å–ø—Ä–æ–± –ø—Ä–∏ –∑–º—ñ–Ω—ñ —Ñ—ñ–ª—å—Ç—Ä–∞ —Å—Ç–∞—Ç—É—Å—ñ–≤\n  useEffect(() => {\n    setAutoLoadAttempts(0);\n  }, [statusFilter]);\n\n  // –ó–∞–≤–∂–¥–∏ –∞–∫—Ç–∏–≤—É—î–º–æ –ø–µ—Ä—à—É –¥–æ–∑–≤–æ–ª–µ–Ω—É –≤–∫–ª–∞–¥–∫—É –ø—Ä–∏ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ (—ñ–≥–Ω–æ—Ä—É—î–º–æ –∫–µ—à –¥–ª—è photoType)\n  useEffect(() => {\n    if (isOpen) {\n      let initial: 'regular' | 'special' | 'special_plus' | 'temporary' = 'regular';\n      if (mode === 'attach') {\n        // –î–ª—è attach –≤—ñ–¥–¥–∞—î–º–æ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç special\n        if (!allowedPhotoTabs || allowedPhotoTabs.includes('special')) initial = 'special';\n        else if (allowedPhotoTabs.includes('special_plus')) initial = 'special_plus';\n        else if (allowedPhotoTabs.includes('regular')) initial = 'regular';\n        else if (allowedPhotoTabs.includes('temporary')) initial = 'temporary';\n      } else {\n        // –î–ª—è –∑–≤–∏—á–∞–π–Ω–æ–≥–æ —Ä–µ–∂–∏–º—É: –ø–µ—Ä—à–∞ –∑ –¥–æ–∑–≤–æ–ª–µ–Ω–∏—Ö\n        if (allowedPhotoTabs && allowedPhotoTabs.length > 0) initial = allowedPhotoTabs[0];\n        else initial = 'regular';\n      }\n      setActiveTab(initial);\n      setPhotoType(initial);\n      // —Å—Ç–∞—Ç—É—Å-—Ñ—ñ–ª—å—Ç—Ä –º–æ–∂–µ–º–æ –±—Ä–∞—Ç–∏ –∑ –∫–µ—à—É —è–∫ —ñ —Ä–∞–Ω—ñ—à–µ\n      try {\n        const cachedFilters = localStorage.getItem(`gallery_filters_${profileId}`);\n        if (cachedFilters) {\n          const filters = JSON.parse(cachedFilters);\n          if (filters.statusFilter) setStatusFilter(filters.statusFilter);\n        }\n      } catch (e) {\n        // ignore\n      }\n    }\n  }, [isOpen, mode, allowedPhotoTabs, profileId]);\n\n  // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Ñ—ñ–ª—å—Ç—Ä–∏ –≤ –∫–µ—à –ø—Ä–∏ –∑–º—ñ–Ω—ñ\n  useEffect(() => {\n    if (isOpen) {\n      const timeoutId = setTimeout(() => {\n        try {\n          const filtersToSave = { photoType, statusFilter };\n          localStorage.setItem(`gallery_filters_${profileId}`, JSON.stringify(filtersToSave));\n          console.log('üíæ Filters saved to cache:', filtersToSave);\n        } catch (error) {\n          console.warn('Failed to save filters to cache:', error);\n        }\n      }, 200); // –ó–∞—Ç—Ä–∏–º–∫–∞ —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø—ñ–¥ —á–∞—Å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è\n\n      return () => clearTimeout(timeoutId);\n    }\n  }, [photoType, statusFilter, isOpen]);\n\n  const [error, setError] = useState<string | null>(null);\n  const scrollContainerRef = useRef<HTMLDivElement>(null);\n  const hasMoreRef = useRef(hasMore);\n  const regularCursorRef = useRef(regularCursor);\n  const temporaryCursorRef = useRef(temporaryCursor);\n  const loadPhotosRef = useRef<((reset?: boolean) => Promise<void>) | null>(null);\n\n  // –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—î–º–æ ref –∑ state\n  useEffect(() => {\n    hasMoreRef.current = hasMore;\n    regularCursorRef.current = regularCursor;\n    temporaryCursorRef.current = temporaryCursor;\n  }, [hasMore, regularCursor, temporaryCursor]);\n\n  // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—ñ–≤ –≤—ñ–¥–µ–æ –∑ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è–º (–±–∞—Ç—á–∞–º–∏ –ø–æ 100)\n  const loadVideoStatuses = useCallback(async (videos: Video[], idUser: number) => {\n    if (videos.length === 0) return;\n\n    // –§—ñ–ª—å—Ç—Ä—É—î–º–æ —Ç—ñ–ª—å–∫–∏ —Ç—ñ –≤—ñ–¥–µ–æ, –¥–ª—è —è–∫–∏—Ö —â–µ –Ω–µ –∑–∞–ø–∏—Ç—É–≤–∞–ª–∏ —Å—Ç–∞—Ç—É—Å–∏\n    const videosToRequest = videos.filter(video => !statusRequestedVideos.has(video.idVideo));\n    \n    if (videosToRequest.length === 0) {\n      return;\n    }\n\n    // –†–æ–∑–±–∏–≤–∞—î–º–æ –Ω–∞ –±–∞—Ç—á—ñ –ø–æ 100 –≤—ñ–¥–µ–æ\n    const batchSize = 100;\n    const batches = [];\n    for (let i = 0; i < videosToRequest.length; i += batchSize) {\n      batches.push(videosToRequest.slice(i, i + batchSize));\n    }\n\n    // –û–±—Ä–æ–±–ª—è—î–º–æ –∫–æ–∂–µ–Ω –±–∞—Ç—á\n    for (let batchIndex = 0; batchIndex < batches.length; batchIndex++) {\n      const batch = batches[batchIndex];\n\n      try {\n        const idsVideos = batch.map(v => v.idVideo);\n        \n        // –í—ñ–¥–º—ñ—á–∞—î–º–æ —â–æ –¥–ª—è —Ü–∏—Ö –≤—ñ–¥–µ–æ –∑–∞–ø–∏—Ç –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ\n        setStatusRequestedVideos(prev => {\n          const newSet = new Set(prev);\n          idsVideos.forEach(id => newSet.add(id));\n          return newSet;\n        });\n\n        const response = await apiPost('/api/gallery/video-statuses', {\n          idUser,\n          idsVideos,\n          profileId: parseInt(profileId)\n        });\n\n        const typedResponse = response as { success: boolean; data?: { videos?: VideoConnectionStatus[]; data?: { videos?: VideoConnectionStatus[] } }; error?: string };\n        const videosList = typedResponse.success && typedResponse.data \n          ? (typedResponse.data.videos ?? typedResponse.data.data?.videos)\n          : undefined;\n        if (videosList && Array.isArray(videosList)) {\n          setVideoStatuses(prev => {\n            const newStatusMap = new Map(prev);\n            videosList.forEach((videoStatus: VideoConnectionStatus) => {\n              newStatusMap.set(videoStatus.idVideo, videoStatus.status);\n            });\n            \n            return newStatusMap;\n          });\n        } else {\n          // –£ –≤–∏–ø–∞–¥–∫—É –ø–æ–º–∏–ª–∫–∏ - –≤–∏–¥–∞–ª—è—î–º–æ –∑ —Å–ø–∏—Å–∫—É –∑–∞–ø–∏—Ç–∞–Ω–∏—Ö, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–æ–≤—É\n          setStatusRequestedVideos(prev => {\n            const newSet = new Set(prev);\n            batch.forEach(video => newSet.delete(video.idVideo));\n            return newSet;\n          });\n        }\n      } catch (error) {\n        // –£ –≤–∏–ø–∞–¥–∫—É –ø–æ–º–∏–ª–∫–∏ - –≤–∏–¥–∞–ª—è—î–º–æ –∑ —Å–ø–∏—Å–∫—É –∑–∞–ø–∏—Ç–∞–Ω–∏—Ö, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–æ–≤—É\n        setStatusRequestedVideos(prev => {\n          const newSet = new Set(prev);\n          batch.forEach(video => newSet.delete(video.idVideo));\n          return newSet;\n        });\n      }\n\n      // –ù–µ–≤–µ–ª–∏–∫–∞ –∑–∞—Ç—Ä–∏–º–∫–∞ –º—ñ–∂ –±–∞—Ç—á–∞–º–∏ —â–æ–± –Ω–µ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ API\n      if (batchIndex < batches.length - 1) {\n        await new Promise(resolve => setTimeout(resolve, 100));\n      }\n    }\n  }, [profileId, statusRequestedVideos]);\n\n  // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—ñ–≤ —Ñ–æ—Ç–æ –∑ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è–º (–±–∞—Ç—á–∞–º–∏ –ø–æ 100)\n  const loadPhotoStatuses = useCallback(async (photos: Photo[], idUser: number) => {\n    if (photos.length === 0) return;\n\n    // –§—ñ–ª—å—Ç—Ä—É—î–º–æ —Ç—ñ–ª—å–∫–∏ —Ç—ñ —Ñ–æ—Ç–æ, –¥–ª—è —è–∫–∏—Ö —â–µ –Ω–µ –∑–∞–ø–∏—Ç—É–≤–∞–ª–∏ —Å—Ç–∞—Ç—É—Å–∏\n    const photosToRequest = photos.filter(photo => !statusRequestedPhotos.has(photo.idPhoto));\n    \n    if (photosToRequest.length === 0) {\n      console.log('üìä All photo statuses already requested');\n      return;\n    }\n\n    console.log(`üìä Requesting statuses for ${photosToRequest.length} photos (${photos.length} total, ${photos.length - photosToRequest.length} already requested)`);\n\n    // –†–æ–∑–±–∏–≤–∞—î–º–æ –Ω–∞ –±–∞—Ç—á—ñ –ø–æ 100 —Ñ–æ—Ç–æ\n    const batchSize = 100;\n    const batches = [];\n    for (let i = 0; i < photosToRequest.length; i += batchSize) {\n      batches.push(photosToRequest.slice(i, i + batchSize));\n    }\n\n    // –ü–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–∫–ª—é—á–∞—î–º–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è –±–∞—Ç—á—ñ–≤\n    // if (process.env.NODE_ENV === 'development' && batches.length > 5) {\n    //   console.log(`üìä Processing ${batches.length} batches of photo statuses`);\n    // }\n\n    // –û–±—Ä–æ–±–ª—è—î–º–æ –∫–æ–∂–µ–Ω –±–∞—Ç—á\n    for (let batchIndex = 0; batchIndex < batches.length; batchIndex++) {\n      const batch = batches[batchIndex];\n      \n      // –ü–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–∫–ª—é—á–∞—î–º–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è –æ–∫—Ä–µ–º–∏—Ö –±–∞—Ç—á—ñ–≤\n      // if (process.env.NODE_ENV === 'development' && (batchIndex + 1) % 5 === 0) {\n      //   console.log(`üìä Processing batch ${batchIndex + 1}/${batches.length} with ${batch.length} photos`);\n      // }\n\n      try {\n        const idsPhotos = batch.map(p => p.idPhoto);\n        \n        // –í—ñ–¥–º—ñ—á–∞—î–º–æ —â–æ –¥–ª—è —Ü–∏—Ö —Ñ–æ—Ç–æ –∑–∞–ø–∏—Ç –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ\n        setStatusRequestedPhotos(prev => {\n          const newSet = new Set(prev);\n          idsPhotos.forEach(id => newSet.add(id));\n          return newSet;\n        });\n\n        const response = await apiPost('/api/gallery/photo-statuses', {\n          idUser,\n          idsPhotos,\n          profileId: parseInt(profileId)\n        });\n\n        const typedResponse = response as { success: boolean; data?: { photos?: PhotoConnectionStatus[]; data?: { photos?: PhotoConnectionStatus[] } }; error?: string };\n        const photosList = typedResponse.success && typedResponse.data \n          ? (typedResponse.data.photos ?? typedResponse.data.data?.photos)\n          : undefined;\n        if (photosList && Array.isArray(photosList)) {\n          // –ü–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–∫–ª—é—á–∞—î–º–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –±–∞—Ç—á—ñ–≤\n          // if (process.env.NODE_ENV === 'development' && ((batchIndex + 1) % 10 === 0 || batchIndex === batches.length - 1)) {\n          //   console.log(`üìä Batch ${batchIndex + 1}: Received statuses for ${typedResponse.data.photos.length} photos`);\n          // }\n          setPhotoStatuses(prev => {\n            const newStatusMap = new Map(prev);\n            photosList.forEach((photoStatus: PhotoConnectionStatus) => {\n              newStatusMap.set(photoStatus.idPhoto, photoStatus.status);\n            });\n            \n            // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –æ–Ω–æ–≤–ª–µ–Ω—ñ —Å—Ç–∞—Ç—É—Å–∏ –≤ —î–¥–∏–Ω–∏–π –∫–µ—à\n            updatePhotoStatusesInCache(newStatusMap);\n            \n            return newStatusMap;\n          });\n        } else {\n          console.error(`‚ùå Batch ${batchIndex + 1}: Failed to load photo statuses:`, typedResponse.error);\n          \n          // –£ –≤–∏–ø–∞–¥–∫—É –ø–æ–º–∏–ª–∫–∏ - –≤–∏–¥–∞–ª—è—î–º–æ –∑ —Å–ø–∏—Å–∫—É –∑–∞–ø–∏—Ç–∞–Ω–∏—Ö, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–æ–≤—É\n          setStatusRequestedPhotos(prev => {\n            const newSet = new Set(prev);\n            batch.forEach(photo => newSet.delete(photo.idPhoto));\n            return newSet;\n          });\n        }\n      } catch (error) {\n        console.error(`‚ùå Batch ${batchIndex + 1}: Error loading photo statuses:`, error);\n        \n        // –£ –≤–∏–ø–∞–¥–∫—É –ø–æ–º–∏–ª–∫–∏ - –≤–∏–¥–∞–ª—è—î–º–æ –∑ —Å–ø–∏—Å–∫—É –∑–∞–ø–∏—Ç–∞–Ω–∏—Ö, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–æ–≤—É\n        setStatusRequestedPhotos(prev => {\n          const newSet = new Set(prev);\n          batch.forEach(photo => newSet.delete(photo.idPhoto));\n          return newSet;\n        });\n      }\n\n      // –ù–µ–≤–µ–ª–∏–∫–∞ –∑–∞—Ç—Ä–∏–º–∫–∞ –º—ñ–∂ –±–∞—Ç—á–∞–º–∏ —â–æ–± –Ω–µ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ API\n      if (batchIndex < batches.length - 1) {\n        await new Promise(resolve => setTimeout(resolve, 100));\n      }\n    }\n  }, [profileId, statusRequestedPhotos]);\n\n  // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö —Å—Ç–∞—Ç—É—Å—ñ–≤\n  const ensureAllStatusesLoaded = useCallback(async () => {\n    if (!idRegularUser || context !== 'chat' || photos.length === 0) return;\n\n    // –ó–Ω–∞—Ö–æ–¥–∏–º–æ —Ñ–æ—Ç–æ –±–µ–∑ —Å—Ç–∞—Ç—É—Å—ñ–≤\n    const photosWithoutStatuses = photos.filter(photo => \n      !photoStatuses.has(photo.idPhoto) && !statusRequestedPhotos.has(photo.idPhoto)\n    );\n\n    if (photosWithoutStatuses.length > 0) {\n      console.log(`üîç Found ${photosWithoutStatuses.length} photos without statuses, requesting...`);\n      await loadPhotoStatuses(photosWithoutStatuses, idRegularUser);\n    }\n  }, [photos, photoStatuses, statusRequestedPhotos, idRegularUser, context, loadPhotoStatuses]);\n\n  // –ü–µ—Ä—ñ–æ–¥–∏—á–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–∏—Ö —Å—Ç–∞—Ç—É—Å—ñ–≤\n  useEffect(() => {\n    if (isOpen && photos.length > 0 && context === 'chat') {\n      const timeoutId = setTimeout(() => {\n        ensureAllStatusesLoaded();\n      }, 2000); // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥–∏ –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–æ—Ç–æ\n\n      return () => clearTimeout(timeoutId);\n    }\n  }, [isOpen, photos.length, context, ensureAllStatusesLoaded]);\n\n  // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—ñ–¥–µ–æ\n  const loadVideos = useCallback(async (reset: boolean = false) => {\n    if (loading) return;\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const cursor = reset ? '' : videoCursor;\n      const response = await apiGet(`/api/gallery/${profileId}/videos`, {\n        cursor,\n        limit: '100',\n        statuses: 'approved'\n      });\n\n      const typedResponse = response as { success: boolean; data?: VideoGalleryResponse; error?: string };\n      if (typedResponse.success && typedResponse.data) {\n        const videoData = typedResponse.data;\n        \n        if (reset) {\n          setVideos(videoData.videos);\n        } else {\n          setVideos(prev => {\n            const existingIds = new Set(prev.map(v => v.idVideo));\n            const newVideos = videoData.videos.filter(video => !existingIds.has(video.idVideo));\n            return [...prev, ...newVideos].sort((a, b) => b.idVideo - a.idVideo);\n          });\n        }\n        \n        setVideoCursor(videoData.cursor);\n        setHasMoreVideos(videoData.videos.length >= 100);\n        \n        // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Å—Ç–∞—Ç—É—Å–∏ –¥–ª—è –≤—ñ–¥–µ–æ —è–∫—â–æ —î idRegularUser\n        if (idRegularUser && context === 'chat') {\n          const videosToLoad = reset ? videoData.videos : videoData.videos.filter(video => {\n            const existingIds = new Set(videos.map(v => v.idVideo));\n            return !existingIds.has(video.idVideo);\n          });\n          if (videosToLoad.length > 0) {\n            loadVideoStatuses(videosToLoad, idRegularUser);\n          }\n        }\n      } else {\n        setError('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—ñ–¥–µ–æ');\n      }\n    } catch (err) {\n      setError('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—ñ–¥–µ–æ');\n    } finally {\n      setLoading(false);\n    }\n  }, [profileId, loading, videoCursor, videos, idRegularUser, context, loadVideoStatuses]);\n\n  // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞—É–¥—ñ–æ –∑ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—î—é\n  const loadAudios = useCallback(async (reset: boolean = false) => {\n    if (loading) return;\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const response = await apiGet(`/api/gallery/${profileId}/audios`, {\n        cursor: reset ? '' : audioCursor,\n        limit: '50'\n      });\n\n      const typedResponse = response as { success: boolean; data?: AudioGalleryResponse; error?: string };\n      if (typedResponse.success && typedResponse.data) {\n        const audioData = typedResponse.data;\n        \n        if (reset) {\n          setAudios(audioData.items);\n        } else {\n          setAudios(prev => {\n            const existingIds = new Set(prev.map(a => a.id));\n            const newAudios = audioData.items.filter(audio => !existingIds.has(audio.id));\n            return [...prev, ...newAudios].sort((a, b) => b.id - a.id);\n          });\n        }\n        \n        setAudioCursor(audioData.cursor);\n        setHasMoreAudios(audioData.items.length >= 50);\n        \n        // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Å—Ç–∞—Ç—É—Å–∏ –¥–ª—è –∞—É–¥—ñ–æ —è–∫—â–æ —î idRegularUser\n        if (idRegularUser && context === 'chat') {\n          const audiosToLoad = reset ? audioData.items : audioData.items.filter(audio => {\n            const existingIds = new Set(audios.map(a => a.id));\n            return !existingIds.has(audio.id);\n          });\n          if (audiosToLoad.length > 0) {\n            loadAudioStatuses(audiosToLoad, idRegularUser);\n          }\n        }\n      } else {\n        setError('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞—É–¥—ñ–æ');\n      }\n    } catch (err) {\n      setError('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞—É–¥—ñ–æ');\n    } finally {\n      setLoading(false);\n    }\n  }, [profileId, loading, audioCursor, audios, idRegularUser, context]);\n\n  // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—ñ–≤ –∞—É–¥—ñ–æ –∑ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è–º (–±–∞—Ç—á–∞–º–∏ –ø–æ 100)\n  const loadAudioStatuses = useCallback(async (audios: Audio[], idUser: number) => {\n    if (audios.length === 0) return;\n\n    // –§—ñ–ª—å—Ç—Ä—É—î–º–æ —Ç—ñ–ª—å–∫–∏ —Ç—ñ –∞—É–¥—ñ–æ, –¥–ª—è —è–∫–∏—Ö —â–µ –Ω–µ –∑–∞–ø–∏—Ç—É–≤–∞–ª–∏ —Å—Ç–∞—Ç—É—Å–∏\n    const audiosToRequest = audios.filter(audio => !statusRequestedAudios.has(audio.id));\n    \n    if (audiosToRequest.length === 0) {\n      return;\n    }\n\n    // –†–æ–∑–±–∏–≤–∞—î–º–æ –Ω–∞ –±–∞—Ç—á—ñ –ø–æ 100 –∞—É–¥—ñ–æ\n    const batchSize = 100;\n    const batches = [];\n    for (let i = 0; i < audiosToRequest.length; i += batchSize) {\n      batches.push(audiosToRequest.slice(i, i + batchSize));\n    }\n\n    // –û–±—Ä–æ–±–ª—è—î–º–æ –∫–æ–∂–µ–Ω –±–∞—Ç—á\n    for (let batchIndex = 0; batchIndex < batches.length; batchIndex++) {\n      const batch = batches[batchIndex];\n\n      try {\n        const idsAudios = batch.map(a => a.id);\n        \n        // –í—ñ–¥–º—ñ—á–∞—î–º–æ —â–æ –¥–ª—è —Ü–∏—Ö –∞—É–¥—ñ–æ –∑–∞–ø–∏—Ç –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ\n        setStatusRequestedAudios(prev => {\n          const newSet = new Set(prev);\n          idsAudios.forEach(id => newSet.add(id));\n          return newSet;\n        });\n\n        const response = await apiPost('/api/gallery/audio-statuses', {\n          idUser,\n          idsAudios,\n          profileId: parseInt(profileId)\n        });\n\n        const typedResponse = response as { success: boolean; data?: { audios?: AudioConnectionStatus[]; data?: { audios?: AudioConnectionStatus[] } }; error?: string };\n        const audiosList = typedResponse.success && typedResponse.data \n          ? (typedResponse.data.audios ?? typedResponse.data.data?.audios)\n          : undefined;\n        if (audiosList && Array.isArray(audiosList)) {\n          // –û–Ω–æ–≤–ª—é—î–º–æ –º–∞–ø—É —Å—Ç–∞—Ç—É—Å—ñ–≤\n          const newStatusMap = new Map(audioStatuses);\n          audiosList.forEach((audioStatus: AudioConnectionStatus | any) => {\n            const candidates = [\n              Number(audioStatus?.idAudio),\n              Number(audioStatus?.id),\n              Number(audioStatus?.idGalleryAudio)\n            ].filter((k) => Number.isFinite(k));\n            candidates.forEach((k) => newStatusMap.set(k, audioStatus.status as ('accessed' | 'sent' | null)));\n          });\n          setAudioStatuses(newStatusMap);\n\n          // –û–¥–Ω–æ—á–∞—Å–Ω–æ –ø—Ä–æ–∫–∏–¥—É—î–º–æ –æ–±—á–∏—Å–ª–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å —É —Å–∞–º—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ audios –¥–ª—è –ø—Ä–æ—Å—Ç—ñ—à–æ—ó —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó\n          setAudios(prev => prev.map(a => {\n            const keyCandidates = [Number(a.id), Number((a as any).idAudio), Number((a as any).idGalleryAudio)];\n            const matched = keyCandidates.find(k => Number.isFinite(k) && newStatusMap.has(Number(k)));\n            const computed = typeof matched !== 'undefined' ? newStatusMap.get(Number(matched)) ?? null : a.statusComputed ?? null;\n            return { ...a, statusComputed: computed };\n          }));\n        } else {\n          // –£ –≤–∏–ø–∞–¥–∫—É –ø–æ–º–∏–ª–∫–∏ - –≤–∏–¥–∞–ª—è—î–º–æ –∑ —Å–ø–∏—Å–∫—É –∑–∞–ø–∏—Ç–∞–Ω–∏—Ö, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–æ–≤—É\n          setStatusRequestedAudios(prev => {\n            const newSet = new Set(prev);\n            batch.forEach(audio => newSet.delete(audio.id));\n            return newSet;\n          });\n        }\n      } catch (error) {\n        // –£ –≤–∏–ø–∞–¥–∫—É –ø–æ–º–∏–ª–∫–∏ - –≤–∏–¥–∞–ª—è—î–º–æ –∑ —Å–ø–∏—Å–∫—É –∑–∞–ø–∏—Ç–∞–Ω–∏—Ö, —â–æ–± —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ –∑–Ω–æ–≤—É\n        setStatusRequestedAudios(prev => {\n          const newSet = new Set(prev);\n          batch.forEach(audio => newSet.delete(audio.id));\n          return newSet;\n        });\n      }\n\n      // –ù–µ–≤–µ–ª–∏–∫–∞ –∑–∞—Ç—Ä–∏–º–∫–∞ –º—ñ–∂ –±–∞—Ç—á–∞–º–∏ —â–æ–± –Ω–µ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ API\n      if (batchIndex < batches.length - 1) {\n        await new Promise(resolve => setTimeout(resolve, 100));\n      }\n    }\n  }, [profileId, statusRequestedAudios]);\n\n  // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–µ—Ä—à–∏—Ö 500 —Ñ–æ—Ç–æ –∑ –ø–æ–∫–∞–∑–æ–º –æ–¥—Ä–∞–∑—É\n  const loadInitialPhotos = useCallback(async () => {\n    if (loading) return;\n\n    // –°–ø—Ä–æ–±—É—î–º–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑ —î–¥–∏–Ω–æ–≥–æ –∫–µ—à—É –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –ø–æ–∫–∞–∑—É\n    const cacheMap = loadUnifiedPhotoCache();\n    if (cacheMap.size > 0) {\n      const cachedPhotos = convertCacheToPhotos(cacheMap);\n      console.log('üì¶ Showing cached photos first:', cachedPhotos.length);\n      setPhotos(cachedPhotos);\n      \n      // –í–∏–∑–Ω–∞—á–∞—î–º–æ temporary —Ñ–æ—Ç–æ –∑ –∫–µ—à—É\n      const tempIds = new Set<number>();\n      const statusMap = new Map<number, 'accessed' | 'sent' | null>();\n      \n      cacheMap.forEach((cached, idPhoto) => {\n        if (cached.category === 'temporary') {\n          tempIds.add(idPhoto);\n        }\n        if (cached.status) {\n          statusMap.set(idPhoto, cached.status);\n        }\n      });\n      \n      setTemporaryPhotoIds(tempIds);\n      setPhotoStatuses(statusMap);\n      \n      // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Å–≤—ñ–∂—ñ —Å—Ç–∞—Ç—É—Å–∏ –¥–ª—è –≤–∏–¥–∏–º–∏—Ö —Ñ–æ—Ç–æ (–∑–∞–≤–∂–¥–∏ –¥–ª—è –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—ñ)\n      if (idRegularUser && context === 'chat') {\n        await loadPhotoStatuses(cachedPhotos, idRegularUser);\n      }\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const allPhotos: Photo[] = [];\n      let regularCursor = '';\n      let temporaryCursor = '';\n      let hasMoreRegular = true;\n      let hasMoreTemporary = true;\n      let isFirstBatch = true;\n      const maxInitialPhotos = 500; // –û–±–º–µ–∂–µ–Ω–Ω—è –Ω–∞ –ø–æ—á–∞—Ç–∫–æ–≤–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è\n\n      // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ñ–æ—Ç–æ –ø–æ–µ—Ç–∞–ø–Ω–æ –¥–æ 500 —à—Ç—É–∫\n      while ((hasMoreRegular || hasMoreTemporary) && allPhotos.length < maxInitialPhotos) {\n        const requests = [];\n        \n        // –î–æ–¥–∞—î–º–æ –∑–∞–ø–∏—Ç –¥–ª—è –∑–≤–∏—á–∞–π–Ω–∏—Ö —Ñ–æ—Ç–æ —è–∫—â–æ —î —â–µ –¥–∞–Ω—ñ\n        if (hasMoreRegular) {\n          requests.push(\n            apiGet(`/api/gallery/${profileId}/photos`, {\n              cursor: regularCursor,\n              limit: '100',\n              statuses: 'approved,approved_by_ai'\n            })\n          );\n        }\n        \n        // –î–æ–¥–∞—î–º–æ –∑–∞–ø–∏—Ç –¥–ª—è temporary —Ñ–æ—Ç–æ —è–∫—â–æ —î —â–µ –¥–∞–Ω—ñ\n        if (hasMoreTemporary) {\n          console.log('üì∏ Requesting temporary photos with cursor:', temporaryCursor);\n          requests.push(\n            apiGet(`/api/gallery/${profileId}/photos`, {\n              cursor: temporaryCursor,\n              limit: '100',\n              isTemporary: 'true'\n            })\n          );\n        }\n\n        const responses = await Promise.all(requests);\n        let regularResponse = null;\n        let temporaryResponse = null;\n\n        // –†–æ–∑–ø–æ–¥—ñ–ª—è—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ\n        if (hasMoreRegular && hasMoreTemporary) {\n          [regularResponse, temporaryResponse] = responses;\n        } else if (hasMoreRegular) {\n          [regularResponse] = responses;\n        } else if (hasMoreTemporary) {\n          [temporaryResponse] = responses;\n        }\n\n        const newPhotos: Photo[] = [];\n\n        // –û–±—Ä–æ–±–ª—è—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ\n        const typedRegularResponse = regularResponse as { success: boolean; data?: GalleryResponse; error?: string };\n        if (regularResponse && typedRegularResponse.success) {\n          const regularData = typedRegularResponse.data as GalleryResponse;\n          console.log('üì∏ Regular photos batch:', regularData.photos.length);\n          newPhotos.push(...regularData.photos);\n          regularCursor = regularData.cursor;\n          hasMoreRegular = regularData.photos.length >= 100;\n        } else if (regularResponse) {\n          hasMoreRegular = false;\n        }\n\n        const typedTemporaryResponse = temporaryResponse as { success: boolean; data?: GalleryResponse; error?: string };\n        if (temporaryResponse && typedTemporaryResponse.success) {\n          const temporaryData = typedTemporaryResponse.data as GalleryResponse;\n          console.log('üì∏ Temporary photos batch:', temporaryData.photos.length, temporaryData.photos.map(p => p.idPhoto));\n          newPhotos.push(...temporaryData.photos);\n          \n          // –í—ñ–¥–º—ñ—á–∞—î–º–æ —Ü—ñ —Ñ–æ—Ç–æ —è–∫ temporary\n          setTemporaryPhotoIds(prev => {\n            const newSet = new Set(prev);\n            temporaryData.photos.forEach(photo => newSet.add(photo.idPhoto));\n            return newSet;\n          });\n          \n          temporaryCursor = temporaryData.cursor;\n          hasMoreTemporary = temporaryData.photos.length >= 100;\n        } else if (temporaryResponse) {\n          hasMoreTemporary = false;\n        }\n\n        // –î–æ–¥–∞—î–º–æ –Ω–æ–≤—ñ —Ñ–æ—Ç–æ –¥–æ –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É –∑ –¥–µ–¥—É–ø–ª—ñ–∫–∞—Ü—ñ—î—é\n        const existingIds = new Set(allPhotos.map(p => p.idPhoto));\n        const trulyNewPhotos = newPhotos.filter(photo => !existingIds.has(photo.idPhoto));\n        allPhotos.push(...trulyNewPhotos);\n        \n        // –°–æ—Ä—Ç—É—î–º–æ —ñ –ø–æ–∫–∞–∑—É—î–º–æ —Ñ–æ—Ç–æ –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ–≥–æ –±–∞—Ç—á—É\n        const sortedPhotos = allPhotos.sort((a, b) => b.idPhoto - a.idPhoto);\n        setPhotos(sortedPhotos);\n        \n        // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Ñ–æ—Ç–æ –≤ —î–¥–∏–Ω–∏–π –∫–µ—à\n        if (trulyNewPhotos.length > 0) {\n          // –†–æ–∑–¥—ñ–ª—è—î–º–æ –Ω–∞ regular —Ç–∞ temporary —Ñ–æ—Ç–æ\n          const regularPhotos = trulyNewPhotos.filter(photo => !temporaryPhotoIds.has(photo.idPhoto));\n          const tempPhotos = trulyNewPhotos.filter(photo => temporaryPhotoIds.has(photo.idPhoto));\n          \n          if (regularPhotos.length > 0) {\n            addPhotosToUnifiedCache(regularPhotos, false);\n          }\n          if (tempPhotos.length > 0) {\n            addPhotosToUnifiedCache(tempPhotos, true);\n          }\n        }\n\n        console.log('üì∏ Current total photos:', sortedPhotos.length);\n\n        // –ü—ñ—Å–ª—è –ø–µ—Ä—à–æ–≥–æ –±–∞—Ç—á—É - –ø—Ä–∏–±–∏—Ä–∞—î–º–æ loading —ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Å—Ç–∞—Ç—É—Å–∏\n        if (isFirstBatch) {\n          setLoading(false); // –ü–æ–∫–∞–∑—É—î–º–æ —Ñ–æ—Ç–æ –æ–¥—Ä–∞–∑—É\n          isFirstBatch = false;\n\n          // –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Å—Ç–∞—Ç—É—Å–∏ –¥–ª—è –ø–æ—Ç–æ—á–Ω–∏—Ö —Ñ–æ—Ç–æ\n          if (idRegularUser && context === 'chat' && sortedPhotos.length > 0) {\n            loadPhotoStatuses(sortedPhotos, idRegularUser);\n          }\n        } else {\n          // –î–ª—è –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –±–∞—Ç—á—ñ–≤ - –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Å—Ç–∞—Ç—É—Å–∏ —Ç—ñ–ª—å–∫–∏ –¥–ª—è –¥—ñ–π—Å–Ω–æ –Ω–æ–≤–∏—Ö —Ñ–æ—Ç–æ\n          if (idRegularUser && context === 'chat' && trulyNewPhotos.length > 0) {\n            loadPhotoStatuses(trulyNewPhotos, idRegularUser);\n          }\n        }\n      }\n\n      // –§—ñ–Ω–∞–ª—å–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—ñ—Å–ª—è –ø–æ—á–∞—Ç–∫–æ–≤–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è\n      const stillHasMore = (hasMoreRegular || hasMoreTemporary) && allPhotos.length >= maxInitialPhotos;\n      setHasMore(stillHasMore);\n      \n      // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –∫—É—Ä—Å–æ—Ä–∏ –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è\n      setRegularCursor(regularCursor);\n      setTemporaryCursor(temporaryCursor);\n      \n      console.log('üì∏ Initial photos loaded:', allPhotos.length);\n      console.log('üì∏ Has more photos:', stillHasMore);\n      \n      // –õ–æ–≥—É–≤–∞–Ω–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É —Ñ–æ—Ç–æ –ø–æ —Ç–∏–ø–∞—Ö\n      const specialCount = allPhotos.filter(photo => isSpecialPhoto(photo)).length;\n      const temporaryCount = allPhotos.filter(photo => isTemporaryPhoto(photo)).length;\n      const regularCount = allPhotos.filter(photo => !isSpecialPhoto(photo) && !isTemporaryPhoto(photo)).length;\n      \n      console.log('üì∏ Temporary photo IDs:', Array.from(temporaryPhotoIds));\n      \n      console.log('üìä Initial photo distribution:', {\n        total: allPhotos.length,\n        regular: regularCount,\n        special: specialCount,\n        temporary: temporaryCount,\n        hasMore: stillHasMore\n      });\n\n    } catch (err) {\n      console.error('‚ùå Error loading initial photos:', err);\n      setError('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–æ—Ç–æ');\n      setLoading(false);\n    }\n  }, [profileId, loading, context, idRegularUser, isSpecialPhoto, isTemporaryPhoto, loadPhotoStatuses]);\n\n  // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö —Ñ–æ—Ç–æ –ø—Ä–∏ —Å–∫—Ä–æ–ª—ñ\n  const loadMorePhotos = useCallback(async () => {\n    if (loading || !hasMore) return;\n\n    setLoading(true);\n    console.log('üì∏ Loading more photos via scroll...');\n\n    try {\n      const requests = [];\n      let hasMoreRegular = !!regularCursor;\n      let hasMoreTemporary = !!temporaryCursor;\n      \n      // –î–æ–¥–∞—î–º–æ –∑–∞–ø–∏—Ç–∏ —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ —î –∫—É—Ä—Å–æ—Ä–∏\n      if (hasMoreRegular) {\n        requests.push(\n          apiGet(`/api/gallery/${profileId}/photos`, {\n            cursor: regularCursor,\n            limit: '100',\n            statuses: 'approved,approved_by_ai'\n          })\n        );\n      }\n      \n      if (hasMoreTemporary) {\n        requests.push(\n          apiGet(`/api/gallery/${profileId}/photos`, {\n            cursor: temporaryCursor,\n            limit: '100',\n            isTemporary: 'true'\n          })\n        );\n      }\n\n      if (requests.length === 0) {\n        setHasMore(false);\n        setLoading(false);\n        return;\n      }\n\n      const responses = await Promise.all(requests);\n      let regularResponse = null;\n      let temporaryResponse = null;\n\n      // –†–æ–∑–ø–æ–¥—ñ–ª—è—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ\n      if (hasMoreRegular && hasMoreTemporary) {\n        [regularResponse, temporaryResponse] = responses;\n      } else if (hasMoreRegular) {\n        [regularResponse] = responses;\n      } else if (hasMoreTemporary) {\n        [temporaryResponse] = responses;\n      }\n\n      const newPhotos: Photo[] = [];\n      let newRegularCursor = regularCursor;\n      let newTemporaryCursor = temporaryCursor;\n\n      // –û–±—Ä–æ–±–ª—è—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ\n      const typedRegularResponse = regularResponse as { success: boolean; data?: GalleryResponse; error?: string };\n      if (regularResponse && typedRegularResponse.success) {\n        const regularData = typedRegularResponse.data as GalleryResponse;\n        console.log('üì∏ More regular photos:', regularData.photos.length);\n        newPhotos.push(...regularData.photos);\n        newRegularCursor = regularData.cursor;\n        hasMoreRegular = regularData.photos.length >= 100;\n      } else if (regularResponse) {\n        hasMoreRegular = false;\n        newRegularCursor = '';\n      }\n\n      const typedTemporaryResponse = temporaryResponse as { success: boolean; data?: GalleryResponse; error?: string };\n      if (temporaryResponse && typedTemporaryResponse.success) {\n        const temporaryData = typedTemporaryResponse.data as GalleryResponse;\n        console.log('üì∏ More temporary photos:', temporaryData.photos.length);\n        newPhotos.push(...temporaryData.photos);\n        \n        // –í—ñ–¥–º—ñ—á–∞—î–º–æ —Ü—ñ —Ñ–æ—Ç–æ —è–∫ temporary\n        setTemporaryPhotoIds(prev => {\n          const newSet = new Set(prev);\n          temporaryData.photos.forEach(photo => newSet.add(photo.idPhoto));\n          return newSet;\n        });\n        \n        newTemporaryCursor = temporaryData.cursor;\n        hasMoreTemporary = temporaryData.photos.length >= 100;\n      } else if (temporaryResponse) {\n        hasMoreTemporary = false;\n        newTemporaryCursor = '';\n      }\n\n      // –î–æ–¥–∞—î–º–æ –Ω–æ–≤—ñ —Ñ–æ—Ç–æ –∑ –¥–µ–¥—É–ø–ª—ñ–∫–∞—Ü—ñ—î—é\n      setPhotos(prev => {\n        const existingIds = new Set(prev.map(p => p.idPhoto));\n        const trulyNewPhotos = newPhotos.filter(photo => !existingIds.has(photo.idPhoto));\n        const updatedPhotos = [...prev, ...trulyNewPhotos].sort((a, b) => b.idPhoto - a.idPhoto);\n        \n        // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –Ω–æ–≤—ñ —Ñ–æ—Ç–æ –≤ —î–¥–∏–Ω–∏–π –∫–µ—à\n        if (trulyNewPhotos.length > 0) {\n          // –†–æ–∑–¥—ñ–ª—è—î–º–æ –Ω–∞ regular —Ç–∞ temporary —Ñ–æ—Ç–æ\n          const regularPhotos = trulyNewPhotos.filter(photo => !temporaryPhotoIds.has(photo.idPhoto));\n          const tempPhotos = trulyNewPhotos.filter(photo => temporaryPhotoIds.has(photo.idPhoto));\n          \n          if (regularPhotos.length > 0) {\n            addPhotosToUnifiedCache(regularPhotos, false);\n          }\n          if (tempPhotos.length > 0) {\n            addPhotosToUnifiedCache(tempPhotos, true);\n          }\n        }\n        \n        // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Å—Ç–∞—Ç—É—Å–∏ –¥–ª—è –Ω–æ–≤–∏—Ö —Ñ–æ—Ç–æ\n        if (idRegularUser && context === 'chat' && trulyNewPhotos.length > 0) {\n          loadPhotoStatuses(trulyNewPhotos, idRegularUser);\n        }\n        \n        return updatedPhotos;\n      });\n\n      // –û–Ω–æ–≤–ª—é—î–º–æ –∫—É—Ä—Å–æ—Ä–∏ —Ç–∞ hasMore\n      setRegularCursor(newRegularCursor);\n      setTemporaryCursor(newTemporaryCursor);\n      setHasMore(hasMoreRegular || hasMoreTemporary);\n\n      console.log('üì∏ More photos loaded. HasMore:', hasMoreRegular || hasMoreTemporary);\n\n    } catch (err) {\n      console.error('‚ùå Error loading more photos:', err);\n      setError('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö —Ñ–æ—Ç–æ');\n    } finally {\n      setLoading(false);\n    }\n  }, [profileId, loading, hasMore, regularCursor, temporaryCursor, context, idRegularUser, loadPhotoStatuses]);\n\n  // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—ó –≤ ref\n  useEffect(() => {\n    loadPhotosRef.current = loadMorePhotos;\n  }, [loadMorePhotos]);\n\n  // –û–±—Ä–æ–±–Ω–∏–∫ —Å–∫—Ä–æ–ª—É –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –±—ñ–ª—å—à–µ –º–µ–¥—ñ–∞\n  const handleScroll = useCallback(() => {\n    const container = scrollContainerRef.current;\n    if (!container || loading) return;\n\n    const { scrollTop, scrollHeight, clientHeight } = container;\n    const scrollPercentage = (scrollTop + clientHeight) / scrollHeight;\n\n    // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –±—ñ–ª—å—à–µ –º–µ–¥—ñ–∞ –∫–æ–ª–∏ –¥–æ—Å–∫—Ä–æ–ª–∏–ª–∏ –¥–æ 80%\n    if (scrollPercentage > 0.8) {\n      if (mediaType === 'photo' && hasMore) {\n        console.log('üîÑ Scroll threshold reached! Loading more photos...');\n        loadMorePhotos();\n      } else if (mediaType === 'video' && hasMoreVideos) {\n        console.log('üîÑ Scroll threshold reached! Loading more videos...');\n        loadVideos(false);\n      } else if (mediaType === 'audio' && hasMoreAudios) {\n        console.log('üîÑ Scroll threshold reached! Loading more audios...');\n        loadAudios(false);\n      }\n    }\n  }, [loading, hasMore, hasMoreVideos, hasMoreAudios, mediaType, loadMorePhotos, loadVideos, loadAudios]);\n\n  // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫ —Å–∫—Ä–æ–ª—É\n  useEffect(() => {\n    const container = scrollContainerRef.current;\n    if (!container) return;\n\n    container.addEventListener('scroll', handleScroll);\n    return () => {\n      container.removeEventListener('scroll', handleScroll);\n    };\n  }, [handleScroll]);\n\n  // –ê–≤—Ç–æ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —è–∫—â–æ –≤ –ø–æ—Ç–æ—á–Ω–æ–º—É —Ñ—ñ–ª—å—Ç—Ä—ñ –º–µ–Ω—à–µ 15 —Ñ–æ—Ç–æ\n  useEffect(() => {\n    if (!isOpen || loading || !hasMore) return;\n\n    const timeoutId = setTimeout(() => {\n      // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω—É –ª–æ–≥—ñ–∫—É —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó\n      const currentFilteredPhotos = filterPhotosByTypeAndStatus(photos, photoType, statusFilter, context);\n\n      const minPhotosThreshold = 15;\n      console.log('üîç Auto-load check:', {\n        photoType,\n        statusFilter,\n        currentFilteredCount: currentFilteredPhotos.length,\n        minThreshold: minPhotosThreshold,\n        hasMore,\n        loading\n      });\n\n      if (currentFilteredPhotos.length < minPhotosThreshold && hasMore && !loading) {\n        console.log('üöÄ Auto-loading more photos - current filter has only', currentFilteredPhotos.length, 'photos');\n        loadMorePhotos();\n      }\n    }, 1000); // –ó–∞—Ç—Ä–∏–º–∫–∞ —â–æ–± –¥–∞—Ç–∏ —á–∞—Å —Å—Ç–∞—Ç—É—Å–∞–º –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏—Å—è\n\n    return () => clearTimeout(timeoutId);\n  }, [isOpen, photos.length, photoType, statusFilter, context, hasMore, loading, filterPhotosByTypeAndStatus, loadMorePhotos]);\n\n  // –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è —Ñ–æ—Ç–æ –∑–∞ —Ç–∏–ø–æ–º —Ç–∞ —Å—Ç–∞—Ç—É—Å–æ–º\n  const filteredPhotos = useMemo(() => {\n    return filterPhotosByTypeAndStatus(photos, photoType, statusFilter, context);\n  }, [photos, photoType, statusFilter, context, filterPhotosByTypeAndStatus]);\n\n  // –ú–µ–º–æ—ñ–∑–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫ –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–∏—Ö –≤—ñ–¥–µ–æ\n  const filteredVideos = useMemo(() => {\n    return filterVideosByStatus(videos, statusFilter);\n  }, [videos, statusFilter, filterVideosByStatus]);\n\n  // –§—É–Ω–∫—Ü—ñ—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –∞—É–¥—ñ–æ –∑–∞ —Å—Ç–∞—Ç—É—Å–æ–º\n  const filterAudiosByStatus = useCallback((\n    audios: Audio[], \n    statusFilter: 'all' | 'available' | 'accessed' | 'sent'\n  ): Audio[] => {\n    // –®–≤–∏–¥–∫–∏–π —Ñ–æ–ª–±–µ–∫: —è–∫—â–æ —Å—Ç–∞—Ç—É—Å–∏ —â–µ –Ω–µ –ø—ñ–¥–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ ‚Äî –ø–æ–∫–∞–∑—É—î–º–æ –≤—Å—ñ —è–∫ –¥–æ—Å—Ç—É–ø–Ω—ñ\n    if (statusFilter === 'available' && audioStatuses.size === 0) {\n      return audios;\n    }\n    // –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∑–∞ —Å—Ç–∞—Ç—É—Å–æ–º\n    if (statusFilter !== 'all') {\n      return audios.filter(audio => {\n        // –ë–µ—Ä–µ–º–æ –æ–±—á–∏—Å–ª–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å –∑ –µ–ª–µ–º–µ–Ω—Ç–∞ —è–∫—â–æ —î,\n        // –∞–±–æ –∑ –º–∞–ø–∏ –∑–∞ –∫—ñ–ª—å–∫–æ–º–∞ –º–æ–∂–ª–∏–≤–∏–º–∏ –∫–ª—é—á–∞–º–∏ (id, idAudio, idGalleryAudio),\n        // –∞–±–æ fallback –∑ —Å–∏—Ä–æ–≥–æ –ø–æ–ª—è audio.status (TT –ø–æ–≤–µ—Ä—Ç–∞—î 'accessed')\n        if (typeof audio.statusComputed !== 'undefined') {\n          switch (statusFilter) {\n            case 'available':\n              return audio.statusComputed === null || typeof audio.statusComputed === 'undefined';\n            case 'accessed':\n              return audio.statusComputed === 'accessed';\n            case 'sent':\n              return audio.statusComputed === 'sent' || audio.statusComputed === 'accessed';\n          }\n        }\n        const key1 = audio.id as unknown as number;\n        const key2 = (audio as any).idAudio as number | undefined;\n        const key3 = (audio as any).idGalleryAudio as number | undefined;\n        const mapped =\n          (typeof key1 !== 'undefined' ? audioStatuses.get(Number(key1)) : undefined) ??\n          (typeof key2 !== 'undefined' ? audioStatuses.get(Number(key2)) : undefined) ??\n          (typeof key3 !== 'undefined' ? audioStatuses.get(Number(key3)) : undefined);\n        const fallback = (audio.status === 'accessed' || audio.status === 'sent') ? (audio.status as 'accessed' | 'sent') : null;\n        const status = (typeof mapped === 'undefined') ? fallback : mapped;\n        switch (statusFilter) {\n          case 'available':\n            // –î–æ—Å—Ç—É–ø–Ω—ñ: —Å—Ç–∞—Ç—É—Å –≤—ñ–¥—Å—É—Ç–Ω—ñ–π –∞–±–æ null\n            return status === null || typeof status === 'undefined';\n          case 'accessed':\n            return status === 'accessed'; // –¢—ñ–ª—å–∫–∏ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç—ñ\n          case 'sent':\n            // TT –¥–ª—è –∞—É–¥—ñ–æ –ø–æ–≤–µ—Ä—Ç–∞—î 'accessed' –∑–∞–º—ñ—Å—Ç—å 'sent' ‚Äî –≤—Ä–∞—Ö–æ–≤—É—î–º–æ –æ–±–∏–¥–≤–∞ —è–∫ ¬´–Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ¬ª\n            return status === 'sent' || status === 'accessed';\n          default:\n            return true;\n        }\n      });\n    }\n\n    return audios;\n  }, [audioStatuses]);\n\n  // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–∞ –¥–æ–≥—Ä—É–∑ —Å—Ç–∞—Ç—É—Å—ñ–≤ –∞—É–¥—ñ–æ (—è–∫—â–æ –ø—Ä–æ–ø—É—â–µ–Ω–æ –ø–µ—Ä–≤–∏–Ω–Ω–∏–π –∑–∞–ø–∏—Ç)\n  const ensureAllAudioStatusesLoaded = useCallback(async () => {\n    if (!idRegularUser || context !== 'chat' || audios.length === 0) return;\n\n    const audiosWithoutStatuses = audios.filter(audio => \n      !audioStatuses.has(audio.id) && !statusRequestedAudios.has(audio.id)\n    );\n\n    if (audiosWithoutStatuses.length > 0) {\n      await loadAudioStatuses(audiosWithoutStatuses, idRegularUser);\n    }\n  }, [audios, audioStatuses, statusRequestedAudios, idRegularUser, context, loadAudioStatuses]);\n\n  useEffect(() => {\n    if (isOpen && audios.length > 0 && context === 'chat') {\n      const timeoutId = setTimeout(() => {\n        ensureAllAudioStatusesLoaded();\n      }, 2000);\n      return () => clearTimeout(timeoutId);\n    }\n  }, [isOpen, audios.length, context, ensureAllAudioStatusesLoaded]);\n\n  // –ú–µ–º–æ—ñ–∑–æ–≤–∞–Ω–∏–π —Å–ø–∏—Å–æ–∫ –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–∏—Ö –∞—É–¥—ñ–æ\n  const filteredAudios = useMemo(() => {\n    return filterAudiosByStatus(audios, statusFilter);\n  }, [audios, statusFilter, filterAudiosByStatus]);\n\n\n  // –í–∏–¥–∞–ª—è—î–º–æ checkAndLoadMorePhotos —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ —Ü–∏–∫–ª—ñ—á–Ω–∏—Ö –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π\n\n  // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –º–µ–¥—ñ–∞ –ø—Ä–∏ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ –≥–∞–ª–µ—Ä–µ—ó –∞–±–æ –∑–º—ñ–Ω—ñ —Ç–∏–ø—É\n  useEffect(() => {\n    if (isOpen) {\n      if (mediaType === 'photo') {\n        setPhotos([]);\n        setRegularCursor('');\n        setTemporaryCursor('');\n        setHasMore(true);\n        setError(null);\n        setAutoLoadAttempts(0); // –°–∫–∏–¥–∞—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫ –ø—Ä–∏ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ\n        setPhotoStatuses(new Map()); // –û—á–∏—â—É—î–º–æ —Å—Ç–∞—Ç—É—Å–∏ —Ñ–æ—Ç–æ\n\n        setStatusRequestedPhotos(new Set()); // –û—á–∏—â—É—î–º–æ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ —Å—Ç–∞—Ç—É—Å—ñ–≤\n        setTemporaryPhotoIds(new Set()); // –û—á–∏—â—É—î–º–æ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è temporary —Ñ–æ—Ç–æ\n        // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –ø–µ—Ä—à—ñ 500 —Ñ–æ—Ç–æ\n        loadInitialPhotos();\n      } else if (mediaType === 'video') {\n        setVideos([]);\n        setVideoCursor('');\n        setHasMoreVideos(true);\n        setVideoStatuses(new Map()); // –û—á–∏—â—É—î–º–æ —Å—Ç–∞—Ç—É—Å–∏ –≤—ñ–¥–µ–æ\n        setStatusRequestedVideos(new Set()); // –û—á–∏—â—É—î–º–æ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ —Å—Ç–∞—Ç—É—Å—ñ–≤ –≤—ñ–¥–µ–æ\n        setError(null);\n        // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –≤—ñ–¥–µ–æ\n        loadVideos(true);\n      } else if (mediaType === 'audio') {\n        setAudios([]);\n        setAudioCursor('');\n        setHasMoreAudios(true);\n        setSelectedAudios([]);\n        setAudioStatuses(new Map()); // –û—á–∏—â—É—î–º–æ —Å—Ç–∞—Ç—É—Å–∏ –∞—É–¥—ñ–æ\n        setStatusRequestedAudios(new Set()); // –û—á–∏—â—É—î–º–æ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ —Å—Ç–∞—Ç—É—Å—ñ–≤ –∞—É–¥—ñ–æ\n        setError(null);\n        // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –∞—É–¥—ñ–æ\n        loadAudios(true);\n      }\n    } else {\n      // –û—á–∏—â—É—î–º–æ —Å—Ç–∞–Ω –ø—Ä–∏ –∑–∞–∫—Ä–∏—Ç—Ç—ñ\n      setError(null);\n      setLoading(false);\n    }\n  }, [isOpen, profileId, mediaType]);\n\n\n\n  // –¶–µ–π useEffect —Ç–µ–ø–µ—Ä –æ–±'—î–¥–Ω–∞–Ω–∏–π –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º, –≤–∏–¥–∞–ª—è—î–º–æ –¥—É–±–ª—ñ–∫–∞—Ç\n\n\n\n  // –û–±—Ä–æ–±–∫–∞ –≤–∏–±–æ—Ä—É —Ñ–æ—Ç–æ\n  const handlePhotoSelect = (photo: Photo) => {\n    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ –º–æ–∂–Ω–∞ –≤–∏–±—Ä–∞—Ç–∏ —Ü–µ —Ñ–æ—Ç–æ\n    if (!isPhotoSelectable(photo)) {\n      return; // –ù–µ –¥–æ–∑–≤–æ–ª—è—î–º–æ –≤–∏–±—ñ—Ä\n    }\n\n    setSelectedPhotos(prev => {\n      const isSelected = prev.some(p => p.idPhoto === photo.idPhoto);\n      \n      if (isSelected) {\n        // –í–∏–¥–∞–ª—è—î–º–æ —Ñ–æ—Ç–æ –∑ –≤–∏–±—Ä–∞–Ω–∏—Ö\n        return prev.filter(p => p.idPhoto !== photo.idPhoto);\n      } else {\n        // –î–æ–¥–∞—î–º–æ —Ñ–æ—Ç–æ –¥–æ –≤–∏–±—Ä–∞–Ω–∏—Ö (–∑ –æ–±–º–µ–∂–µ–Ω–Ω—è–º)\n        if (prev.length >= maxSelection) {\n          return prev;\n        }\n        return [...prev, photo];\n      }\n    });\n  };\n\n  // –û–±—Ä–æ–±–∫–∞ –≤–∏–±–æ—Ä—É –≤—ñ–¥–µ–æ\n  const handleVideoSelect = (video: Video) => {\n    setSelectedVideos(prev => {\n      const isSelected = prev.some(v => v.idVideo === video.idVideo);\n      \n      if (isSelected) {\n        // –í–∏–¥–∞–ª—è—î–º–æ –≤—ñ–¥–µ–æ –∑ –≤–∏–±—Ä–∞–Ω–∏—Ö\n        return prev.filter(v => v.idVideo !== video.idVideo);\n      } else {\n        // –î–æ–¥–∞—î–º–æ –≤—ñ–¥–µ–æ –¥–æ –≤–∏–±—Ä–∞–Ω–∏—Ö (–∑ –æ–±–º–µ–∂–µ–Ω–Ω—è–º)\n        if (prev.length >= maxSelection) {\n          return prev;\n        }\n        return [...prev, video];\n      }\n    });\n  };\n\n  // –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –≤–∏–±—Ä–∞–Ω–∏—Ö —Ñ–æ—Ç–æ\n  const handleSendPhotos = async () => {\n    if (selectedPhotos.length === 0) return;\n\n    // –Ø–∫—â–æ —î idRegularUser, –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ —á–µ—Ä–µ–∑ API\n    if (idRegularUser && context === 'chat') {\n      // –û–ø—Ç–∏–º—ñ—Å—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤ —á–∞—Ç—ñ: –ø–æ–≤—ñ–¥–æ–º–ª—è—î–º–æ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç\n      try {\n        onPhotoSelect(selectedPhotos);\n      } catch {}\n      // –ó–∞–∫—Ä–∏–≤–∞—î–º–æ –º–æ–¥–∞–ª–∫—É –æ–¥—Ä–∞–∑—É, —â–æ–± –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –±–∞—á–∏–≤ —á–∞—Ç\n      try {\n        onClose();\n      } catch {}\n\n      setLoading(true);\n      try {\n        const response = await apiPost('/api/gallery/send-photos', {\n          idsGalleryPhotos: selectedPhotos.map(p => p.idPhoto),\n          idRegularUser,\n          profileId: parseInt(profileId)\n        });\n\n        const typedResponse = response as { success: boolean; error?: string };\n        if (typedResponse.success) {\n          setSelectedPhotos([]);\n          try { window.dispatchEvent(new CustomEvent('dialog:sent', { detail: { profileId: parseInt(profileId), clientId: idRegularUser, kind: 'photos' } })); } catch {}\n        } else {\n          setError('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ç–æ');\n        }\n      } catch {\n        setError('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ç–æ');\n      } finally {\n        setLoading(false);\n      }\n    } else {\n      // –°—Ç–∞—Ä–∏–π —Å–ø–æ—Å—ñ–± - —á–µ—Ä–µ–∑ callback\n      onPhotoSelect(selectedPhotos);\n      onClose();\n    }\n  };\n\n  // –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –≤–∏–±—Ä–∞–Ω–∏—Ö –≤—ñ–¥–µ–æ\n  const handleSendVideos = async () => {\n    if (selectedVideos.length === 0) return;\n\n    // –Ø–∫—â–æ —î idRegularUser, –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ —á–µ—Ä–µ–∑ API\n    if (idRegularUser && context === 'chat') {\n      setLoading(true);\n      try {\n        const response = await apiPost('/api/gallery/send-videos', {\n          idsGalleryVideos: selectedVideos.map(v => v.idVideo),\n          idRegularUser,\n          profileId: parseInt(profileId)\n        });\n\n        const typedResponse = response as { success: boolean; data?: any; error?: string };\n        if (typedResponse.success) {\n          onClose();\n          setSelectedVideos([]);\n          try { window.dispatchEvent(new CustomEvent('dialog:sent', { detail: { profileId: parseInt(profileId), clientId: idRegularUser, kind: 'videos' } })); } catch {}\n        } else {\n          setError('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –≤—ñ–¥–µ–æ');\n        }\n      } catch {\n        setError('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –≤—ñ–¥–µ–æ');\n      } finally {\n        setLoading(false);\n      }\n    } else {\n      // –î–ª—è —ñ–Ω—à–∏—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ–≤ –ø–æ–∫–∏ —â–æ –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î–º–æ\n      setError('–í—ñ–¥–ø—Ä–∞–≤–∫–∞ –≤—ñ–¥–µ–æ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –≤ —á–∞—Ç—ñ');\n    }\n  };\n\n  // –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –≤–∏–±—Ä–∞–Ω–∏—Ö –∞—É–¥—ñ–æ\n  const handleSendAudios = async () => {\n    if (selectedAudios.length === 0) return;\n\n    // –Ø–∫—â–æ —î idRegularUser, –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ —á–µ—Ä–µ–∑ API\n    if (idRegularUser && context === 'chat') {\n      setLoading(true);\n      try {\n        const response = await apiPost('/api/gallery/send-audios', {\n          idsGalleryAudios: selectedAudios.map(a => a.id),\n          idRegularUser,\n          profileId: parseInt(profileId)\n        });\n\n        const typedResponse = response as { success: boolean; data?: any; error?: string };\n        if (typedResponse.success) {\n          onClose();\n          setSelectedAudios([]);\n          try { window.dispatchEvent(new CustomEvent('dialog:sent', { detail: { profileId: parseInt(profileId), clientId: idRegularUser, kind: 'audios' } })); } catch {}\n        } else {\n          setError('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –∞—É–¥—ñ–æ');\n        }\n      } catch {\n        setError('–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –∞—É–¥—ñ–æ');\n      } finally {\n        setLoading(false);\n      }\n    } else {\n      // –î–ª—è —ñ–Ω—à–∏—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ–≤ –ø–æ–∫–∏ —â–æ –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î–º–æ\n      setError('–í—ñ–¥–ø—Ä–∞–≤–∫–∞ –∞—É–¥—ñ–æ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –≤ —á–∞—Ç—ñ');\n    }\n  };\n\n  // –í–∏–±—ñ—Ä/—Å–∫–∞—Å—É–≤–∞–Ω–Ω—è –≤–∏–±–æ—Ä—É –∞—É–¥—ñ–æ\n  const handleAudioSelect = (audio: Audio) => {\n    setSelectedAudios(prev => {\n      const isSelected = prev.some(a => a.id === audio.id);\n      if (isSelected) {\n        return prev.filter(a => a.id !== audio.id);\n      } else if (prev.length < maxSelection) {\n        return [...prev, audio];\n      }\n      return prev;\n    });\n  };\n\n  // –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è –∞—É–¥—ñ–æ –ø–ª–µ—î—Ä–∞\n  const handleAudioPlay = (audio: Audio) => {\n    // –ó—É–ø–∏–Ω—è—î–º–æ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –∞—É–¥—ñ–æ, —è–∫—â–æ –≤—ñ–Ω –≤—ñ–¥—Ç–≤–æ—Ä—é—î—Ç—å—Å—è\n    if (currentPlayingAudio && currentPlayingAudio.id !== audio.id) {\n      const prevAudioElement = audioPlayersRef.current.get(currentPlayingAudio.id);\n      if (prevAudioElement && !prevAudioElement.paused) {\n        prevAudioElement.pause();\n      }\n    }\n    setCurrentPlayingAudio(audio);\n  };\n\n  const handleAudioPause = () => {\n    // –ü–ª–µ—î—Ä —Å–∞–º –∫–µ—Ä—É—î –ø–∞—É–∑–æ—é, –∞–ª–µ –º–æ–∂–µ–º–æ –¥–æ–¥–∞—Ç–∏ –ª–æ–≥—ñ–∫—É —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ\n  };\n\n  const handleAudioEnded = () => {\n    setCurrentPlayingAudio(null);\n  };\n\n  // –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∞—É–¥—ñ–æ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤\n  const registerAudioElement = (audioId: number, element: HTMLAudioElement) => {\n    audioPlayersRef.current.set(audioId, element);\n  };\n\n  const unregisterAudioElement = (audioId: number) => {\n    audioPlayersRef.current.delete(audioId);\n  };\n\n  // –ú–µ–º–æ—ñ–∑–æ–≤–∞–Ω–∏–π Set –¥–ª—è —à–≤–∏–¥–∫–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–∏–±—Ä–∞–Ω–∏—Ö —Ñ–æ—Ç–æ\n  const selectedPhotoIds = useMemo(() => {\n    return new Set(selectedPhotos.map(p => p.idPhoto));\n  }, [selectedPhotos]);\n\n  // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ —Ñ–æ—Ç–æ –≤–∏–±—Ä–∞–Ω–µ\n  const isPhotoSelected = useCallback((photo: Photo) => {\n    return selectedPhotoIds.has(photo.idPhoto);\n  }, [selectedPhotoIds]);\n\n  // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ —Ñ–æ—Ç–æ –º–æ–∂–Ω–∞ –≤–∏–±—Ä–∞—Ç–∏\n  const isPhotoSelectable = useCallback((photo: Photo) => {\n    // –†–µ–∂–∏–º –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è (–≤–∫–ª—é—á–Ω–æ –∑ –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏–º–∏ –ø–æ—Å—Ç–∞–º–∏ —Ç–∞ –ª–∏—Å—Ç–∞–º–∏): –∫–µ—Ä—É—î–º–æ—Å—è allowedPhotoTabs\n    if (mode === 'attach') {\n      if (allowedPhotoTabs && allowedPhotoTabs.length > 0) {\n        const allowRegular = allowedPhotoTabs.includes('regular') && !isSpecialPhoto(photo) && !isTemporaryPhoto(photo);\n        const allowTemporary = allowedPhotoTabs.includes('temporary') && isTemporaryPhoto(photo) && !isSpecialPhoto(photo);\n        const allowSpecial = allowedPhotoTabs.includes('special') && isSpecialExactPhoto(photo);\n        const allowSpecialPlus = allowedPhotoTabs.includes('special_plus') && isSpecialPlusPhoto(photo);\n        return allowRegular || allowTemporary || allowSpecial || allowSpecialPlus;\n      }\n      // –Ø–∫—â–æ –Ω–µ –∑–∞–¥–∞–Ω–æ, —É —Ä–µ–∂–∏–º—ñ attach –¥–æ–∑–≤–æ–ª—è—î–º–æ –≤—Å—ñ –Ω–µ—Å–µ–∫—Ä–µ—Ç–Ω—ñ —Ñ–æ—Ç–æ (–±–µ–∑ special)\n      return !isSpecialPhoto(photo);\n    }\n    // –£ –∑–≤–∏—á–∞–π–Ω–æ–º—É —á–∞—Ç—ñ –Ω–µ –¥–æ–∑–≤–æ–ª—è—î–º–æ special\n    if (context === 'chat') {\n      return !isSpecialPhoto(photo);\n    }\n    return true;\n  }, [mode, allowedPhotoTabs, context, isSpecialPhoto, isSpecialExactPhoto, isSpecialPlusPhoto, isTemporaryPhoto]);\n\n  // –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —Ç—Ä–∏–≤–∞–ª–æ—Å—Ç—ñ –≤—ñ–¥–µ–æ\n  const formatDuration = useCallback((seconds: number): string => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\n  }, []);\n\n  // –ú–µ–º–æ—ñ–∑–æ–≤–∞–Ω–∏–π Set –¥–ª—è —à–≤–∏–¥–∫–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤–∏–±—Ä–∞–Ω–∏—Ö –≤—ñ–¥–µ–æ\n  const selectedVideoIds = useMemo(() => {\n    return new Set(selectedVideos.map(v => v.idVideo));\n  }, [selectedVideos]);\n\n  // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –≤—ñ–¥–µ–æ –≤–∏–±—Ä–∞–Ω–µ\n  const isVideoSelected = useCallback((video: Video) => {\n    return selectedVideoIds.has(video.idVideo);\n  }, [selectedVideoIds]);\n\n  // –ú–µ–º–æ—ñ–∑–æ–≤–∞–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –∞—É–¥—ñ–æ –≤–∏–±—Ä–∞–Ω–µ\n  const isAudioSelected = useCallback((audio: Audio) => {\n    return selectedAudios.some(a => a.id === audio.id);\n  }, [selectedAudios]);\n\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]\">\n      <div className=\"bg-white rounded-lg w-full max-w-4xl h-[80vh] flex flex-col\">\n        {/* Header with media type tabs and close button */}\n        <div className=\"flex items-center justify-between p-3\">\n          <div className=\"flex space-x-1 bg-gray-100 rounded-lg p-1\">\n            <button\n              onClick={() => setMediaType('photo')}\n              className={`px-4 py-2 text-sm font-medium rounded-md transition-colors ${\n                mediaType === 'photo'\n                  ? 'bg-white text-gray-900 shadow-sm'\n                  : 'text-gray-600 hover:text-gray-900'\n              }`}\n            >\n              –§–æ—Ç–æ\n            </button>\n            <button\n              onClick={() => setMediaType('video')}\n              className={`px-4 py-2 text-sm font-medium rounded-md transition-colors ${\n                mediaType === 'video'\n                  ? 'bg-white text-gray-900 shadow-sm'\n                  : 'text-gray-600 hover:text-gray-900'\n              }`}\n            >\n              –í—ñ–¥–µ–æ\n            </button>\n            {(mode !== 'attach' || allowAudio) && (\n              <button\n                onClick={() => setMediaType('audio')}\n                className={`px-4 py-2 text-sm font-medium rounded-md transition-colors ${\n                  mediaType === 'audio'\n                    ? 'bg-white text-gray-900 shadow-sm'\n                    : 'text-gray-600 hover:text-gray-900'\n                }`}\n              >\n                –ê—É–¥—ñ–æ\n              </button>\n            )}\n            {mode === 'attach' && !allowAudio && (\n              <span className=\"ml-2 text-xs text-gray-400\">(—É —Ä–µ–∂–∏–º—ñ –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è –∞—É–¥—ñ–æ –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ)</span>\n            )}\n          </div>\n\n          {/* Status filters removed (was for debugging) */}\n          <button\n            onClick={onClose}\n            className=\"text-gray-500 hover:text-gray-700 p-2\"\n          >\n            <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n            </svg>\n          </button>\n        </div>\n\n        {/* –î–µ–≤–∞–π–¥–µ—Ä –∑ —ñ–Ω–¥–∏–∫–∞—Ü—ñ—î—é –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è */}\n        <div className={`border-t-2 transition-colors duration-300 ${\n          loading || (mediaType === 'photo' && filteredPhotos.length < 15 && hasMore) || \n          (mediaType === 'video' && videos.length < 15 && hasMoreVideos)\n            ? 'border-blue-500' \n            : 'border-gray-200'\n        }`} style={{\n          animation: loading || (mediaType === 'photo' && filteredPhotos.length < 15 && hasMore) || \n          (mediaType === 'video' && videos.length < 15 && hasMoreVideos)\n            ? 'pulse 0.8s ease-in-out infinite alternate' \n            : 'none'\n        }}></div>\n\n        {/* Content */}\n        <div className=\"flex-1 flex min-h-0\">\n          {mediaType === 'photo' ? (\n            /* Photos Grid */\n            <div className=\"flex-1 p-3 flex flex-col min-h-0\">\n            <div className=\"flex items-center justify-between mb-3\">\n              {/* Photo type tabs - only in chat context */}\n              {context === 'chat' ? (\n                <div className=\"flex space-x-1 bg-gray-100 rounded-lg p-1\">\n                  {(!allowedPhotoTabs || allowedPhotoTabs.includes('regular')) && (\n                    <button\n                      onClick={() => setPhotoType('regular')}\n                      className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${\n                        photoType === 'regular'\n                          ? 'bg-white text-gray-900 shadow-sm'\n                          : 'text-gray-600 hover:text-gray-900'\n                      }`}\n                    >\n                      –ó–≤–∏—á–∞–π–Ω—ñ\n                    </button>\n                  )}\n                  {(!allowedPhotoTabs || allowedPhotoTabs.includes('special')) && (\n                    <button\n                      onClick={() => setPhotoType('special')}\n                      className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors flex items-center space-x-1 ${\n                        photoType === 'special'\n                          ? 'bg-white text-gray-900 shadow-sm'\n                          : 'text-gray-600 hover:text-gray-900'\n                      }`}\n                    >\n                      <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path d=\"M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0112.12 15.12z\" />\n                      </svg>\n                      <span>Special</span>\n                    </button>\n                  )}\n                  {(!allowedPhotoTabs || allowedPhotoTabs.includes('special_plus')) && (\n                    <button\n                      onClick={() => setPhotoType('special_plus')}\n                      className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors flex items-center space-x-1 ${\n                        photoType === 'special_plus'\n                          ? 'bg-white text-gray-900 shadow-sm'\n                          : 'text-gray-600 hover:text-gray-900'\n                      }`}\n                      title={'Special+'}\n                    >\n                      <span className=\"relative inline-flex items-center justify-center w-4 h-4\">\n                        <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                          <path d=\"M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0112.12 15.12z\" />\n                          </svg>\n                          <span className=\"absolute -top-0.5 -right-0.5 w-3 h-3 rounded-full bg-white text-pink-600 text-[9px] font-extrabold leading-none flex items-center justify-center border border-pink-500\">+</span>\n                        </span>\n                        <span>Special+</span>\n                      </button>\n                    )}\n                  {(!allowedPhotoTabs || allowedPhotoTabs.includes('temporary')) && (\n                    <button\n                      onClick={() => setPhotoType('temporary')}\n                      className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors flex items-center space-x-1 ${\n                        photoType === 'temporary'\n                          ? 'bg-white text-gray-900 shadow-sm'\n                          : 'text-gray-600 hover:text-gray-900'\n                      }`}\n                    >\n                      <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                        <path d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V5z\" />\n                      </svg>\n                      <span>–¢–∏–º—á–∞—Å–æ–≤—ñ</span>\n                    </button>\n                  )}\n                </div>\n              ) : (\n                <h3 className=\"font-medium\">All photos</h3>\n              )}\n              \n              {/* Status filters moved to header */}\n            </div>\n\n            {error && (\n              <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 mb-4\">\n                <p className=\"text-red-600\">{error}</p>\n              </div>\n            )}\n\n\n\n            {/* Photos Grid */}\n            <div \n              ref={scrollContainerRef}\n              className=\"overflow-y-auto flex-1 p-2 custom-scroll\"\n            >\n              <div \n                className=\"grid grid-cols-5 gap-2\"\n                style={{\n                  gridAutoRows: 'minmax(0, max-content)'\n                }}\n              >\n              {filteredPhotos.map((photo) => {\n                const isSpecial = isSpecialPhoto(photo);\n                const isSpecialPlus = isSpecialPlusPhoto(photo);\n                const isSpecialExact = isSpecialExactPhoto(photo);\n                const isTemporary = isTemporaryPhoto(photo);\n                const isSelectable = isPhotoSelectable(photo);\n                // –£ —Ä–µ–∂–∏–º—ñ –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—î–º–æ –≤–∏–±—ñ—Ä special/special+ —ñ –ø–æ–∫–∞–∑—É—î–º–æ –∫–æ–ª—å–æ—Ä–æ–≤–∏–º–∏\n                const shouldBeGrayed = context === 'chat' && isSpecial && mode !== 'attach';\n                \n                return (\n                  <div\n                    key={photo.idPhoto}\n                    className={`group relative aspect-square rounded-lg overflow-hidden border-2 transition-all ${\n                      !isSelectable\n                        ? 'cursor-not-allowed border-gray-300'\n                        : isPhotoSelected(photo)\n                        ? 'cursor-pointer border-blue-500 ring-2 ring-blue-200'\n                        : 'cursor-pointer border-gray-200 hover:border-gray-300'\n                    }`}\n                    onClick={() => handlePhotoSelect(photo)}\n                  >\n                    <img\n                      src={photo.urls.urlPreview}\n                      alt={`Photo ${photo.idPhoto}`}\n                      className={`w-full h-full object-cover ${shouldBeGrayed ? 'grayscale opacity-60' : ''}`}\n                      loading=\"lazy\"\n                    />\n                    \n                    {/* Special / Special+ photo indicator */}\n                    {(isSpecialExact || isSpecialPlus) && (\n                      <div className=\"absolute top-1 left-1 w-6 h-6 bg-pink-500 rounded-full flex items-center justify-center shadow-sm relative\">\n                        {/* base special icon */}\n                        <svg className=\"w-3 h-3 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                          <path d=\"M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0112.12 15.12z\" />\n                        </svg>\n                        {/* plus overlay for special+ */}\n                        {isSpecialPlus && (\n                          <div className=\"absolute -top-0.5 -right-0.5 w-3 h-3 rounded-full bg-white text-pink-600 flex items-center justify-center text-[10px] font-extrabold leading-none\">+</div>\n                        )}\n                      </div>\n                    )}\n\n                    {/* Selection indicator */}\n                    {isPhotoSelected(photo) && (\n                      <div className=\"absolute top-1 right-1 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center\">\n                        <svg className=\"w-4 h-4 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                        </svg>\n                      </div>\n                    )}\n\n                    {/* Photo status indicator */}\n                    {(() => {\n                      const status = photoStatuses.get(photo.idPhoto);\n                      if (!status) return null;\n                      \n                      return (\n                        <div className={`absolute bottom-1 left-1 w-5 h-5 rounded-full flex items-center justify-center ${\n                          status === 'accessed' \n                            ? 'bg-green-500' \n                            : status === 'sent' \n                            ? 'bg-yellow-500' \n                            : 'bg-black bg-opacity-60'\n                        }`}>\n                          {status === 'accessed' ? (\n                            <svg className=\"w-3 h-3 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                            </svg>\n                          ) : status === 'sent' ? (\n                            <svg className=\"w-3 h-3 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\" />\n                            </svg>\n                          ) : null}\n                        </div>\n                      );\n                    })()}\n\n                    {/* Full size view button - –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è –ø—Ä–∏ —Ö–æ–≤–µ—Ä—ñ */}\n                    <button\n                      onClick={(e) => {\n                        e.stopPropagation();\n                        setFullSizePhoto(photo);\n                      }}\n                      className=\"absolute bottom-1 right-1 w-12 h-12 bg-black bg-opacity-60 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-200 hover:bg-opacity-80\"\n                      title=\"–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≤ –ø–æ–≤–Ω–æ–º—É —Ä–æ–∑–º—ñ—Ä—ñ\"\n                    >\n                      <svg className=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\n                      </svg>\n                    </button>\n                  </div>\n                );\n              })}\n\n\n\n              {/* No more photos message */}\n              {!loading && !hasMore && filteredPhotos.length > 0 && (\n                <div className=\"col-span-5 flex flex-col items-center py-6 text-gray-500\">\n                  <svg className=\"w-12 h-12 mb-2 text-gray-300\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\" />\n                  </svg>\n                  <p className=\"text-sm font-medium mb-1\">–¶–µ –≤—Å—ñ —Ñ–æ—Ç–æ</p>\n                  <p className=\"text-xs text-gray-400\">–ë—ñ–ª—å—à–µ —Ñ–æ—Ç–æ –ø–æ–∫–∏ —â–æ –Ω–µ–º–∞—î</p>\n                </div>\n              )}\n              </div>\n            </div>\n\n\n\n            {/* Empty state for different sections */}\n            {context === 'chat' && filteredPhotos.length === 0 && (\n              <div className=\"flex flex-col items-center justify-center py-12 text-gray-500\">\n                {/* –ü–æ–∫–∞–∑—É—î–º–æ \"–®—É–∫–∞—î–º–æ\" –ø–æ–∫–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –∞–±–æ —î —â–µ —Ñ–æ—Ç–æ */}\n                {(loading || hasMore) ? (\n                  <>\n                    <svg className=\"w-12 h-12 mb-4 animate-pulse\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\n                    </svg>\n                    <p className=\"text-lg font-medium mb-2\">–®—É–∫–∞—î–º–æ —Ñ–æ—Ç–æ...</p>\n                    <p className=\"text-sm text-center\">–ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Ñ–æ—Ç–æ –∑ —Å–µ—Ä–≤–µ—Ä–∞</p>\n                  </>\n                ) : (\n                  <>\n                <svg className=\"w-12 h-12 mb-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v14a2 2 0 002 2z\" />\n                </svg>\n                {photoType === 'regular' && (\n                  <>\n                    <p className=\"text-lg font-medium mb-2\">–ù–µ–º–∞—î –∑–≤–∏—á–∞–π–Ω–∏—Ö —Ñ–æ—Ç–æ</p>\n                    <p className=\"text-sm text-center\">–í—Å—ñ —Ñ–æ—Ç–æ –≤ —Ü—å–æ–º—É –ø—Ä–æ—Ñ—ñ–ª—ñ –º–∞—é—Ç—å —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π —Å—Ç–∞—Ç—É—Å.<br/>–ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ —Ä–æ–∑–¥—ñ–ª—É \"Special\" –∞–±–æ \"–¢–∏–º—á–∞—Å–æ–≤—ñ\" —â–æ–± —ó—Ö –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏.</p>\n                  </>\n                )}\n                {photoType === 'special' && (\n                  <>\n                    <p className=\"text-lg font-medium mb-2\">–ù–µ–º–∞—î –æ—Å–æ–±–ª–∏–≤–∏—Ö —Ñ–æ—Ç–æ</p>\n                    <p className=\"text-sm text-center\">–í —Ü—å–æ–º—É –ø—Ä–æ—Ñ—ñ–ª—ñ –Ω–µ–º–∞—î —Ñ–æ—Ç–æ –∑ —Ç–µ–≥–∞–º–∏ \"special\".</p>\n                  </>\n                )}\n                {photoType === 'temporary' && (\n                  <>\n                    <p className=\"text-lg font-medium mb-2\">–ù–µ–º–∞—î —Ç–∏–º—á–∞—Å–æ–≤–∏—Ö —Ñ–æ—Ç–æ</p>\n                    <p className=\"text-sm text-center\">–í —Ü—å–æ–º—É –ø—Ä–æ—Ñ—ñ–ª—ñ –Ω–µ–º–∞—î —Ç–∏–º—á–∞—Å–æ–≤–∏—Ö —Ñ–æ—Ç–æ.</p>\n                  </>\n                )}\n                  </>\n                )}\n              </div>\n            )}\n\n\n          </div>\n          ) : mediaType === 'video' ? (\n            /* Video Grid */\n            <div className=\"flex-1 p-3 flex flex-col min-h-0\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <h3 className=\"font-medium\">–í—ñ–¥–µ–æ</h3>\n              </div>\n              \n              {/* Status filters for videos */}\n              {context === 'chat' && idRegularUser && (\n                <div className=\"flex space-x-1 bg-gray-100 rounded-lg p-1 mb-3\">\n                  <button\n                    onClick={() => setStatusFilter('all')}\n                    className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors flex items-center space-x-1 ${\n                      statusFilter === 'all'\n                        ? 'bg-white text-gray-900 shadow-sm'\n                        : 'text-gray-600 hover:text-gray-900'\n                    }`}\n                  >\n                    <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6h16M4 10h16M4 14h16M4 18h16\" />\n                    </svg>\n                    <span>–£—Å—ñ</span>\n                  </button>\n                  <button\n                    onClick={() => setStatusFilter('available')}\n                    className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors flex items-center space-x-1 ${\n                      statusFilter === 'available'\n                        ? 'bg-white text-gray-900 shadow-sm'\n                        : 'text-gray-600 hover:text-gray-900'\n                    }`}\n                  >\n                    <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                    </svg>\n                    <span>–î–æ—Å—Ç—É–ø–Ω—ñ</span>\n                  </button>\n                  <button\n                    onClick={() => setStatusFilter('accessed')}\n                    className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors flex items-center space-x-1 ${\n                      statusFilter === 'accessed'\n                        ? 'bg-white text-gray-900 shadow-sm'\n                        : 'text-gray-600 hover:text-gray-900'\n                    }`}\n                  >\n                    <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                    </svg>\n                    <span>–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç—ñ</span>\n                  </button>\n                  <button\n                    onClick={() => setStatusFilter('sent')}\n                    className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors flex items-center space-x-1 ${\n                      statusFilter === 'sent'\n                        ? 'bg-white text-gray-900 shadow-sm'\n                        : 'text-gray-600 hover:text-gray-900'\n                    }`}\n                  >\n                    <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\" />\n                    </svg>\n                    <span>–í—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω—ñ</span>\n                  </button>\n                </div>\n              )}\n\n              {error && (\n                <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 mb-4\">\n                  <p className=\"text-red-600\">{error}</p>\n                </div>\n              )}\n\n              {/* Videos Grid */}\n              <div \n                ref={scrollContainerRef}\n                className=\"overflow-y-auto flex-1 p-2 custom-scroll\"\n              >\n                <div \n                  className=\"grid grid-cols-5 gap-2\"\n                  style={{\n                    gridAutoRows: 'minmax(0, max-content)'\n                  }}\n                >\n                  {filteredVideos.map((video) => (\n                    <div\n                      key={video.idVideo}\n                      className={`group relative aspect-square rounded-lg overflow-hidden border-2 transition-all ${\n                        isVideoSelected(video)\n                          ? 'cursor-pointer border-blue-500 ring-2 ring-blue-200'\n                          : 'cursor-pointer border-gray-200 hover:border-gray-300'\n                      }`}\n                      onClick={() => handleVideoSelect(video)}\n                    >\n                      <img\n                        src={video.urls.urlThumbnail}\n                        alt={`Video ${video.idVideo}`}\n                        className=\"w-full h-full object-cover\"\n                        loading=\"lazy\"\n                      />\n\n                      {/* Duration badge */}\n                      <div className=\"absolute bottom-1 right-1 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded\">\n                        {formatDuration(video.duration)}\n                      </div>\n\n                      {/* Video status indicator */}\n                      {(() => {\n                        const status = videoStatuses.get(video.idVideo);\n                        if (!status) return null;\n                        \n                        return (\n                          <div className={`absolute top-1 left-1 w-5 h-5 rounded-full flex items-center justify-center ${\n                            status === 'accessed' \n                              ? 'bg-green-500' \n                              : status === 'sent' \n                              ? 'bg-yellow-500' \n                              : 'bg-black bg-opacity-60'\n                          }`}>\n                            {status === 'accessed' ? (\n                              <svg className=\"w-3 h-3 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                              </svg>\n                            ) : status === 'sent' ? (\n                              <svg className=\"w-3 h-3 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\" />\n                              </svg>\n                            ) : null}\n                          </div>\n                        );\n                      })()}\n\n                      {/* Selection indicator */}\n                      {isVideoSelected(video) && (\n                        <div className=\"absolute top-1 right-1 w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center\">\n                          <svg className=\"w-4 h-4 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                          </svg>\n                        </div>\n                      )}\n\n                      {/* Full size view button - –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è –ø—Ä–∏ —Ö–æ–≤–µ—Ä—ñ */}\n                      <button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          setFullSizeVideo(video);\n                        }}\n                        className=\"absolute bottom-1 left-1 w-12 h-12 bg-black bg-opacity-60 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-200 hover:bg-opacity-80\"\n                        title=\"–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≤—ñ–¥–µ–æ\"\n                      >\n                        <svg className=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\" />\n                        </svg>\n                      </button>\n                    </div>\n                  ))}\n\n                  {/* No more videos message */}\n                  {!loading && !hasMoreVideos && videos.length > 0 && (\n                    <div className=\"col-span-5 flex flex-col items-center py-6 text-gray-500\">\n                      <svg className=\"w-12 h-12 mb-2 text-gray-300\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z\" />\n                      </svg>\n                      <p className=\"text-sm font-medium mb-1\">–¶–µ –≤—Å—ñ –≤—ñ–¥–µ–æ</p>\n                      <p className=\"text-xs text-gray-400\">–ë—ñ–ª—å—à–µ –≤—ñ–¥–µ–æ –ø–æ–∫–∏ —â–æ –Ω–µ–º–∞—î</p>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {/* Empty state for videos */}\n              {filteredVideos.length === 0 && (\n                <div className=\"flex flex-col items-center justify-center py-12 text-gray-500\">\n                  {(loading || hasMoreVideos) ? (\n                    <>\n                      <svg className=\"w-12 h-12 mb-4 animate-pulse\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z\" />\n                      </svg>\n                      <p className=\"text-lg font-medium mb-2\">–®—É–∫–∞—î–º–æ –≤—ñ–¥–µ–æ...</p>\n                      <p className=\"text-sm text-center\">–ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –≤—ñ–¥–µ–æ –∑ —Å–µ—Ä–≤–µ—Ä–∞</p>\n                    </>\n                  ) : (\n                    <>\n                      <svg className=\"w-12 h-12 mb-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z\" />\n                      </svg>\n                      <p className=\"text-lg font-medium mb-2\">–ù–µ–º–∞—î –≤—ñ–¥–µ–æ</p>\n                      <p className=\"text-sm text-center\">–í —Ü—å–æ–º—É –ø—Ä–æ—Ñ—ñ–ª—ñ –ø–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –≤—ñ–¥–µ–æ</p>\n                    </>\n                  )}\n                </div>\n              )}\n            </div>\n          ) : (\n            /* Audio List */\n            <div className=\"flex-1 p-3 flex flex-col min-h-0\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <h3 className=\"font-medium\">–ê—É–¥—ñ–æ</h3>\n              </div>\n              \n              {/* Status filters for audios */}\n              {context === 'chat' && idRegularUser && (\n                <div className=\"flex space-x-1 bg-gray-100 rounded-lg p-1 mb-3\">\n                  <button\n                    onClick={() => setStatusFilter('all')}\n                    className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors flex items-center space-x-1 ${\n                      statusFilter === 'all'\n                        ? 'bg-white text-gray-900 shadow-sm'\n                        : 'text-gray-600 hover:text-gray-900'\n                    }`}\n                  >\n                    <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6h16M4 10h16M4 14h16M4 18h16\" />\n                    </svg>\n                    <span>–£—Å—ñ</span>\n                  </button>\n                  <button\n                    onClick={() => setStatusFilter('available')}\n                    className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors flex items-center space-x-1 ${\n                      statusFilter === 'available'\n                        ? 'bg-white text-gray-900 shadow-sm'\n                        : 'text-gray-600 hover:text-gray-900'\n                    }`}\n                  >\n                    <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                    </svg>\n                    <span>–î–æ—Å—Ç—É–ø–Ω—ñ</span>\n                  </button>\n                  <button\n                    onClick={() => setStatusFilter('accessed')}\n                    className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors flex items-center space-x-1 ${\n                      statusFilter === 'accessed'\n                        ? 'bg-white text-gray-900 shadow-sm'\n                        : 'text-gray-600 hover:text-gray-900'\n                    }`}\n                  >\n                    <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                    </svg>\n                    <span>–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç—ñ</span>\n                  </button>\n                  <button\n                    onClick={() => setStatusFilter('sent')}\n                    className={`px-3 py-1.5 text-sm font-medium rounded-md transition-colors flex items-center space-x-1 ${\n                      statusFilter === 'sent'\n                        ? 'bg-white text-gray-900 shadow-sm'\n                        : 'text-gray-600 hover:text-gray-900'\n                    }`}\n                  >\n                    <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\" />\n                    </svg>\n                    <span>–í—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω—ñ</span>\n                  </button>\n                </div>\n              )}\n\n              {error && (\n                <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 mb-4\">\n                  <p className=\"text-red-600\">{error}</p>\n                </div>\n              )}\n\n              {/* Audios List */}\n              <div \n                ref={scrollContainerRef}\n                className=\"overflow-y-auto flex-1 p-2 custom-scroll\"\n              >\n                <div className=\"space-y-2\">\n                  {filteredAudios.map((audio) => (\n                    <div\n                      key={audio.id}\n                      className={`group relative p-3 rounded-lg border-2 transition-all cursor-pointer ${\n                        isAudioSelected(audio)\n                          ? 'border-blue-500 bg-blue-50'\n                          : 'border-gray-200 hover:border-gray-300 hover:bg-gray-50'\n                      }`}\n                      onClick={() => handleAudioSelect(audio)}\n                    >\n                      <div className=\"space-y-3\">\n                        {/* Header with icon, title and date */}\n                        <div className=\"flex items-center space-x-3\">\n                          {/* Audio icon */}\n                          <div className=\"flex-shrink-0\">\n                            <svg className=\"w-6 h-6 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3\" />\n                            </svg>\n                          </div>\n\n                          {/* Audio info */}\n                          <div className=\"flex-1 min-w-0\">\n                            <p className=\"text-sm font-medium text-gray-900 truncate\">\n                              {audio.title}\n                            </p>\n                            <p className=\"text-xs text-gray-500\">\n                              {new Date(audio.dateCreated).toLocaleDateString()}\n                            </p>\n                          </div>\n                        </div>\n\n                        {/* Audio Player */}\n                        <div \n                          className=\"w-full\"\n                          onClick={(e) => e.stopPropagation()}\n                        >\n                          <AudioPlayer\n                            src={audio.urls.mp3}\n                            title={audio.title}\n                            duration={audio.duration}\n                            audioId={audio.id}\n                            onPlay={() => handleAudioPlay(audio)}\n                            onPause={handleAudioPause}\n                            onEnded={handleAudioEnded}\n                            onRegister={registerAudioElement}\n                            onUnregister={unregisterAudioElement}\n                          />\n                        </div>\n\n                        {/* Audio status indicator */}\n                        {(() => {\n                          const status = audioStatuses.get(audio.id);\n                          if (!status) return null;\n                          \n                          return (\n                            <div className={`absolute top-2 left-2 w-4 h-4 rounded-full flex items-center justify-center ${\n                              status === 'accessed' \n                                ? 'bg-green-500' \n                                : status === 'sent' \n                                ? 'bg-yellow-500' \n                                : 'bg-black bg-opacity-60'\n                            }`}>\n                              {status === 'accessed' ? (\n                                <svg className=\"w-2.5 h-2.5 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                                </svg>\n                              ) : status === 'sent' ? (\n                                <svg className=\"w-2.5 h-2.5 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\" />\n                                </svg>\n                              ) : null}\n                            </div>\n                          );\n                        })()}\n\n                        {/* Selection indicator */}\n                        {isAudioSelected(audio) && (\n                          <div className=\"absolute top-2 right-2 w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center\">\n                            <svg className=\"w-3 h-3 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                            </svg>\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n\n                {/* Empty state for audios */}\n                {filteredAudios.length === 0 && (\n                  <div className=\"flex flex-col items-center justify-center py-12 text-gray-500\">\n                    {(loading || hasMoreAudios) ? (\n                      <>\n                        <svg className=\"w-12 h-12 mb-4 animate-pulse\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3\" />\n                        </svg>\n                        <p className=\"text-lg font-medium mb-2\">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∞—É–¥—ñ–æ...</p>\n                      </>\n                    ) : (\n                      <>\n                        <svg className=\"w-12 h-12 mb-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3\" />\n                        </svg>\n                        <p className=\"text-lg font-medium mb-2\">–ù–µ–º–∞—î –∞—É–¥—ñ–æ</p>\n                        <p className=\"text-sm text-center\">–ê—É–¥—ñ–æ —Ñ–∞–π–ª–∏ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω—ñ –∞–±–æ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å —Ñ—ñ–ª—å—Ç—Ä—É</p>\n                      </>\n                    )}\n                  </div>\n                )}\n\n                {/* Loading indicator */}\n                {!loading && !hasMoreAudios && audios.length > 0 && (\n                  <div className=\"text-center py-4 text-gray-500 text-sm\">\n                    –í—Å—ñ –∞—É–¥—ñ–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Footer - show for photos, videos and audios */}\n        {(mediaType === 'photo' || mediaType === 'video' || mediaType === 'audio') && (\n          <div className=\"border-t p-3 flex items-center justify-between\">\n            <div className=\"text-sm text-gray-500\">\n              {mediaType === 'photo' \n                ? `${selectedPhotos.length} of ${maxSelection} selected`\n                : mediaType === 'video'\n                ? `${selectedVideos.length} of ${Math.min(maxSelection, filteredVideos.length)} selected`\n                : `${selectedAudios.length} of ${Math.min(maxSelection, filteredAudios.length)} selected`\n              }\n            </div>\n            <div className=\"flex space-x-2\">\n              <button\n                onClick={onClose}\n                className=\"px-4 py-2 text-gray-600 hover:text-gray-800 font-medium\"\n              >\n                Cancel\n              </button>\n              {mode === 'attach' && onAttach ? (\n                <button\n                  onClick={() => onAttach({ photos: selectedPhotos, videos: selectedVideos })}\n                  disabled={(selectedPhotos.length === 0 && selectedVideos.length === 0) || loading}\n                  className={`px-6 py-2 rounded-lg font-medium transition-colors flex items-center space-x-2 ${\n                    ((selectedPhotos.length > 0 || selectedVideos.length > 0) && !loading)\n                      ? 'bg-blue-600 hover:bg-blue-700 text-white'\n                      : 'bg-gray-200 text-gray-400 cursor-not-allowed'\n                  }`}\n                >\n                  <span>{actionLabel || '–ü—Ä–∏–∫—Ä—ñ–ø–∏—Ç–∏'}</span>\n                </button>\n              ) : (\n                <button\n                  onClick={\n                    mediaType === 'photo' \n                      ? handleSendPhotos \n                      : mediaType === 'video' \n                      ? handleSendVideos \n                      : handleSendAudios\n                  }\n                  disabled={\n                    (mediaType === 'photo' ? selectedPhotos.length === 0 \n                     : mediaType === 'video' ? selectedVideos.length === 0 \n                     : selectedAudios.length === 0) || loading\n                  }\n                  className={`px-6 py-2 rounded-lg font-medium transition-colors flex items-center space-x-2 ${\n                    ((mediaType === 'photo' ? selectedPhotos.length > 0 \n                      : mediaType === 'video' ? selectedVideos.length > 0 \n                      : selectedAudios.length > 0) && !loading)\n                      ? 'bg-blue-600 hover:bg-blue-700 text-white'\n                      : 'bg-gray-200 text-gray-400 cursor-not-allowed'\n                  }`}\n                >\n                  {loading && (\n                    <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white\"></div>\n                  )}\n                  <span>{loading ? 'Sending...' : 'Send ‚Üí'}</span>\n                </button>\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Full size photo modal */}\n      {fullSizePhoto && (\n        <div \n          className=\"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-[60]\"\n          onClick={() => setFullSizePhoto(null)}\n        >\n          <div className=\"relative max-w-[90vw] max-h-[90vh] flex items-center justify-center\">\n            <img\n              src={fullSizePhoto.urls.urlOriginal}\n              alt={`Photo ${fullSizePhoto.idPhoto}`}\n              className=\"max-w-full max-h-full object-contain rounded-lg cursor-pointer\"\n              onClick={() => setFullSizePhoto(null)}\n              onError={(e) => {\n                // Fallback to standard size if original fails\n                const target = e.target as HTMLImageElement;\n                target.src = fullSizePhoto.urls.urlStandard;\n              }}\n            />\n            <button\n              onClick={(e) => {\n                e.stopPropagation();\n                setFullSizePhoto(null);\n              }}\n              className=\"absolute top-4 right-4 w-10 h-10 bg-black bg-opacity-60 rounded-full flex items-center justify-center text-white hover:bg-opacity-80 transition-all\"\n              title=\"–ó–∞–∫—Ä–∏—Ç–∏\"\n            >\n              <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n              </svg>\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Full size video modal */}\n      {fullSizeVideo && (\n        <div \n          className=\"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-[60]\"\n          onClick={() => setFullSizeVideo(null)}\n        >\n          <div className=\"relative max-w-[90vw] max-h-[90vh] flex items-center justify-center\">\n            <video\n              src={fullSizeVideo.urls.urlMp4Hd}\n              controls\n              autoPlay\n              className=\"max-w-full max-h-full object-contain rounded-lg\"\n              onError={(e) => {\n                // Fallback to SD quality if HD fails\n                const target = e.target as HTMLVideoElement;\n                target.src = fullSizeVideo.urls.urlMp4Sd;\n              }}\n            />\n            <button\n              onClick={(e) => {\n                e.stopPropagation();\n                setFullSizeVideo(null);\n              }}\n              className=\"absolute top-4 right-4 w-10 h-10 bg-black bg-opacity-60 rounded-full flex items-center justify-center text-white hover:bg-opacity-80 transition-all\"\n              title=\"–ó–∞–∫—Ä–∏—Ç–∏\"\n            >\n              <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n              </svg>\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","\"use client\";\n\nimport React, { useEffect } from 'react';\n\ntype ImagePreviewModalProps = {\n\tisOpen: boolean;\n\tsrc: string | null;\n\tisLoading?: boolean;\n\tonClose: () => void;\n};\n\nexport default function ImagePreviewModal({ isOpen, src, isLoading = false, onClose }: ImagePreviewModalProps) {\n\tuseEffect(() => {\n\t\tif (!isOpen) return;\n\t\tconst onKey = (e: KeyboardEvent) => {\n\t\t\tif (e.key === 'Escape') onClose();\n\t\t};\n\t\tdocument.addEventListener('keydown', onKey);\n\t\treturn () => document.removeEventListener('keydown', onKey);\n\t}, [isOpen, onClose]);\n\n\tif (!isOpen) return null;\n\n\treturn (\n\t\t<div \n\t\t\tclassName=\"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-[60]\"\n\t\t\tonClick={onClose}\n\t\t>\n\t\t\t<div className=\"relative max-w-[90vw] max-h-[90vh] flex items-center justify-center\" onClick={(e) => e.stopPropagation()}>\n\t\t\t\t{isLoading ? (\n\t\t\t\t\t<div className=\"w-16 h-16 border-4 border-white/40 border-t-white rounded-full animate-spin\" />\n\t\t\t\t) : (\n\t\t\t\t\tsrc && (\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tsrc={src}\n\t\t\t\t\t\t\talt=\"Preview\"\n\t\t\t\t\t\t\tclassName=\"max-w-full max-h-full object-contain rounded-lg cursor-pointer\"\n\t\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)\n\t\t\t\t)}\n\t\t\t\t<button\n\t\t\t\t\tonClick={onClose}\n\t\t\t\t\tclassName=\"absolute top-4 right-4 w-10 h-10 bg-black bg-opacity-60 rounded-full flex items-center justify-center text-white hover:bg-opacity-80 transition-all\"\n\t\t\t\t\ttitle=\"–ó–∞–∫—Ä–∏—Ç–∏\"\n\t\t\t\t>\n\t\t\t\t\t<svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n\t\t\t\t\t\t<path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\n\n","\"use client\";\n\nimport React, { Component, ReactNode } from 'react';\n\ninterface Props {\n\tchildren: ReactNode;\n\tfallback?: ReactNode;\n\tonError?: (error: Error, errorInfo: React.ErrorInfo) => void;\n}\n\ninterface State {\n\thasError: boolean;\n\terror?: Error;\n}\n\nclass LottieErrorBoundary extends Component<Props, State> {\n\tconstructor(props: Props) {\n\t\tsuper(props);\n\t\tthis.state = { hasError: false };\n\t}\n\n\tstatic getDerivedStateFromError(error: Error): State {\n\t\treturn { hasError: true, error };\n\t}\n\n\tcomponentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\n\t\tconsole.error('üé≠ Lottie Error Boundary caught an error:', error, errorInfo);\n\n\t\t// –í–∏–∫–ª–∏–∫–∞—î–º–æ callback —è–∫—â–æ –≤—ñ–Ω –Ω–∞–¥–∞–Ω–∏–π\n\t\tif (this.props.onError) {\n\t\t\tthis.props.onError(error, errorInfo);\n\t\t}\n\n\t\t// –õ–æ–≥—É—î–º–æ –¥–µ—Ç–∞–ª—å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –ø–æ–º–∏–ª–∫—É\n\t\tconsole.error('üé≠ Lottie Error Details:');\n\t\tconsole.error('- Error message:', error.message);\n\t\tconsole.error('- Error stack:', error.stack);\n\t\tconsole.error('- Component stack:', errorInfo.componentStack);\n\t}\n\n\trender() {\n\t\tif (this.state.hasError) {\n\t\t\t// –ü–æ–∫–∞–∑—É—î–º–æ fallback UI\n\t\t\tif (this.props.fallback) {\n\t\t\t\treturn this.props.fallback;\n\t\t\t}\n\n\t\t\t// Default fallback UI –¥–ª—è Lottie –ø–æ–º–∏–ª–æ–∫\n\t\t\treturn (\n\t\t\t\t<div className=\"w-full h-full flex items-center justify-center bg-gradient-to-br from-pink-100 to-purple-100 rounded-md\">\n\t\t\t\t\t<div className=\"text-center p-2\">\n\t\t\t\t\t\t<div className=\"text-2xl mb-1\">üé≠</div>\n\t\t\t\t\t\t<div className=\"text-xs text-gray-600 font-medium\">–ü–æ–º–∏–ª–∫–∞ –∞–Ω—ñ–º–∞—Ü—ñ—ó</div>\n\t\t\t\t\t\t<div className=\"text-xs text-gray-500 mt-1\">Lottie</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t\treturn this.props.children;\n\t}\n}\n\n// HOC –¥–ª—è –∑—Ä—É—á–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑ Lottie –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏\nexport const withLottieErrorBoundary = <P extends object>(\n\tComponent: React.ComponentType<P>,\n\tfallback?: ReactNode,\n\tonError?: (error: Error, errorInfo: React.ErrorInfo) => void\n) => {\n\treturn (props: P) => (\n\t\t<LottieErrorBoundary fallback={fallback} onError={onError}>\n\t\t\t<Component {...props} />\n\t\t</LottieErrorBoundary>\n\t);\n};\n\nexport default LottieErrorBoundary;\n","\"use client\";\n\nimport React, { useState, useRef, useEffect } from 'react';\n\ninterface EmojiPickerProps {\n  onEmojiSelect: (emoji: string) => void;\n  onClose: () => void;\n  isOpen: boolean;\n  className?: string;\n}\n\n// –ü–æ–ø—É–ª—è—Ä–Ω—ñ –µ–º–æ–¥–∑—ñ –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –¥–æ—Å—Ç—É–ø—É\nconst POPULAR_EMOJIS = [\n  'üòÄ', 'üòÇ', '‚ù§Ô∏è', 'üëç', 'üëé', 'üëã', 'üôå', 'üëè', 'üôè', 'ü§ù',\n  'üòä', 'üòç', 'ü•∞', 'üòò', 'üòâ', 'üòé', 'ü§î', 'üòÆ', 'üò¢', 'üò≠',\n  'üò§', 'üò°', 'ü•∫', 'üò¥', 'ü§ó', 'ü§≠', 'ü§´', 'ü§•', 'ü§ë', 'ü§ê',\n  'üíñ', 'üíï', 'üíØ', 'üî•', '‚≠ê', '‚ú®', 'üí´', 'üåü', 'üéâ', 'üéä',\n  'üçé', 'üçä', 'üçã', 'üçå', 'üçâ', 'üçá', 'üçì', 'ü´ê', 'üçà', 'üçí',\n  'üåπ', 'üå∑', 'üå∫', 'üå∏', 'üåº', 'üåª', 'üå∑', 'üåπ', 'ü•Ä', 'üå±',\n  'üê∂', 'üê±', 'üê≠', 'üêπ', 'üê∞', 'ü¶ä', 'üêª', 'üêº', 'üê®', 'üêØ',\n  'üë®', 'üë©', 'üëß', 'üë¶', 'üë∂', 'üëµ', 'üë¥', 'üßë', 'üë®‚Äçüíª', 'üë©‚Äçüíª',\n  'üíº', 'üì±', 'üíª', '‚å®Ô∏è', 'üñ•Ô∏è', 'üñ®Ô∏è', 'üì∫', 'üì∑', 'üé•', 'üéµ',\n  '‚öΩ', 'üèÄ', 'üèà', '‚öæ', 'üéæ', 'üèê', 'üèâ', 'ü•è', 'üé±', 'ü™Ä',\n  'üöó', 'üöï', 'üöô', 'üöå', 'üöé', 'üèéÔ∏è', 'üöì', 'üöë', 'üöí', 'üöê',\n  '‚úàÔ∏è', 'üöÄ', 'üöÅ', 'üõ≥Ô∏è', '‚õµ', 'üõ∂', 'üö§', 'üõ•Ô∏è', 'üõ©Ô∏è', 'üõ∏'\n];\n\nexport const EmojiPicker: React.FC<EmojiPickerProps> = ({\n  onEmojiSelect,\n  onClose,\n  isOpen,\n  className = \"\"\n}) => {\n  const pickerRef = useRef<HTMLDivElement>(null);\n\n  // –ó–∞–∫—Ä–∏—Ç—Ç—è –ø—Ä–∏ –∫–ª—ñ–∫—É –ø–æ–∑–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (pickerRef.current && !pickerRef.current.contains(event.target as Node)) {\n        onClose();\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('mousedown', handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [isOpen, onClose]);\n\n  // –ó–∞–∫—Ä–∏—Ç—Ç—è –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ Escape\n  useEffect(() => {\n    const handleEscape = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        onClose();\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('keydown', handleEscape);\n    }\n\n    return () => {\n      document.removeEventListener('keydown', handleEscape);\n    };\n  }, [isOpen, onClose]);\n\n  const handleEmojiClick = (emoji: string) => {\n    onEmojiSelect(emoji);\n    // –ù–µ –∑–∞–∫—Ä–∏–≤–∞—î–º–æ –º–µ–Ω—é –ø—ñ—Å–ª—è –≤–∏–±–æ—Ä—É –µ–º–æ–¥–∑—ñ\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div\n      ref={pickerRef}\n      className={`absolute z-50 bg-white border border-gray-300 rounded-lg shadow-xl ${className}`}\n      style={{\n        bottom: '100%',\n        right: 0,\n        marginBottom: '8px',\n        width: 'fit-content',\n        minWidth: '220px',\n        maxWidth: '240px'\n      }}\n    >\n      <div className=\"p-3\">\n        {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */}\n        <div className=\"flex items-center justify-between mb-3 pb-2 border-b border-gray-200\">\n          <span className=\"text-sm font-medium text-gray-700\">–í–∏–±–µ—Ä—ñ—Ç—å –µ–º–æ–¥–∑—ñ</span>\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n          >\n            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n            </svg>\n          </button>\n        </div>\n\n        {/* –°—ñ—Ç–∫–∞ –µ–º–æ–¥–∑—ñ */}\n        <div className=\"max-h-96 overflow-y-auto custom-scroll\">\n        <div className=\"grid gap-2 p-1\" style={{\n          display: 'grid',\n          gridTemplateColumns: 'repeat(5, 36px)',\n          gridAutoRows: '36px'\n        }}>\n          {POPULAR_EMOJIS.map((emoji, index) => (\n            <button\n              key={index}\n              onClick={() => handleEmojiClick(emoji)}\n              className=\"flex items-center justify-center hover:bg-gray-100 rounded transition-colors text-2xl leading-none\"\n              title={`–î–æ–¥–∞—Ç–∏ ${emoji}`}\n              style={{\n                fontSize: '1.44em',\n                width: '36px !important',\n                height: '36px !important',\n                minWidth: '36px !important',\n                minHeight: '36px !important',\n                maxWidth: '36px !important',\n                maxHeight: '36px !important'\n              }}\n            >\n              {emoji}\n            </button>\n          ))}\n        </div>\n        </div>\n\n        {/* –ü—ñ–¥–∫–∞–∑–∫–∞ */}\n        <div className=\"mt-2 pt-2 border-t border-gray-200\">\n          <p className=\"text-xs text-gray-500 text-center\">\n            –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –µ–º–æ–¥–∑—ñ –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∞–±–æ Escape –¥–ª—è –∑–∞–∫—Ä–∏—Ç—Ç—è\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n};\n","\"use client\";\n\nimport React, { useEffect, useState, useRef, useCallback, useLayoutEffect, useMemo } from 'react';\nimport { apiPost } from '@/lib/api';\nimport { useToast } from '@/contexts/ToastContext';\nimport { MediaGallery, Photo, Video } from '@/components/MediaGallery';\nimport { EmojiPicker } from '@/components/EmojiPicker';\n\ninterface EmailAttachment {\n  id: string;\n  url_thumbnail: string;\n  url_original: string;\n  is_paid?: boolean;\n  display_attributes?: any[];\n}\n\ninterface EmailMessage {\n  id: string;\n  id_user_from: string;\n  id_user_to: string;\n  title?: string;\n  content: string;\n  date_created: string;\n  status?: string;\n  attachments?: {\n    images?: EmailAttachment[];\n  };\n  is_paid?: boolean;\n}\n\ninterface EmailHistoryProps {\n  isOpen: boolean;\n  onClose: () => void;\n  profileId: string;\n  clientId: string;\n  correspondenceId: string;\n  lettersLeft?: number | null;\n}\n\n// –ú–µ–º–æ—ñ–∑–æ–≤–∞–Ω–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω—å\nconst EmailAttachments = React.memo(({ \n  images, \n  isFromProfile, \n  onImageClick \n}: { \n  images: EmailAttachment[], \n  isFromProfile: boolean, \n  onImageClick: (url: string, alt: string) => void \n}) => (\n  <div className={isFromProfile ? 'border-t pt-3 border-blue-400' : 'border-t pt-3 border-gray-200'}>\n    <h4 className={isFromProfile ? 'text-sm font-medium mb-2 text-white' : 'text-sm font-medium mb-2 text-gray-900'}>üìé –í–∫–ª–∞–¥–µ–Ω–Ω—è:</h4>\n    <div className=\"flex flex-wrap gap-2\">\n      {images.map((image) => {\n        const thumbnailUrl = image.url_thumbnail || image.url_original;\n        const originalUrl = image.url_original || image.url_thumbnail;\n        \n        return (\n          <div key={image.id} className=\"relative inline-block w-20 h-20 border border-gray-200 rounded overflow-hidden\">\n            <img\n              src={thumbnailUrl}\n              alt={`Attachment ${image.id}`}\n              className=\"w-full h-full object-cover cursor-pointer hover:opacity-80 transition-opacity\"\n              style={{ display: 'block' }}\n              onClick={() => onImageClick(originalUrl, `Attachment ${image.id}`)}\n              onError={(e) => {\n                const target = e.target as HTMLImageElement;\n                target.style.display = 'none';\n                target.onerror = null;\n              }}\n            />\n            {image.is_paid && (\n              <div className=\"absolute top-1 right-1 w-4 h-4 bg-green-500 rounded-full flex items-center justify-center\">\n                <svg className=\"w-2 h-2 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                  <path d=\"M10 12a2 2 0 100-4 2 2 0 000 4z\"/>\n                  <path fillRule=\"evenodd\" d=\"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z\" clipRule=\"evenodd\"/>\n                </svg>\n              </div>\n            )}\n          </div>\n        );\n      })}\n    </div>\n  </div>\n));\n\nexport default function EmailHistory({ isOpen, onClose, profileId, clientId, correspondenceId, lettersLeft }: EmailHistoryProps) {\n  const { showToast } = useToast();\n  const [emails, setEmails] = useState<EmailMessage[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [loadingTop, setLoadingTop] = useState(false);\n  const [page, setPage] = useState(1);\n  const [hasMore, setHasMore] = useState(true);\n  const [fullSizeImage, setFullSizeImage] = useState<{ url: string; alt: string } | null>(null);\n  const [previousEmailCount, setPreviousEmailCount] = useState(0);\n  const [isInitialLoad, setIsInitialLoad] = useState(true);\n  const messagesContainerRef = useRef<HTMLDivElement>(null);\n  \n  // üéØ useRef –¥–ª—è page - –≤–∏—Ä—ñ—à—É—î –ø—Ä–æ–±–ª–µ–º—É stale closure\n  const pageRef = useRef(1);\n\n  // –°—Ç–∞–Ω –¥–ª—è –Ω–∞–ø–∏—Å–∞–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –ª–∏—Å—Ç–∞\n  const [composeText, setComposeText] = useState('');\n  const [isAttachGalleryOpen, setIsAttachGalleryOpen] = useState(false);\n  const [isEmailEmojiPickerOpen, setIsEmailEmojiPickerOpen] = useState(false);\n  const [attachedPhotos, setAttachedPhotos] = useState<Photo[]>([]);\n  const [attachedVideos, setAttachedVideos] = useState<Video[]>([]);\n  const [forbiddenTags, setForbiddenTags] = useState<string[]>([]); // –º–∞–π–±—É—Ç–Ω—ñ–π –∑–∞–ø–∏—Ç –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–∏—Ö —Ç–µ–≥—ñ–≤\n\n  // –î–æ–∑–≤–æ–ª–µ–Ω—ñ –≤–∫–ª–∞–¥–∫–∏ –¥–ª—è —Ñ–æ—Ç–æ –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–∏—Ö —Ç–µ–≥—ñ–≤\n  const emailAllowedPhotoTabs = useMemo(() => {\n    const disallow = new Set(forbiddenTags || []);\n    const tabs: Array<'regular' | 'special' | 'special_plus' | 'temporary'> = ['regular', 'temporary'];\n    if (!disallow.has('special')) tabs.push('special');\n    if (!disallow.has('special_plus')) tabs.push('special_plus');\n    return tabs;\n  }, [forbiddenTags]);\n\n  // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–∏—Ö —Ç–µ–≥—ñ–≤ (–∫–∞—Ç–µ–≥–æ—Ä—ñ–π) –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –¥—ñ–∞–ª–æ–≥—É\n  useEffect(() => {\n    const loadForbidden = async () => {\n      try {\n        if (!isOpen || !profileId || !clientId) return;\n        const resp = await apiPost<{ success: boolean; tags?: string[]; error?: string }>(\n          '/api/chats/tt-forbidden-tags',\n          { profileId: parseInt(profileId), idInterlocutor: parseInt(clientId) }\n        );\n        if (resp.success && Array.isArray(resp.tags)) {\n          setForbiddenTags(resp.tags);\n        } else {\n          setForbiddenTags([]);\n        }\n      } catch (e: any) {\n        setForbiddenTags([]);\n        showToast({\n          title: '–ü–æ–º–∏–ª–∫–∞ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä—ñ–π',\n          message: e?.message || '–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –æ–±–º–µ–∂–µ–Ω–Ω—è –∫–∞—Ç–µ–≥–æ—Ä—ñ–π',\n          type: 'error'\n        });\n      }\n    };\n    loadForbidden();\n  }, [isOpen, profileId, clientId]);\n\n  // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ª–∏—Å—Ç—ñ–≤\n  const loadEmails = useCallback(async (pageNum: number = 1, append: boolean = false) => {\n    if (loading || !correspondenceId) return;\n\n    setLoading(true);\n    try {\n      const response = await apiPost('/api/tt/emails-history', {\n        page: pageNum,\n        limit: 10,\n        id_correspondence: correspondenceId,\n        id_interlocutor: clientId,\n        id_user: profileId,\n        without_translation: false\n      });\n\n      if ((response as any).success && (response as any).data?.data?.history) {\n        const newEmails = (response as any).data.data.history.sort((a: EmailMessage, b: EmailMessage) => \n          new Date(a.date_created).getTime() - new Date(b.date_created).getTime()\n        );\n\n        if (append) {\n          // –§—ñ–ª—å—Ç—Ä—É—î–º–æ –¥—É–±–ª—ñ–∫–∞—Ç–∏ –ø–µ—Ä–µ–¥ –¥–æ–¥–∞–≤–∞–Ω–Ω—è–º\n          setEmails(prev => {\n            const existingIds = new Set(prev.map((email: EmailMessage) => email.id));\n            const uniqueNewEmails = newEmails.filter((email: EmailMessage) => !existingIds.has(email.id));\n            const duplicatesCount = newEmails.length - uniqueNewEmails.length;\n            if (duplicatesCount > 0) {\n              console.log(`üìß EmailHistory: –í—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–æ ${duplicatesCount} –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤`);\n            }\n            return [...uniqueNewEmails, ...prev];\n          });\n          // –û–Ω–æ–≤–ª—é—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫ —Ç—ñ–ª—å–∫–∏ –¥–ª—è —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –ª–∏—Å—Ç—ñ–≤\n          setPreviousEmailCount(prevCount => {\n            const existingIds = new Set(emails.map((email: EmailMessage) => email.id));\n            const uniqueCount = newEmails.filter((email: EmailMessage) => !existingIds.has(email.id)).length;\n            return prevCount + uniqueCount;\n          });\n        } else {\n          setEmails(newEmails);\n          setPreviousEmailCount(0);\n          setIsInitialLoad(true);\n        }\n\n        setHasMore(newEmails.length === 10);\n        // üéØ –û–Ω–æ–≤–ª—é—î–º–æ —ñ pageRef, —ñ state –æ–¥–Ω–æ—á–∞—Å–Ω–æ\n        pageRef.current = pageNum;\n        setPage(pageNum);\n      }\n    } catch (error) {\n      console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ª–∏—Å—Ç—ñ–≤:', error);\n    } finally {\n      setLoading(false);\n    }\n  }, [correspondenceId, clientId, profileId]); // –ü—Ä–∏–±—Ä–∞–ª–∏ loading –∑ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π\n\n  // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ä—ñ—à–∏—Ö –ª–∏—Å—Ç—ñ–≤\n  const loadOlderEmails = useCallback(async () => {\n    if (loadingTop || !hasMore || loading) return;\n\n    setLoadingTop(true);\n    try {\n      // üî• –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ pageRef.current –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è\n      const currentPage = pageRef.current;\n      const nextPage = currentPage + 1;\n      \n      console.log(`üìß EmailHistory: –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Å—Ç–æ—Ä—ñ–Ω–∫—É ${nextPage} (–ø–æ—Ç–æ—á–Ω–∞: ${currentPage})`);\n      const response = await apiPost('/api/tt/emails-history', {\n        page: nextPage,\n        limit: 10,\n        id_correspondence: correspondenceId,\n        id_interlocutor: clientId,\n        id_user: profileId,\n        without_translation: false\n      });\n\n      if ((response as any).success && (response as any).data?.data?.history) {\n        const olderEmails = (response as any).data.data.history.sort((a: EmailMessage, b: EmailMessage) => \n          new Date(a.date_created).getTime() - new Date(b.date_created).getTime()\n        );\n\n        if (olderEmails.length > 0) {\n          // –§—ñ–ª—å—Ç—Ä—É—î–º–æ –¥—É–±–ª—ñ–∫–∞—Ç–∏ –ø–µ—Ä–µ–¥ –¥–æ–¥–∞–≤–∞–Ω–Ω—è–º\n          setEmails(prev => {\n            const existingIds = new Set(prev.map((email: EmailMessage) => email.id));\n            const uniqueOlderEmails = olderEmails.filter((email: EmailMessage) => !existingIds.has(email.id));\n            const duplicatesCount = olderEmails.length - uniqueOlderEmails.length;\n            if (duplicatesCount > 0) {\n              console.log(`üìß EmailHistory: –í—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–æ ${duplicatesCount} –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤ –ø—Ä–∏ –ø–∞–≥—ñ–Ω–∞—Ü—ñ—ó`);\n            }\n            return [...uniqueOlderEmails, ...prev];\n          });\n          // –û–Ω–æ–≤–ª—é—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫ —Ç—ñ–ª—å–∫–∏ –¥–ª—è —É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö –ª–∏—Å—Ç—ñ–≤\n          setPreviousEmailCount(prevCount => {\n            const existingIds = new Set(emails.map((email: EmailMessage) => email.id));\n            const uniqueCount = olderEmails.filter((email: EmailMessage) => !existingIds.has(email.id)).length;\n            return prevCount + uniqueCount;\n          });\n          // üéØ –û–Ω–æ–≤–ª—é—î–º–æ —ñ pageRef, —ñ state –æ–¥–Ω–æ—á–∞—Å–Ω–æ\n          pageRef.current = nextPage;\n          setPage(nextPage);\n          setHasMore(olderEmails.length === 10);\n          \n          console.log(`‚úÖ EmailHistory: –£—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ —Å—Ç–æ—Ä—ñ–Ω–∫—É ${nextPage}`);\n        } else {\n          setHasMore(false);\n          console.log(`üìß EmailHistory: –ë—ñ–ª—å—à–µ –ª–∏—Å—Ç—ñ–≤ –Ω–µ–º–∞—î`);\n        }\n      }\n    } catch (error) {\n      console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ä—ñ—à–∏—Ö –ª–∏—Å—Ç—ñ–≤:', error);\n    } finally {\n      setLoadingTop(false);\n    }\n  }, [correspondenceId, clientId, profileId]); // üéØ –ü—Ä–∏–±—Ä–∞–ª–∏ page - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ pageRef\n\n  // –û–±—Ä–æ–±–∫–∞ —Å–∫—Ä–æ–ª—É\n  const handleScroll = useCallback((e: React.UIEvent<HTMLDivElement>) => {\n    const { scrollTop } = e.currentTarget;\n    \n    if (scrollTop === 0 && hasMore && !loadingTop && !loading) {\n      loadOlderEmails();\n    }\n  }, []); // –ü—Ä–∏–±—Ä–∞–ª–∏ –≤—Å—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ, —Ñ—É–Ω–∫—Ü—ñ—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø–æ—Ç–æ—á–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ç–∞–Ω—É\n\n  // –ö–æ—Ä–µ–∫—Ü—ñ—è –ø–æ–∑–∏—Ü—ñ—ó —Å–∫—Ä–æ–ª—É –ø—ñ—Å–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ä—ñ—à–∏—Ö –ª–∏—Å—Ç—ñ–≤\n  useLayoutEffect(() => {\n    if (previousEmailCount > 0 && messagesContainerRef.current) {\n      const container = messagesContainerRef.current;\n      const emailElements = container.querySelectorAll('[data-email-id]');\n      \n      if (emailElements.length > previousEmailCount) {\n        const targetElement = emailElements[previousEmailCount] as HTMLElement;\n        if (targetElement) {\n          container.scrollTop = targetElement.offsetTop - 100;\n        }\n      }\n      \n      setPreviousEmailCount(0);\n    }\n  }, [emails, previousEmailCount]);\n\n  // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–∏ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ\n  useEffect(() => {\n    if (isOpen && correspondenceId) {\n      setEmails([]);\n      setPage(1);\n      setHasMore(true);\n      setPreviousEmailCount(0);\n      setIsInitialLoad(true);\n      loadEmails(1, false);\n    }\n  }, [isOpen, correspondenceId]);\n\n  // –°–∫—Ä–æ–ª –¥–æ –Ω–∏–∑—É —Ç—ñ–ª—å–∫–∏ –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ\n  useEffect(() => {\n    if (emails.length > 0 && messagesContainerRef.current && isInitialLoad) {\n      const container = messagesContainerRef.current;\n      setTimeout(() => {\n        container.scrollTop = container.scrollHeight;\n        setIsInitialLoad(false); // –ü–æ–∑–Ω–∞—á–∞—î–º–æ —â–æ –ø–µ—Ä—à–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ\n      }, 100);\n    }\n  }, [emails, isInitialLoad]);\n\n  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –µ–º–æ–¥–∑—ñ –¥–æ —Ç–µ–∫—Å—Ç—É –ª–∏—Å—Ç–∞\n  const handleEmailEmojiSelect = (emoji: string) => {\n    setComposeText(prev => prev + emoji);\n  };\n\n  // –ó–∞–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª—É –ø–æ Escape\n  useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        if (fullSizeImage) {\n          setFullSizeImage(null);\n        } else {\n          onClose();\n        }\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('keydown', handleKeyDown);\n      return () => document.removeEventListener('keydown', handleKeyDown);\n    }\n  }, [isOpen, fullSizeImage, onClose]);\n\n  // –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –¥–∞—Ç–∏\n  const formatDate = (dateString: string) => {\n    try {\n      const date = new Date(dateString);\n      return date.toLocaleString('uk-UA', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n        hour: '2-digit',\n        minute: '2-digit'\n      });\n    } catch {\n      return dateString;\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <React.Fragment>\n      <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n        <div className=\"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[80vh] flex flex-col\">\n          {/* Header */}\n          <div className=\"flex items-center justify-between p-4 border-b\">\n            <h2 className=\"text-lg font-semibold text-gray-900\">üìß –Ü—Å—Ç–æ—Ä—ñ—è –ª–∏—Å—Ç—É–≤–∞–Ω–Ω—è</h2>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n            >\n              <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n              </svg>\n            </button>\n          </div>\n\n          {/* Content */}\n          <div\n            ref={messagesContainerRef}\n            className=\"flex-1 overflow-y-auto p-4 custom-scroll\"\n            onScroll={handleScroll}\n          >\n            {/* –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤–≥–æ—Ä—ñ */}\n            {loadingTop && (\n              <div className=\"text-center py-4\">\n                <div className=\"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600\"></div>\n                <span className=\"ml-2 text-gray-600\">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞—Ä—ñ—à–∏—Ö –ª–∏—Å—Ç—ñ–≤...</span>\n              </div>\n            )}\n\n            {emails.length === 0 && !loading ? (\n              <div className=\"text-center text-gray-500 py-8\">\n                üì≠ –ù–µ–º–∞—î –ª–∏—Å—Ç—ñ–≤ –≤ —Ü—ñ–π –∫–æ—Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ü—ñ—ó\n              </div>\n            ) : (\n              <div className=\"space-y-4 px-4\">\n                {emails.map((email) => {\n                  const isFromProfile = email.id_user_from === profileId;\n                  return (\n                    <div key={email.id} data-email-id={email.id} className={isFromProfile ? 'flex justify-end' : 'flex justify-start'}>\n                      <div className={isFromProfile\n                        ? 'max-w-[80%] p-4 shadow-sm bg-blue-500 text-white rounded-l-lg rounded-tr-lg'\n                        : 'max-w-[80%] p-4 shadow-sm bg-gray-100 text-gray-900 rounded-r-lg rounded-tl-lg'\n                      }>\n                        {/* Email Header */}\n                        <div className=\"flex items-start justify-between mb-3\">\n                          <div className=\"flex-1\">\n                            <h3 className={isFromProfile ? 'font-medium mb-1 text-white' : 'font-medium mb-1 text-gray-900'}>\n                              {email.title || '–ë–µ–∑ —Ç–µ–º–∏'}\n                            </h3>\n                            <div className={isFromProfile ? 'flex items-center space-x-4 text-sm text-blue-100' : 'flex items-center space-x-4 text-sm text-gray-600'}>\n                              <span>–í—ñ–¥: {email.id_user_from}</span>\n                              <span>–î–æ: {email.id_user_to}</span>\n                              <span>{formatDate(email.date_created)}</span>\n                              {email.is_paid && (\n                                <span className={isFromProfile ? 'px-2 py-1 rounded text-xs bg-blue-600 text-blue-100' : 'px-2 py-1 rounded text-xs bg-yellow-100 text-yellow-800'}>\n                                  üí∞ –ü–ª–∞—Ç–Ω–∏–π\n                                </span>\n                              )}\n                            </div>\n                          </div>\n                          <div className=\"text-right\">\n                            <span className={email.status === 'read'\n                              ? (isFromProfile ? 'px-2 py-1 rounded text-xs bg-blue-600 text-blue-100' : 'px-2 py-1 rounded text-xs bg-green-100 text-green-800')\n                              : (isFromProfile ? 'px-2 py-1 rounded text-xs bg-blue-600 text-blue-100' : 'px-2 py-1 rounded text-xs bg-blue-100 text-blue-800')\n                            }>\n                              {email.status === 'read' ? '–ü—Ä–æ—á–∏—Ç–∞–Ω–æ' : '–ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–æ'}\n                            </span>\n                          </div>\n                        </div>\n\n                        {/* Email Content */}\n                        <div\n                          className={isFromProfile ? 'mb-3 prose prose-sm max-w-none prose-invert' : 'mb-3 prose prose-sm max-w-none text-gray-800'}\n                          dangerouslySetInnerHTML={{ __html: email.content }}\n                        />\n\n                        {/* Attachments */}\n                        {email.attachments?.images && email.attachments.images.length > 0 && (\n                          <EmailAttachments\n                            images={email.attachments.images}\n                            isFromProfile={isFromProfile}\n                            onImageClick={(url, alt) => setFullSizeImage({ url, alt })}\n                          />\n                        )}\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n\n            {/* Loading indicator */}\n            {loading && (\n              <div className=\"text-center py-4\">\n                <div className=\"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-gray-900\"></div>\n                <span className=\"ml-2 text-gray-600\">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</span>\n              </div>\n            )}\n\n            {/* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –∫—ñ–Ω–µ—Ü—å —Å–ø–∏—Å–∫—É */}\n            {!loadingTop && !hasMore && emails.length > 10 && (\n              <div className=\"text-center py-4\">\n                <span className=\"text-gray-500 text-sm\">üìÑ –ë—ñ–ª—å—à–µ –ª–∏—Å—Ç—ñ–≤ –Ω–µ–º–∞—î</span>\n              </div>\n            )}\n          </div>\n\n          {/* Compose area (–ø–æ–∫–∞–∑—É—î–º–æ –ª–∏—à–µ —è–∫—â–æ —î –ª–∏—Å—Ç–∏, —è–∫—ñ –º–æ–∂–Ω–∞ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏) */}\n          {(typeof lettersLeft === 'number' && lettersLeft > 0) && (\n            <div className=\"border-t p-3\">\n              {/* –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π –ø–µ—Ä–µ–≥–ª—è–¥ –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω—å */}\n              {(attachedPhotos.length > 0 || attachedVideos.length > 0) && (\n                <div className=\"flex flex-wrap gap-2 mb-2\">\n                  {attachedPhotos.map((p) => (\n                    <div key={`p-${p.idPhoto}`} className=\"relative w-14 h-14 rounded-md overflow-hidden border border-gray-200\">\n                      <img src={p.urls.urlPreview} alt={`–§–æ—Ç–æ ${p.idPhoto}`} className=\"w-full h-full object-cover\" />\n                      <button\n                        onClick={() => setAttachedPhotos(prev => prev.filter(x => x.idPhoto !== p.idPhoto))}\n                        className=\"absolute -top-1 -right-1 bg-white/90 border border-gray-300 rounded-full w-5 h-5 text-[10px] flex items-center justify-center shadow\"\n                        title=\"–ü—Ä–∏–±—Ä–∞—Ç–∏ —Ñ–æ—Ç–æ\"\n                      >\n                        ‚úï\n                      </button>\n                    </div>\n                  ))}\n                  {attachedVideos.map((v) => (\n                    <div key={`v-${v.idVideo}`} className=\"relative w-14 h-14 rounded-md overflow-hidden border border-gray-200\">\n                      <img src={v.urls.urlThumbnail} alt={`–í—ñ–¥–µ–æ ${v.idVideo}`} className=\"w-full h-full object-cover\" />\n                      <span className=\"absolute bottom-0 right-0 m-0.5 text-[10px] px-1 py-0.5 rounded bg-black/60 text-white\">‚ñ∂</span>\n                      <button\n                        onClick={() => setAttachedVideos(prev => prev.filter(x => x.idVideo !== v.idVideo))}\n                        className=\"absolute -top-1 -right-1 bg-white/90 border border-gray-300 rounded-full w-5 h-5 text-[10px] flex items-center justify-center shadow\"\n                        title=\"–ü—Ä–∏–±—Ä–∞—Ç–∏ –≤—ñ–¥–µ–æ\"\n                      >\n                        ‚úï\n                      </button>\n                    </div>\n                  ))}\n                </div>\n              )}\n\n              <div className=\"flex items-center gap-2\">\n                {/* –ö–Ω–æ–ø–∫–∞ –∞—Ç–∞—á–º–µ–Ω—Ç—É –ø–æ—Ä—É—á –∑ —ñ–Ω–ø—É—Ç–æ–º */}\n                <button\n                  onClick={() => setIsAttachGalleryOpen(true)}\n                  className=\"flex-shrink-0 p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors\"\n                  title=\"–ü—Ä–∏–∫—Ä—ñ–ø–∏—Ç–∏ –º–µ–¥—ñ–∞\"\n                >\n                  <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\" />\n                  </svg>\n                </button>\n\n                {/* –Ü–Ω–ø—É—Ç –¥–ª—è —Ç–µ–∫—Å—Ç—É –ª–∏—Å—Ç–∞ */}\n                <div className=\"flex-1 relative\">\n                  <textarea\n                    className=\"w-full border border-gray-300 rounded-lg px-3 py-2 pr-12 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none\"\n                    placeholder=\"–ù–∞–ø–∏—à—ñ—Ç—å –ª–∏—Å—Ç... (300‚Äì3000 —Å–∏–º–≤–æ–ª—ñ–≤)\"\n                    value={composeText}\n                    onChange={(e) => setComposeText(e.target.value)}\n                    rows={3}\n                    maxLength={3000}\n                  />\n                  {/* –ö–Ω–æ–ø–∫–∞ –µ–º–æ–¥–∑—ñ */}\n                  <div className=\"absolute right-2 top-2\">\n                    <button\n                      type=\"button\"\n                      onClick={() => setIsEmailEmojiPickerOpen(!isEmailEmojiPickerOpen)}\n                      className=\"text-gray-400 hover:text-gray-600 p-1 rounded transition-colors\"\n                      title=\"–î–æ–¥–∞—Ç–∏ –µ–º–æ–¥–∑—ñ\"\n                    >\n                      üòÄ\n                    </button>\n                    {/* EmojiPicker */}\n                    <EmojiPicker\n                      isOpen={isEmailEmojiPickerOpen}\n                      onEmojiSelect={handleEmailEmojiSelect}\n                      onClose={() => setIsEmailEmojiPickerOpen(false)}\n                    />\n                  </div>\n                  <div className=\"text-xs mt-1 flex items-center justify-between\">\n                    <span className={`${composeText.trim().length < 300 ? 'text-red-600' : composeText.trim().length > 3000 ? 'text-red-600' : 'text-gray-500'}`}>\n                      –°–∏–º–≤–æ–ª—ñ–≤: {composeText.trim().length}/3000\n                    </span>\n                    <span className=\"text-gray-400\">–ú—ñ–Ω—ñ–º—É–º 300</span>\n                  </div>\n                </div>\n                \n                {/* –ö–Ω–æ–ø–∫–∞ –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ */}\n                <button\n                  onClick={async () => {\n                    const text = composeText.trim();\n                    if (text.length < 300 || text.length > 3000) return;\n                    const photos = attachedPhotos.slice(0, 10).map(p => p.idPhoto);\n                    const videos = attachedVideos.slice(0, 10).map(v => v.idVideo);\n                    try {\n                      const resp = await apiPost<{ success: boolean; data?: any; error?: string }>(\n                        '/api/chats/send-letter',\n                        { profileId: parseInt(profileId), idUserTo: parseInt(clientId), content: text, photoIds: photos, videoIds: videos }\n                      );\n                      if (resp.success) {\n                        // –û–ø—Ç–∏–º—ñ—Å—Ç–∏—á–Ω–µ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –ª–∏—Å—Ç–∞ –≤ —ñ—Å—Ç–æ—Ä—ñ—é\n                        const escapeHtml = (s: string) => s\n                          .replace(/&/g, '&amp;')\n                          .replace(/</g, '&lt;')\n                          .replace(/>/g, '&gt;')\n                          .replace(/\"/g, '&quot;')\n                          .replace(/'/g, '&#39;');\n                        const contentHtml = escapeHtml(text).replace(/\\n/g, '<br/>');\n                        const imageAttachments = attachedPhotos.slice(0, 10).map(p => ({\n                          id: `p-${p.idPhoto}`,\n                          url_thumbnail: p.urls.urlPreview,\n                          url_original: p.urls.urlOriginal,\n                          is_paid: false,\n                          display_attributes: []\n                        }));\n                        const optimisticEmail: EmailMessage = {\n                          id: `temp-${Date.now()}`,\n                          id_user_from: profileId,\n                          id_user_to: clientId,\n                          title: '',\n                          content: contentHtml,\n                          date_created: new Date().toISOString(),\n                          status: 'unread',\n                          attachments: imageAttachments.length ? { images: imageAttachments } : undefined,\n                          is_paid: false\n                        };\n                        setEmails(prev => [...prev, optimisticEmail]);\n                        // –ü—Ä–æ–∫—Ä—É—á—É—î–º–æ –≤–Ω–∏–∑ –¥–æ —â–æ–π–Ω–æ –¥–æ–¥–∞–Ω–æ–≥–æ –ª–∏—Å—Ç–∞\n                        setTimeout(() => {\n                          const container = messagesContainerRef.current;\n                          if (container) container.scrollTop = container.scrollHeight;\n                        }, 0);\n                        setComposeText('');\n                        setAttachedPhotos([]);\n                        setAttachedVideos([]);\n                        showToast({ title: '–õ–∏—Å—Ç –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ', message: '–í–∞—à –ª–∏—Å—Ç —É—Å–ø—ñ—à–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ', type: 'success' });\n                        // –°–ø–æ–≤—ñ—â–∞—î–º–æ —Å–ø–∏—Å–æ–∫ ¬´–í—Ö—ñ–¥–Ω—ñ¬ª, —â–æ–± –ø—Ä–∏–±—Ä–∞—Ç–∏ email-–∞–π—Ç–µ–º\n                        try {\n                          window.dispatchEvent(new CustomEvent('dialog:sent', { detail: { profileId: parseInt(profileId), clientId: parseInt(clientId), kind: 'email' } }));\n                        } catch {}\n                      } else {\n                        console.error('‚ùå Send letter failed:', resp.error);\n                        showToast({ title: '–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏', message: resp.error || '–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞', type: 'error' });\n                      }\n                    } catch (e: any) {\n                      console.error('‚ùå Send letter error:', e);\n                      showToast({ title: '–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏', message: e?.message || '–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞', type: 'error' });\n                    }\n                  }}\n                  disabled={composeText.trim().length < 300 || composeText.trim().length > 3000}\n                  className=\"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors disabled:bg-gray-300\"\n                >\n                  –ù–∞–¥—ñ—Å–ª–∞—Ç–∏\n                </button>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* –ü–æ–≤–Ω–æ–µ–∫—Ä–∞–Ω–Ω–∏–π –º–æ–¥–∞–ª –¥–ª—è –∑–æ–±—Ä–∞–∂–µ–Ω—å */}\n      {fullSizeImage && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50\" onClick={() => setFullSizeImage(null)}>\n          <div className=\"relative max-w-full max-h-full p-4\">\n            <img \n              src={fullSizeImage.url} \n              alt={fullSizeImage.alt}\n              className=\"max-w-full max-h-full object-contain\"\n              onClick={(e) => e.stopPropagation()}\n            />\n            <button\n              onClick={() => setFullSizeImage(null)}\n              className=\"absolute top-4 right-4 text-white hover:text-gray-300 transition-colors\"\n            >\n              <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n              </svg>\n            </button>\n          </div>\n        </div>\n      )}\n      {/* –ì–∞–ª–µ—Ä–µ—è –¥–ª—è –ø—Ä–∏–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è –¥–æ –ª–∏—Å—Ç–∞ */}\n      <MediaGallery\n        profileId={profileId}\n        isOpen={isAttachGalleryOpen}\n        onClose={() => setIsAttachGalleryOpen(false)}\n        onPhotoSelect={() => {}}\n        maxSelection={10}\n        context=\"chat\"\n        idRegularUser={parseInt(clientId)}\n        mode=\"attach\"\n        actionLabel=\"–ü—Ä–∏–∫—Ä—ñ–ø–∏—Ç–∏\"\n        allowAudio={false}\n        allowedPhotoTabs={emailAllowedPhotoTabs as Array<'regular' | 'special' | 'special_plus' | 'temporary'>}\n        isSpecialPlusAllowed={!forbiddenTags.includes('special_plus')}\n        onAttach={({ photos, videos }) => {\n          setAttachedPhotos(photos);\n          setAttachedVideos(videos);\n          setIsAttachGalleryOpen(false);\n        }}\n      />\n    </React.Fragment>\n  );\n}","/**\n * –£—Ç–∏–ª—ñ—Ç–∏ –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è memory leaks –≤ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö\n */\n\n// –¢–∏–ø –¥–ª—è cleanup —Ñ—É–Ω–∫—Ü—ñ–π\ntype CleanupFunction = () => void;\n\n// –ö–ª–∞—Å –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å–∞–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞\nexport class ComponentResourceManager {\n  private timeouts: Set<NodeJS.Timeout> = new Set();\n  private intervals: Set<NodeJS.Timeout> = new Set();\n  private eventListeners: Array<{\n    element: EventTarget;\n    event: string;\n    handler: EventListener;\n    options?: boolean | AddEventListenerOptions;\n  }> = [];\n  private abortControllers: Set<AbortController> = new Set();\n  private cleanupFunctions: Set<CleanupFunction> = new Set();\n\n  /**\n   * –°—Ç–≤–æ—Ä—é—î timeout –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º cleanup\n   */\n  setTimeout(callback: () => void, delay: number): NodeJS.Timeout {\n    const timeoutId = setTimeout(() => {\n      this.timeouts.delete(timeoutId);\n      callback();\n    }, delay);\n    \n    this.timeouts.add(timeoutId);\n    return timeoutId;\n  }\n\n  /**\n   * –°—Ç–≤–æ—Ä—é—î interval –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º cleanup\n   */\n  setInterval(callback: () => void, delay: number): NodeJS.Timeout {\n    const intervalId = setInterval(callback, delay);\n    this.intervals.add(intervalId);\n    return intervalId;\n  }\n\n  /**\n   * –î–æ–¥–∞—î event listener –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º cleanup\n   */\n  addEventListener<K extends keyof WindowEventMap>(\n    element: Window,\n    type: K,\n    listener: (this: Window, ev: WindowEventMap[K]) => any,\n    options?: boolean | AddEventListenerOptions\n  ): void;\n  addEventListener<K extends keyof DocumentEventMap>(\n    element: Document,\n    type: K,\n    listener: (this: Document, ev: DocumentEventMap[K]) => any,\n    options?: boolean | AddEventListenerOptions\n  ): void;\n  addEventListener<K extends keyof HTMLElementEventMap>(\n    element: HTMLElement,\n    type: K,\n    listener: (this: HTMLElement, ev: HTMLElementEventMap[K]) => any,\n    options?: boolean | AddEventListenerOptions\n  ): void;\n  addEventListener(\n    element: EventTarget,\n    event: string,\n    handler: EventListener,\n    options?: boolean | AddEventListenerOptions\n  ): void {\n    element.addEventListener(event, handler, options);\n    this.eventListeners.push({ element, event, handler, options });\n  }\n\n  /**\n   * –°—Ç–≤–æ—Ä—é—î AbortController –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º cleanup\n   */\n  createAbortController(): AbortController {\n    const controller = new AbortController();\n    this.abortControllers.add(controller);\n    return controller;\n  }\n\n  /**\n   * –î–æ–¥–∞—î –∫–∞—Å—Ç–æ–º–Ω—É cleanup —Ñ—É–Ω–∫—Ü—ñ—é\n   */\n  addCleanup(cleanupFn: CleanupFunction): void {\n    this.cleanupFunctions.add(cleanupFn);\n  }\n\n  /**\n   * –í–∏–¥–∞–ª—è—î –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π timeout\n   */\n  clearTimeout(timeoutId: NodeJS.Timeout): void {\n    if (this.timeouts.has(timeoutId)) {\n      clearTimeout(timeoutId);\n      this.timeouts.delete(timeoutId);\n    }\n  }\n\n  /**\n   * –í–∏–¥–∞–ª—è—î –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π interval\n   */\n  clearInterval(intervalId: NodeJS.Timeout): void {\n    if (this.intervals.has(intervalId)) {\n      clearInterval(intervalId);\n      this.intervals.delete(intervalId);\n    }\n  }\n\n  /**\n   * –û—á–∏—â–∞—î –≤—Å—ñ —Ä–µ—Å—É—Ä—Å–∏\n   */\n  cleanup(): void {\n    console.log('üßπ ComponentResourceManager: Cleaning up all resources...');\n\n    // –û—á–∏—â—É—î–º–æ timeouts\n    this.timeouts.forEach(timeoutId => {\n      try {\n        clearTimeout(timeoutId);\n      } catch (error) {\n        console.warn('Error clearing timeout:', error);\n      }\n    });\n    this.timeouts.clear();\n\n    // –û—á–∏—â—É—î–º–æ intervals\n    this.intervals.forEach(intervalId => {\n      try {\n        clearInterval(intervalId);\n      } catch (error) {\n        console.warn('Error clearing interval:', error);\n      }\n    });\n    this.intervals.clear();\n\n    // –í–∏–¥–∞–ª—è—î–º–æ event listeners\n    this.eventListeners.forEach(({ element, event, handler, options }) => {\n      try {\n        element.removeEventListener(event, handler, options);\n      } catch (error) {\n        console.warn('Error removing event listener:', error);\n      }\n    });\n    this.eventListeners.length = 0;\n\n    // –°–∫–∞—Å–æ–≤—É—î–º–æ –≤—Å—ñ AbortControllers\n    this.abortControllers.forEach(controller => {\n      try {\n        if (!controller.signal.aborted) {\n          controller.abort();\n        }\n      } catch (error) {\n        console.warn('Error aborting controller:', error);\n      }\n    });\n    this.abortControllers.clear();\n\n    // –í–∏–∫–ª–∏–∫–∞—î–º–æ –∫–∞—Å—Ç–æ–º–Ω—ñ cleanup —Ñ—É–Ω–∫—Ü—ñ—ó\n    this.cleanupFunctions.forEach(cleanupFn => {\n      try {\n        cleanupFn();\n      } catch (error) {\n        console.warn('Error in custom cleanup function:', error);\n      }\n    });\n    this.cleanupFunctions.clear();\n\n    console.log('‚úÖ ComponentResourceManager: All resources cleaned up');\n  }\n\n  /**\n   * –û—Ç—Ä–∏–º—É—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Ä–µ—Å—É—Ä—Å—ñ–≤\n   */\n  getStats(): {\n    timeouts: number;\n    intervals: number;\n    eventListeners: number;\n    abortControllers: number;\n    cleanupFunctions: number;\n  } {\n    return {\n      timeouts: this.timeouts.size,\n      intervals: this.intervals.size,\n      eventListeners: this.eventListeners.length,\n      abortControllers: this.abortControllers.size,\n      cleanupFunctions: this.cleanupFunctions.size,\n    };\n  }\n}\n\n/**\n * React Hook –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å–∞–º–∏\n */\nimport { useEffect, useRef } from 'react';\n\nexport function useResourceManager(): ComponentResourceManager {\n  const managerRef = useRef<ComponentResourceManager>();\n\n  if (!managerRef.current) {\n    managerRef.current = new ComponentResourceManager();\n  }\n\n  useEffect(() => {\n    const manager = managerRef.current!;\n    \n    return () => {\n      manager.cleanup();\n    };\n  }, []);\n\n  return managerRef.current;\n}\n\n/**\n * Hook –¥–ª—è –±–µ–∑–ø–µ—á–Ω–æ–≥–æ setTimeout –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º cleanup\n */\nexport function useSafeTimeout(): (callback: () => void, delay: number) => NodeJS.Timeout {\n  const manager = useResourceManager();\n  \n  return (callback: () => void, delay: number) => {\n    return manager.setTimeout(callback, delay);\n  };\n}\n\n/**\n * Hook –¥–ª—è –±–µ–∑–ø–µ—á–Ω–æ–≥–æ setInterval –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º cleanup\n */\nexport function useSafeInterval(): (callback: () => void, delay: number) => NodeJS.Timeout {\n  const manager = useResourceManager();\n  \n  return (callback: () => void, delay: number) => {\n    return manager.setInterval(callback, delay);\n  };\n}\n\n/**\n * Hook –¥–ª—è –±–µ–∑–ø–µ—á–Ω–æ–≥–æ addEventListener –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º cleanup\n */\nexport function useSafeEventListener(): ComponentResourceManager['addEventListener'] {\n  const manager = useResourceManager();\n  \n  return manager.addEventListener.bind(manager);\n}\n\n/**\n * Hook –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è AbortController –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º cleanup\n */\nexport function useSafeAbortController(): () => AbortController {\n  const manager = useResourceManager();\n  \n  return () => manager.createAbortController();\n}\n\n/**\n * –£—Ç–∏–ª—ñ—Ç–∞ –¥–ª—è –æ—á–∏—â–µ–Ω–Ω—è Lottie –∞–Ω—ñ–º–∞—Ü—ñ–π\n */\nexport function cleanupLottieAnimations(): void {\n  if (typeof window === 'undefined') return;\n\n  console.log('üßπ Cleaning up Lottie animations...');\n  \n  if (window.activeLottieInstances) {\n    window.activeLottieInstances.forEach((animation, key) => {\n      try {\n        if (animation && typeof animation.destroy === 'function') {\n          animation.destroy();\n          console.log(`‚úÖ Destroyed Lottie animation: ${key}`);\n        }\n        \n        // –í–∏–¥–∞–ª—è—î–º–æ event listeners\n        if (animation && typeof animation.removeEventListener === 'function') {\n          ['data_ready', 'error', 'complete', 'loopComplete', 'enterFrame'].forEach(event => {\n            try {\n              animation.removeEventListener(event);\n            } catch (e) {\n              // –Ü–≥–Ω–æ—Ä—É—î–º–æ –ø–æ–º–∏–ª–∫–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—è listeners\n            }\n          });\n        }\n      } catch (error) {\n        console.warn(`‚ö†Ô∏è Error destroying Lottie animation ${key}:`, error);\n      }\n    });\n    window.activeLottieInstances.clear();\n  }\n  \n  // –û—á–∏—â—É—î–º–æ DOM –µ–ª–µ–º–µ–Ω—Ç–∏ –∑ Lottie\n  if (typeof document !== 'undefined') {\n    const lottieContainers = document.querySelectorAll('[data-lottie-url]');\n    lottieContainers.forEach(container => {\n      if (container instanceof HTMLElement) {\n        container.innerHTML = '';\n        // –í–∏–¥–∞–ª—è—î–º–æ data –∞—Ç—Ä–∏–±—É—Ç–∏\n        container.removeAttribute('data-lottie-url');\n      }\n    });\n  }\n}\n\n/**\n * –£—Ç–∏–ª—ñ—Ç–∞ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ memory leaks –≤ development —Ä–µ–∂–∏–º—ñ\n */\nexport function detectMemoryLeaks(): void {\n  if (process.env.NODE_ENV !== 'development') return;\n\n  const checkLeaks = () => {\n    const stats = {\n      lottieInstances: window.activeLottieInstances?.size || 0,\n      eventListeners: 0, // –°–∫–ª–∞–¥–Ω–æ —Ç–æ—á–Ω–æ –ø—ñ–¥—Ä–∞—Ö—É–≤–∞—Ç–∏\n      timers: 0, // –°–∫–ª–∞–¥–Ω–æ —Ç–æ—á–Ω–æ –ø—ñ–¥—Ä–∞—Ö—É–≤–∞—Ç–∏\n    };\n\n    console.log('üîç Memory leak detection:', stats);\n\n    if (stats.lottieInstances > 10) {\n      console.warn('‚ö†Ô∏è Potential memory leak: Too many Lottie instances:', stats.lottieInstances);\n    }\n  };\n\n  // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –∫–æ–∂–Ω—ñ 30 —Å–µ–∫—É–Ω–¥ –≤ development\n  setInterval(checkLeaks, 30000);\n}\n\n/**\n * –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è memory leak detection\n */\nif (typeof window !== 'undefined' && process.env.NODE_ENV === 'development') {\n  // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ –≥–ª–æ–±–∞–ª—å–Ω–∏–π Map –¥–ª—è Lottie —è–∫—â–æ –π–æ–≥–æ –Ω–µ–º–∞—î\n  if (!window.activeLottieInstances) {\n    window.activeLottieInstances = new Map();\n  }\n  \n  // –ó–∞–ø—É—Å–∫–∞—î–º–æ –¥–µ—Ç–µ–∫—Ü—ñ—é memory leaks\n  detectMemoryLeaks();\n}\n","/**\n * –£—Ç–∏–ª—ñ—Ç–∏ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ gRPC-Web –∑–∞–ø–∏—Ç–∞–º–∏ –¥–æ TalkTimes API\n */\n\n/**\n * –ö–æ–¥—É—î —á–∏—Å–ª–æ —É varint —Ñ–æ—Ä–º–∞—Ç (protobuf)\n */\nexport function encodeVarint(value: number): Uint8Array {\n  const bytes: number[] = [];\n  \n  while (value >= 0x80) {\n    bytes.push((value & 0xFF) | 0x80);\n    value >>>= 7;\n  }\n  bytes.push(value & 0xFF);\n  \n  return new Uint8Array(bytes);\n}\n\n/**\n * –î–µ–∫–æ–¥—É—î varint –∑ –±–∞–π—Ç–æ–≤–æ–≥–æ –º–∞—Å–∏–≤—É\n */\nexport function decodeVarint(bytes: Uint8Array, offset = 0): { value: number; bytesRead: number } {\n  let value = 0;\n  let shift = 0;\n  let bytesRead = 0;\n  \n  for (let i = offset; i < bytes.length; i++) {\n    const byte = bytes[i];\n    bytesRead++;\n    \n    value |= (byte & 0x7F) << shift;\n    \n    if ((byte & 0x80) === 0) {\n      break;\n    }\n    \n    shift += 7;\n  }\n  \n  return { value, bytesRead };\n}\n\n/**\n * –°—Ç–≤–æ—Ä—é—î gRPC-Web body –¥–ª—è GetRestrictions –∑–∞–ø–∏—Ç—É\n */\nexport function createGetRestrictionsBody(idInterlocutor: number): Uint8Array {\n  const varintBytes = encodeVarint(idInterlocutor);\n  const payload = new Uint8Array(1 + varintBytes.length);\n  \n  // Protobuf —Ç–µ–≥ 0x08 (field 1, varint)\n  payload[0] = 0x08;\n  payload.set(varintBytes, 1);\n  \n  // gRPC –∑–∞–≥–æ–ª–æ–≤–æ–∫ (5 –±–∞–π—Ç: 4 –±–∞–π—Ç–∏ –Ω—É–ª—ñ–≤ + —Ä–æ–∑–º—ñ—Ä payload)\n  const result = new Uint8Array(5 + payload.length);\n  result[4] = payload.length; // –†–æ–∑–º—ñ—Ä payload\n  result.set(payload, 5);\n  \n  return result;\n}\n\n/**\n * –ü–∞—Ä—Å–∏—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å –≤—ñ–¥ GetRestrictions API\n */\nexport function parseGetRestrictionsResponse(response: ArrayBuffer): {\n  hasExclusivePosts: boolean;\n  categories: string[];\n  rawData: Uint8Array;\n} {\n  const bytes = new Uint8Array(response);\n  \n  // –ü—Ä–æ–ø—É—Å–∫–∞—î–º–æ gRPC –∑–∞–≥–æ–ª–æ–≤–æ–∫ (–ø–µ—Ä—à—ñ 5 –±–∞–π—Ç)\n  let offset = 5;\n  \n  const result = {\n    hasExclusivePosts: false,\n    categories: [] as string[],\n    rawData: bytes\n  };\n  \n  // –ü–∞—Ä—Å–∏–º–æ protobuf –ø–æ–ª—è\n  while (offset < bytes.length - 20) { // –ó–∞–ª–∏—à–∞—î–º–æ –º—ñ—Å—Ü–µ –¥–ª—è grpc-status\n    if (offset >= bytes.length) break;\n    \n    const tag = bytes[offset];\n    \n    if (tag === 0x08) {\n      // VARINT –ø–æ–ª–µ - –ø—Ä–∞–ø–æ—Ä–µ—Ü—å exclusive posts\n      const { value } = decodeVarint(bytes, offset + 1);\n      result.hasExclusivePosts = value === 1;\n      offset += 2; // –¢–µ–≥ + 1 –±–∞–π—Ç –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ varint\n      \n    } else if (tag === 0x12 || tag === 0x1a || tag === 0x22 || tag === 0x2a) {\n      // STRING –ø–æ–ª—è - –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó\n      if (offset + 1 >= bytes.length) break;\n      \n      const length = bytes[offset + 1];\n      if (offset + 2 + length > bytes.length) break;\n      \n      const categoryBytes = bytes.slice(offset + 2, offset + 2 + length);\n      const category = new TextDecoder().decode(categoryBytes);\n      \n      if (category && !result.categories.includes(category)) {\n        result.categories.push(category);\n      }\n      \n      offset += 2 + length;\n      \n    } else {\n      offset++;\n    }\n  }\n  \n  return result;\n}\n\n/**\n * –í—ñ–¥–ø—Ä–∞–≤–ª—è—î –∑–∞–ø–∏—Ç –¥–æ –Ω–∞—à–æ–≥–æ –±–µ–∫–µ–Ω–¥—É –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ TalkTimes restrictions\n */\nexport async function checkDialogRestrictions(profileId: number, idInterlocutor: number): Promise<{\n  hasExclusivePosts: boolean;\n  categories: string[];\n  categoryCounts?: Record<string, number>;\n  tier?: 'special' | 'specialplus';\n  success: boolean;\n  error?: string;\n}> {\n  try {\n    // –Ü–º–ø–æ—Ä—Ç—É—î–º–æ apiPost –¥–∏–Ω–∞–º—ñ—á–Ω–æ —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ —Ü–∏–∫–ª—ñ—á–Ω–∏—Ö –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π\n    const { apiPost } = await import('@/lib/api');\n    \n    const result = await apiPost<{\n      hasExclusivePosts?: boolean;\n      categories?: string[];\n      categoryCounts?: Record<string, number>;\n      tier?: 'special' | 'specialplus';\n      success?: boolean;\n      error?: string;\n    }>('/api/chats/tt-restrictions', { profileId, idInterlocutor });\n    \n    return {\n      hasExclusivePosts: result.hasExclusivePosts || false,\n      categories: result.categories || [],\n      categoryCounts: result.categoryCounts,\n      tier: result.tier,\n      success: result.success !== false, // true —è–∫—â–æ –Ω–µ false\n      error: result.error\n    };\n    \n  } catch (error) {\n    console.error('‚ùå Error checking dialog restrictions:', error);\n    return {\n      hasExclusivePosts: false,\n      categories: [],\n      success: false,\n      error: error instanceof Error ? error.message : 'Unknown error'\n    };\n  }\n}\n\n/**\n * –õ–æ–≥—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –æ–±–º–µ–∂–µ–Ω—å —É –∫–æ–Ω—Å–æ–ª—å\n */\nexport function logRestrictionsCheck(\n  idInterlocutor: number,\n  result: { hasExclusivePosts: boolean; categories: string[]; success: boolean; error?: string }\n) {\n  const timestamp = new Date().toLocaleTimeString();\n  \n  if (!result.success) {\n    console.log(`üö´ [${timestamp}] TalkTimes Restrictions Check FAILED for user ${idInterlocutor}:`);\n    console.log(`   Error: ${result.error}`);\n    return;\n  }\n  \n  console.log(`‚úÖ [${timestamp}] TalkTimes Restrictions Check SUCCESS for user ${idInterlocutor}:`);\n  console.log(`   üé™ Exclusive Posts: ${result.hasExclusivePosts ? '‚ö° ENABLED' : '‚ùå DISABLED'}`);\n  console.log(`   üìã Categories: [${result.categories.join(', ')}]`);\n  \n  if (result.hasExclusivePosts) {\n    console.log(`   üéØ This dialog supports EXCLUSIVE POSTS! Lightning icon will be shown.`);\n  }\n}\n","\"use client\";\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { apiGet, apiPost } from '@/lib/api';\n\ninterface PersonalInfo {\n  avatar_xl?: string;\n  age?: number;\n  date_birth?: string;\n  city?: string;\n  country?: string;\n  count_children?: number;\n  color_hair?: string;\n  color_eye?: string;\n  body_type?: string;\n  description?: string;\n  drinking?: number;\n  education?: string;\n  level_of_english?: string;\n  gender?: string;\n  height?: number;\n  looking_for?: string;\n  marital_status?: string;\n  name?: string;\n  occupation?: string;\n  other_langs?: string;\n  religion?: string;\n  smoking?: number;\n  weight?: number;\n  goal?: string[];\n  traits?: string[];\n  hobbies?: string[];\n  mood?: string;\n  language?: string;\n  field_of_work?: string;\n  other_languages?: string[];\n}\n\ninterface Preferences {\n  age_from?: number;\n  age_to?: number;\n  pref_personality_type?: string | null;\n  gender?: string;\n}\n\ninterface ProfileResponse {\n  profileData?: {\n    personal?: PersonalInfo;\n    preferences?: Preferences;\n    is_online?: boolean;\n    last_visit?: string;\n    date_created?: string;\n  };\n}\n\ninterface PhotoItem {\n  id: number;\n  id_media: number;\n  id_image: number;\n  url_xs?: string;\n  url_small?: string;\n  url_medium?: string;\n  url_large?: string;\n  url_xl?: string;\n  url_xxl?: string;\n  url_standart?: string; // sic: —Ç–∞–∫ —É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ\n  url_original?: string;\n  is_hidden?: boolean;\n  is_main?: number;\n  isMain?: number;\n}\n\ninterface PhotosResponse {\n  data?: {\n    public?: PhotoItem[];\n    private?: PhotoItem[];\n    [key: string]: any;\n  };\n}\n\nexport function ClientPublicProfileModal({\n  isOpen,\n  onClose,\n  profileId,\n  clientId\n}: {\n  isOpen: boolean;\n  onClose: () => void;\n  profileId: string;\n  clientId: number;\n}) {\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [personal, setPersonal] = useState<PersonalInfo | null>(null);\n  const [preferences, setPreferences] = useState<Preferences | null>(null);\n  const [isOnline, setIsOnline] = useState<boolean | undefined>();\n  const [lastVisit, setLastVisit] = useState<string | undefined>();\n  const [dateCreated, setDateCreated] = useState<string | undefined>();\n  const [photosPublic, setPhotosPublic] = useState<PhotoItem[]>([]);\n  const [photosPrivate, setPhotosPrivate] = useState<PhotoItem[]>([]);\n  const [mainPhoto, setMainPhoto] = useState<PhotoItem | null>(null);\n  const [fullImage, setFullImage] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!isOpen) return;\n    let cancelled = false;\n    (async () => {\n      setLoading(true); setError(null);\n      try {\n        // –ü—É–±–ª—ñ—á–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å –∫–ª—ñ—î–Ω—Ç–∞\n        const clientPublic = await apiGet<{ success: boolean; profile?: any }>(`/profiles/${profileId}/client/${clientId}/public`);\n        const pr = clientPublic.profile?.personal ? clientPublic.profile : undefined;\n        if (pr && !cancelled) {\n          setPersonal(pr.personal || null);\n          setPreferences(pr.preferences || null);\n          setIsOnline(pr.is_online);\n          setLastVisit(pr.last_visit);\n          setDateCreated(pr.date_created);\n        }\n        const photos = await apiPost<PhotosResponse>(`/profiles/${profileId}/client/${clientId}/photos`, {});\n        const data = photos?.data || (photos as any);\n        const publicPhotos = (data?.public || []).filter((x: PhotoItem) => !x.is_hidden);\n        const privatePhotos = (data?.private || []).filter((x: PhotoItem) => !x.is_hidden);\n        if (!cancelled) {\n          setPhotosPublic(publicPhotos);\n          setPhotosPrivate(privatePhotos);\n          const main = [...publicPhotos, ...privatePhotos].find(x => (x.isMain === 1) || (x.is_main === 1));\n          setMainPhoto(main || null);\n        }\n      } catch (e: any) {\n        if (!cancelled) setError(e?.message || '–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é');\n      } finally {\n        if (!cancelled) setLoading(false);\n      }\n    })();\n    return () => { cancelled = true; };\n  }, [isOpen, profileId, clientId]);\n\n  const publicShown = useMemo(() => photosPublic, [photosPublic]);\n  const privateShown = useMemo(() => photosPrivate, [photosPrivate]);\n\n  if (!isOpen) return null;\n\n  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —á–∞—Å—É –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –≤—ñ–∑–∏—Ç—É\n  const formatLastVisit = (lastVisitDate: string | undefined) => {\n    if (!lastVisitDate) return '–æ—Ñ–ª–∞–π–Ω';\n\n    try {\n      const now = new Date();\n      const lastVisit = new Date(lastVisitDate);\n      const diffMs = now.getTime() - lastVisit.getTime();\n      const diffMinutes = Math.floor(diffMs / (1000 * 60));\n      const diffHours = Math.floor(diffMs / (1000 * 60 * 60));\n      const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\n      const diffWeeks = Math.floor(diffDays / 7);\n\n      if (diffMinutes < 60) {\n        if (diffMinutes < 1) return '—â–æ–π–Ω–æ';\n        if (diffMinutes === 1) return '—Ö–≤–∏–ª–∏–Ω—É —Ç–æ–º—É';\n        if (diffMinutes < 5) return `${diffMinutes} —Ö–≤–∏–ª–∏–Ω–∏ —Ç–æ–º—É`;\n        return `${diffMinutes} —Ö–≤–∏–ª–∏–Ω —Ç–æ–º—É`;\n      }\n\n      if (diffHours < 24) {\n        if (diffHours === 1) return '–≥–æ–¥–∏–Ω—É —Ç–æ–º—É';\n        if (diffHours < 5) return `${diffHours} –≥–æ–¥–∏–Ω–∏ —Ç–æ–º—É`;\n        return `${diffHours} –≥–æ–¥–∏–Ω —Ç–æ–º—É`;\n      }\n\n      if (diffDays < 7) {\n        if (diffDays === 1) return '–¥–µ–Ω—å —Ç–æ–º—É';\n        return `${diffDays} –¥–Ω—ñ —Ç–æ–º—É`;\n      }\n\n      if (diffWeeks === 1) return '—Ç–∏–∂–¥–µ–Ω—å —Ç–æ–º—É';\n      if (diffWeeks < 4) return `${diffWeeks} —Ç–∏–∂–Ω—ñ —Ç–æ–º—É`;\n\n      return '–º—ñ—Å—è—Ü—å —Ç–æ–º—É';\n    } catch {\n      return '–æ—Ñ–ª–∞–π–Ω';\n    }\n  };\n\n  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ç–∏–ª—ñ–≤ –Ω–∞—Å—Ç—Ä–æ—é\n  const getMoodStyles = (mood: string | null | undefined) => {\n    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –Ω–∞ null/undefined\n    if (!mood || typeof mood !== 'string') {\n      return {\n        iconColor: 'text-gray-600',\n        textColor: 'text-gray-600',\n        displayName: '–ù–µ–≤—ñ–¥–æ–º–æ',\n        icon: (\n          <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n            <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z\" clipRule=\"evenodd\" />\n          </svg>\n        )\n      };\n    }\n\n    switch (mood.toLowerCase()) {\n      case 'real_love':\n        return {\n          iconColor: 'text-red-600',\n          textColor: 'text-red-600',\n          displayName: '–õ—é–±–æ–≤',\n          icon: (\n            <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path fillRule=\"evenodd\" d=\"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z\" clipRule=\"evenodd\" />\n            </svg>\n          )\n        };\n      case 'friendship':\n        return {\n          iconColor: 'text-blue-600',\n          textColor: 'text-blue-600',\n          displayName: '–î—Ä—É–∂–±–∞',\n          icon: (\n            <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path d=\"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z\" />\n            </svg>\n          )\n        };\n      case 'hot_talks':\n        return {\n          iconColor: 'text-pink-600',\n          textColor: 'text-pink-600',\n          displayName: '–Ü–Ω—Ç–∏–º',\n          icon: (\n            <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path d=\"M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0112.12 15.12z\" />\n            </svg>\n          )\n        };\n      default:\n        return {\n          iconColor: 'text-gray-600',\n          textColor: 'text-gray-600',\n          displayName: mood,\n          icon: (\n            <svg className=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n              <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z\" clipRule=\"evenodd\" />\n            </svg>\n          )\n        };\n    }\n  };\n\n  // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∑–Ω–∞–∫—É –∑–æ–¥—ñ–∞–∫—É\n  const getZodiacSign = (dateString: string) => {\n    try {\n      const date = new Date(dateString);\n      const month = date.getMonth() + 1; // –ú—ñ—Å—è—Ü—ñ –≤—ñ–¥ 0 –¥–æ 11\n      const day = date.getDate();\n\n      const signs = [\n        { name: '–ö–æ–∑–æ—Ä—ñ–≥', start: [12, 22], end: [1, 19], icon: '‚ôë' },\n        { name: '–í–æ–¥–æ–ª—ñ–π', start: [1, 20], end: [2, 18], icon: '‚ôí' },\n        { name: '–†–∏–±–∏', start: [2, 19], end: [3, 20], icon: '‚ôì' },\n        { name: '–û–≤–µ–Ω', start: [3, 21], end: [4, 19], icon: '‚ôà' },\n        { name: '–¢–µ–ª–µ—Ü—å', start: [4, 20], end: [5, 20], icon: '‚ôâ' },\n        { name: '–ë–ª–∏–∑–Ω—é–∫–∏', start: [5, 21], end: [6, 20], icon: '‚ôä' },\n        { name: '–†–∞–∫', start: [6, 21], end: [7, 22], icon: '‚ôã' },\n        { name: '–õ–µ–≤', start: [7, 23], end: [8, 22], icon: '‚ôå' },\n        { name: '–î—ñ–≤–∞', start: [8, 23], end: [9, 22], icon: '‚ôç' },\n        { name: '–¢–µ—Ä–µ–∑–∏', start: [9, 23], end: [10, 22], icon: '‚ôé' },\n        { name: '–°–∫–æ—Ä–ø—ñ–æ–Ω', start: [10, 23], end: [11, 21], icon: '‚ôè' },\n        { name: '–°—Ç—Ä—ñ–ª–µ—Ü—å', start: [11, 22], end: [12, 21], icon: '‚ôê' }\n      ];\n\n      for (const sign of signs) {\n        const [startMonth, startDay] = sign.start;\n        const [endMonth, endDay] = sign.end;\n\n        if ((month === startMonth && day >= startDay) ||\n            (month === endMonth && day <= endDay) ||\n            (month > startMonth && month < endMonth) ||\n            (month === 12 && startMonth === 1) ||\n            (month === 1 && endMonth === 12)) {\n          return sign;\n        }\n      }\n\n      return { name: '–ù–µ–≤—ñ–¥–æ–º–∏–π', icon: '‚ùì' };\n    } catch {\n      return { name: '–ù–µ–≤—ñ–¥–æ–º–∏–π', icon: '‚ùì' };\n    }\n  };\n\n  const InfoRow = ({ label, value }: { label: string; value?: any }) => {\n    if (value === undefined || value === null || value === '' || (Array.isArray(value) && value.length === 0)) return null;\n    const val = Array.isArray(value) ? value.join(', ') : String(value);\n\n    // –î–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è HTML entities\n    const decodeHtmlEntities = (text: string) => {\n      const textarea = document.createElement('textarea');\n      textarea.innerHTML = text;\n      return textarea.value;\n    };\n\n    const decodedValue = decodeHtmlEntities(val);\n\n    return (\n      <div className=\"flex text-sm\">\n        <div className=\"w-[120px] text-gray-500 text-right\">{label}</div>\n        <div className=\"flex-1 text-gray-900 ml-2\">{decodedValue}</div>\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-[70] flex items-center justify-center\">\n      <div className=\"absolute inset-0 bg-black/50\" onClick={onClose} />\n      <div className=\"relative bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto custom-scroll\">\n\n        {loading ? (\n          <div className=\"p-6 text-sm text-gray-500\">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è‚Ä¶</div>\n        ) : error ? (\n          <div className=\"p-6 text-sm text-red-600\">{error}</div>\n        ) : (\n          <div className=\"p-6 grid grid-cols-2 gap-8\">\n            {/* –õ—ñ–≤–∞ –∫–æ–ª–æ–Ω–∫–∞ –∑ —Ñ–æ—Ç–æ */}\n            <div className=\"space-y-4\">\n              {mainPhoto && (\n                <div className=\"w-[350px] h-[400px]\">\n                  <img\n                    src={mainPhoto.url_standart || mainPhoto.url_xxl || mainPhoto.url_xl || mainPhoto.url_large || mainPhoto.url_medium || mainPhoto.url_small || mainPhoto.url_xs || personal?.avatar_xl || ''}\n                    alt=\"main\"\n                    className=\"w-full h-full object-cover rounded-lg cursor-zoom-in\"\n                    onClick={() => setFullImage(mainPhoto.url_original || '')}\n                  />\n                </div>\n              )}\n\n              <div className=\"flex flex-wrap gap-1\">\n                {/* –ü—É–±–ª—ñ—á–Ω—ñ —Ñ–æ—Ç–æ */}\n                {publicShown.map(p => (\n                  <img key={p.id}\n                    src={p.url_xl || p.url_large || p.url_medium || p.url_small || p.url_xs || ''}\n                    alt={`pub-${p.id}`}\n                    className=\"w-[80px] h-[80px] object-cover rounded cursor-zoom-in\"\n                    onClick={() => setFullImage(p.url_original || '')}\n                  />\n                ))}\n\n                {/* –ü—Ä–∏–≤–∞—Ç–Ω—ñ —Ñ–æ—Ç–æ */}\n                {privateShown.map(p => (\n                  <div key={p.id} className=\"relative\">\n                    <img\n                      src={p.url_xl || p.url_large || p.url_medium || p.url_small || p.url_xs || ''}\n                      alt={`priv-${p.id}`}\n                      className=\"w-[80px] h-[80px] object-cover rounded cursor-zoom-in hover:opacity-80 transition-opacity\"\n                      onClick={() => setFullImage(p.url_original || '')}\n                    />\n                    <div className=\"absolute bottom-1 right-1 bg-black/60 text-white text-xs px-1 py-0.5 rounded\">–ü—Ä–∏–≤–∞—Ç–Ω–µ</div>\n                  </div>\n                ))}\n              </div>\n            </div>\n\n            {/* –ü—Ä–∞–≤–∞ –∫–æ–ª–æ–Ω–∫–∞ –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é */}\n            <div className=\"space-y-2\">\n              {/* –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —ñ–º'—è —Ç–∞ –≤—ñ–∫ */}\n              <div className=\"flex items-center gap-3\">\n                {/* –Ü–∫–æ–Ω–∫–∞ –≥–µ–Ω–¥–µ—Ä—É */}\n                {personal?.gender && (\n                  <div className=\"flex-shrink-0\">\n                    {personal.gender === 'male' ? (\n                      <svg className=\"w-6 h-6 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\n                      </svg>\n                    ) : personal.gender === 'female' ? (\n                      <svg className=\"w-6 h-6 text-pink-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z\" />\n                      </svg>\n                    ) : (\n                      <svg className=\"w-6 h-6 text-gray-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\n                      </svg>\n                    )}\n                  </div>\n                )}\n                <div className=\"text-xl font-bold text-gray-900\">\n                  {personal?.name ? `${personal.name}${personal?.age ? `, ${personal.age}` : ''}` : `User ${clientId}`}\n                </div>\n                {/* –ß—ñ–ø –∑ —Å—Ç–∞—Ç—É—Å–æ–º –æ–Ω–ª–∞–π–Ω */}\n                <div className=\"flex items-center gap-2 bg-gray-50 px-2 py-1 rounded-full w-fit\">\n                  <div className={`w-2 h-2 rounded-full ${isOnline ? 'bg-green-500' : 'bg-gray-400'}`}></div>\n                  <span className=\"text-sm text-gray-700 font-medium\">\n                    {isOnline ? '–æ–Ω–ª–∞–π–Ω' : formatLastVisit(lastVisit)}\n                  </span>\n                </div>\n              </div>\n\n              {/* –ß—ñ–ø–∏ –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é */}\n              <div className=\"space-y-2\">\n                {/* –ß—ñ–ø –∑ –ª–æ–∫–∞—Ü—ñ—î—é */}\n                {(personal?.country || personal?.city) && (\n                  <div className=\"flex items-center gap-2 bg-gray-50 px-2 py-1 rounded-full w-fit\">\n                    <svg className=\"w-4 h-4 text-gray-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                    </svg>\n                    <span className=\"text-sm text-gray-700 font-medium\">\n                      {[personal?.country, personal?.city].filter(Boolean).join(', ')}\n                    </span>\n                  </div>\n                )}\n\n                {/* –†—è–¥–æ–∫ –∑ –¥–∞—Ç–æ—é –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è —Ç–∞ –∑–Ω–∞–∫–æ–º –∑–æ–¥—ñ–∞–∫—É */}\n                {personal?.date_birth && (\n                  <div className=\"flex gap-2\">\n                    {/* –ß—ñ–ø –∑ –¥–∞—Ç–æ—é –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è */}\n                    <div className=\"flex items-center gap-2 bg-gray-50 px-2 py-1 rounded-full w-fit\">\n                      <svg className=\"w-4 h-4 text-gray-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z\" />\n                      </svg>\n                      <span className=\"text-sm text-gray-700 font-medium\">\n                        {personal.date_birth}\n                      </span>\n                    </div>\n\n                    {/* –ß—ñ–ø —ñ–∑ –∑–Ω–∞–∫–æ–º –∑–æ–¥—ñ–∞–∫—É */}\n                    <div className=\"flex items-center gap-2 bg-gray-50 px-2 py-1 rounded-full w-fit\">\n                      <span className=\"text-base\">{getZodiacSign(personal.date_birth).icon}</span>\n                      <span className=\"text-sm text-gray-700 font-medium\">\n                        {getZodiacSign(personal.date_birth).name}\n                      </span>\n                    </div>\n                  </div>\n                )}\n\n                {/* –Ü–Ω—à—ñ —á—ñ–ø–∏ */}\n                <div className=\"flex flex-wrap gap-2\">\n                  {/* –ß—ñ–ø –∑ –Ω–∞—Å—Ç—Ä–æ—î–º */}\n                  {(() => {\n                    const moodStyles = getMoodStyles(personal?.mood);\n                    return (\n                      <div className=\"flex items-center gap-2 bg-gray-50 px-2 py-1 rounded-full w-fit\">\n                        <div className={`w-4 h-4 flex items-center justify-center ${moodStyles.iconColor}`}>\n                          {moodStyles.icon}\n                        </div>\n                        <span className={`text-xs font-medium ${moodStyles.textColor}`}>\n                          {moodStyles.displayName}\n                        </span>\n                      </div>\n                    );\n                  })()}\n\n                </div>\n              </div>\n\n              {/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ \"–Ø —à—É–∫–∞—é\" */}\n              <div className=\"mt-6 mb-3\">\n                <h3 className=\"text-base font-semibold text-gray-900\">–Ø —à—É–∫–∞—é</h3>\n              </div>\n\n              {/* –ß—ñ–ø–∏ –∑ –ø–æ—à—É–∫–æ–º */}\n              {(preferences?.gender || preferences?.age_from || preferences?.age_to || personal?.goal || preferences?.pref_personality_type) && (\n                <div className=\"mb-4\">\n                  <div className=\"flex gap-2\">\n                    {/* –ß—ñ–ø –∑ –ø–æ—à—É–∫–æ–º –∑–∞ —Å—Ç–∞—Ç—Ç—é —Ç–∞ –≤—ñ–∫–æ–º */}\n                    {(preferences?.gender || preferences?.age_from || preferences?.age_to) && (\n                      <div className=\"flex items-center gap-2 bg-gray-50 px-2 py-1 rounded-full w-fit\">\n                        {/* –Ü–∫–æ–Ω–∫–∞ —Å—Ç–∞—Ç—ñ */}\n                        {preferences?.gender === 'male' ? (\n                          <svg className=\"w-4 h-4 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\n                          </svg>\n                        ) : preferences?.gender === 'female' ? (\n                          <svg className=\"w-4 h-4 text-pink-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z\" />\n                          </svg>\n                        ) : (\n                          <svg className=\"w-4 h-4 text-gray-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\n                          </svg>\n                        )}\n                        {/* –¢–µ–∫—Å—Ç –∑ –≤—ñ–∫–æ–≤–∏–º –¥—ñ–∞–ø–∞–∑–æ–Ω–æ–º */}\n                        <span className=\"text-sm text-gray-700 font-medium\">\n                          {preferences?.age_from && preferences?.age_to\n                            ? `${preferences.age_from}-${preferences.age_to}`\n                            : preferences?.age_from\n                              ? `–≤—ñ–¥ ${preferences.age_from}`\n                              : preferences?.age_to\n                                ? `–¥–æ ${preferences.age_to}`\n                                : '–ë—É–¥—å-—è–∫–∏–π –≤—ñ–∫'\n                          }\n                        </span>\n                      </div>\n                    )}\n\n                    {/* –ß—ñ–ø –∑ —Ü—ñ–ª—è–º–∏ */}\n                    {personal?.goal && Array.isArray(personal.goal) && personal.goal.length > 0 && (\n                      <div className=\"flex items-center gap-2 bg-gray-50 px-2 py-1 rounded-full w-fit\">\n                        <svg className=\"w-4 h-4 text-purple-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                        </svg>\n                        <span className=\"text-sm text-gray-700 font-medium\">\n                          {personal.goal}\n                        </span>\n                      </div>\n                    )}\n\n                    {/* –ß—ñ–ø –∑ —Ç–∏–ø–æ–º –æ—Å–æ–±–∏—Å—Ç–æ—Å—Ç—ñ */}\n                    {preferences?.pref_personality_type && (\n                      <div className=\"flex items-center gap-2 bg-gray-50 px-2 py-1 rounded-full w-fit\">\n                        <svg className=\"w-4 h-4 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\" />\n                        </svg>\n                        <span className=\"text-sm text-gray-700 font-medium\">\n                          {preferences.pref_personality_type}\n                        </span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n\n              {/* –ë–ª–æ–∫ \"–†–∏—Å–∏ —Ç–∞ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è\" */}\n              {((personal?.traits && ((Array.isArray(personal.traits) && personal.traits.length > 0) || (typeof personal.traits === 'string' && personal.traits.trim()))) ||\n                (personal?.hobbies && ((Array.isArray(personal.hobbies) && personal.hobbies.length > 0) || (typeof personal.hobbies === 'string' && personal.hobbies.trim()))) ||\n                (personal?.movie_genres && Array.isArray(personal.movie_genres) && personal.movie_genres.length > 0) ||\n                (personal?.music_genres && Array.isArray(personal.music_genres) && personal.music_genres.length > 0) ||\n                personal?.religion) && (\n                <div className=\"mt-6 mb-4\">\n                  <h3 className=\"text-base font-semibold text-gray-900 mb-3\">–†–∏—Å–∏ —Ç–∞ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è</h3>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {/* –û–∫—Ä–µ–º—ñ —á—ñ–ø–∏ –∑ —Ä–∏—Å–∞–º–∏ */}\n                    {(() => {\n                      let traitsArray: string[] = [];\n                      if (Array.isArray(personal?.traits)) {\n                        traitsArray = personal.traits;\n                      } else if (typeof personal?.traits === 'string') {\n                        traitsArray = personal.traits.split(',').map(t => t.trim()).filter(t => t);\n                      }\n                      return traitsArray.map((trait, index) => (\n                        <div key={`trait-${index}`} className=\"flex items-center gap-2 bg-blue-50 px-2 py-1 rounded-full w-fit\">\n                          <svg className=\"w-4 h-4 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\" />\n                          </svg>\n                          <span className=\"text-sm text-gray-700 font-medium\">\n                            {trait}\n                          </span>\n                        </div>\n                      ));\n                    })()}\n\n                    {/* –û–∫—Ä–µ–º—ñ —á—ñ–ø–∏ –∑ —Ö–æ–±—ñ */}\n                    {(() => {\n                      let hobbiesArray: string[] = [];\n                      if (Array.isArray(personal?.hobbies)) {\n                        hobbiesArray = personal.hobbies;\n                      } else if (typeof personal?.hobbies === 'string') {\n                        hobbiesArray = personal.hobbies.split(',').map(h => h.trim()).filter(h => h);\n                      }\n                      return hobbiesArray.map((hobby, index) => (\n                        <div key={`hobby-${index}`} className=\"flex items-center gap-2 bg-green-50 px-2 py-1 rounded-full w-fit\">\n                          <svg className=\"w-4 h-4 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M14.828 14.828a4 4 0 01-5.656 0M9 10h1.586a1 1 0 01.707.293l.707.707A1 1 0 0012.414 11H15m-3 7.5A9.5 9.5 0 1121.5 12 9.5 9.5 0 0112 2.5z\" />\n                          </svg>\n                          <span className=\"text-sm text-gray-700 font-medium\">\n                            {hobby}\n                          </span>\n                        </div>\n                      ));\n                    })()}\n\n                    {/* –û–∫—Ä–µ–º—ñ —á—ñ–ø–∏ –∑ –∂–∞–Ω—Ä–∞–º–∏ —Ñ—ñ–ª—å–º—ñ–≤ */}\n                    {personal?.movie_genres && Array.isArray(personal.movie_genres) && personal.movie_genres.map((genre, index) => (\n                      <div key={`movie-${index}`} className=\"flex items-center gap-2 bg-purple-50 px-2 py-1 rounded-full w-fit\">\n                        <svg className=\"w-4 h-4 text-purple-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z\" />\n                        </svg>\n                        <span className=\"text-sm text-gray-700 font-medium\">\n                          {genre}\n                        </span>\n                      </div>\n                    ))}\n\n                    {/* –û–∫—Ä–µ–º—ñ —á—ñ–ø–∏ –∑ –º—É–∑–∏—á–Ω–∏–º–∏ –∂–∞–Ω—Ä–∞–º–∏ */}\n                    {personal?.music_genres && Array.isArray(personal.music_genres) && personal.music_genres.map((genre, index) => (\n                      <div key={`music-${index}`} className=\"flex items-center gap-2 bg-orange-50 px-2 py-1 rounded-full w-fit\">\n                        <svg className=\"w-4 h-4 text-orange-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3\" />\n                        </svg>\n                        <span className=\"text-sm text-gray-700 font-medium\">\n                          {genre}\n                        </span>\n                      </div>\n                    ))}\n\n                    {/* –ß—ñ–ø –∑ —Ä–µ–ª—ñ–≥—ñ—î—é */}\n                    {personal?.religion && (\n                      <div className=\"flex items-center gap-2 bg-violet-50 px-2 py-1 rounded-full w-fit\">\n                        <svg className=\"w-4 h-4 text-violet-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253\" />\n                        </svg>\n                        <span className=\"text-sm text-gray-700 font-medium\">\n                          {personal.religion}\n                        </span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n\n              {/* –ë–ª–æ–∫ \"–û—Å–≤—ñ—Ç–∞ —Ç–∞ –∑–∞–π–Ω—è—Ç—ñ—Å—Ç—å\" */}\n              {(personal?.education || personal?.occupation || personal?.field_of_work || personal?.language ||\n                personal?.level_of_english || personal?.other_langs || personal?.other_languages) && (\n                <div className=\"mt-6 mb-4\">\n                  <h3 className=\"text-base font-semibold text-gray-900 mb-3\">–û—Å–≤—ñ—Ç–∞ —Ç–∞ –∑–∞–π–Ω—è—Ç—ñ—Å—Ç—å</h3>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {/* –ß—ñ–ø –∑ –æ—Å–≤—ñ—Ç–æ—é */}\n                    {personal?.education && (\n                      <div className=\"flex items-center gap-2 bg-indigo-50 px-2 py-1 rounded-full w-fit\">\n                        <svg className=\"w-4 h-4 text-indigo-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M12 14l9-5-9-5-9 5 9 5z\" />\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z\" />\n                        </svg>\n                        <span className=\"text-sm text-gray-700 font-medium\">\n                          {personal.education}\n                        </span>\n                      </div>\n                    )}\n\n                    {/* –ß—ñ–ø –∑ –ø—Ä–æ—Ñ–µ—Å—ñ—î—é */}\n                    {personal?.occupation && (\n                      <div className=\"flex items-center gap-2 bg-teal-50 px-2 py-1 rounded-full w-fit\">\n                        <svg className=\"w-4 h-4 text-teal-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m8 0V8a2 2 0 01-2 2H8a2 2 0 01-2-2V6m8 0H8\" />\n                        </svg>\n                        <span className=\"text-sm text-gray-700 font-medium\">\n                          {personal.occupation}\n                        </span>\n                      </div>\n                    )}\n\n                    {/* –ß—ñ–ø –∑—ñ —Å—Ñ–µ—Ä–æ—é —Ä–æ–±–æ—Ç–∏ */}\n                    {personal?.field_of_work && (\n                      <div className=\"flex items-center gap-2 bg-cyan-50 px-2 py-1 rounded-full w-fit\">\n                        <svg className=\"w-4 h-4 text-cyan-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4\" />\n                        </svg>\n                        <span className=\"text-sm text-gray-700 font-medium\">\n                          {personal.field_of_work}\n                        </span>\n                      </div>\n                    )}\n\n                    {/* –ß—ñ–ø –∑ –º–æ–≤–æ—é */}\n                    {personal?.language && (\n                      <div className=\"flex items-center gap-2 bg-emerald-50 px-2 py-1 rounded-full w-fit\">\n                        <svg className=\"w-4 h-4 text-emerald-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M3 5h12M9 3v2m1.048 9.5A18.022 18.022 0 016.412 9m6.088 9h7M11 21l5-10 5 10M12.751 5C11.783 10.77 8.07 15.61 3 18.129\" />\n                        </svg>\n                        <span className=\"text-sm text-gray-700 font-medium\">\n                          {personal.language}\n                        </span>\n                      </div>\n                    )}\n\n                    {/* –ß—ñ–ø –∑ —Ä—ñ–≤–Ω–µ–º –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—ó */}\n                    {personal?.level_of_english && (\n                      <div className=\"flex items-center gap-2 bg-amber-50 px-2 py-1 rounded-full w-fit\">\n                        <svg className=\"w-4 h-4 text-amber-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                        </svg>\n                        <span className=\"text-sm text-gray-700 font-medium\">\n                          {personal.level_of_english}\n                        </span>\n                      </div>\n                    )}\n\n                    {/* –ß—ñ–ø–∏ –∑ —ñ–Ω—à–∏–º–∏ –º–æ–≤–∞–º–∏ */}\n                    {(() => {\n                      let otherLanguages: string[] = [];\n                      if (personal?.other_langs && typeof personal.other_langs === 'string') {\n                        otherLanguages = personal.other_langs.split(',').map(lang => lang.trim()).filter(lang => lang);\n                      } else if (personal?.other_languages && typeof personal.other_languages === 'string') {\n                        otherLanguages = personal.other_languages.split(',').map(lang => lang.trim()).filter(lang => lang);\n                      } else if (Array.isArray(personal?.other_languages)) {\n                        otherLanguages = personal.other_languages;\n                      }\n                      return otherLanguages.map((lang, index) => (\n                        <div key={`other-lang-${index}`} className=\"flex items-center gap-2 bg-rose-50 px-2 py-1 rounded-full w-fit\">\n                          <svg className=\"w-4 h-4 text-rose-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M7 4V2a1 1 0 011-1h8a1 1 0 011 1v2m-9 0h10m-9 0V1m10 3V1m0 3l1 1v16a2 2 0 01-2 2H6a2 2 0 01-2-2V5l1-1z\" />\n                          </svg>\n                          <span className=\"text-sm text-gray-700 font-medium\">\n                            {lang}\n                          </span>\n                        </div>\n                      ));\n                    })()}\n                  </div>\n                </div>\n              )}\n\n              {/* –ë–ª–æ–∫ \"–°—ñ–º'—è\" */}\n              {(personal?.marital_status || (personal?.count_children !== undefined && personal?.count_children >= 0)) && (\n                <div className=\"mt-6 mb-4\">\n                  <h3 className=\"text-base font-semibold text-gray-900 mb-3\">–°—ñ–º'—è</h3>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {/* –ß—ñ–ø —ñ–∑ —Å—ñ–º–µ–π–Ω–∏–º —Å—Ç–∞–Ω–æ–º */}\n                    {personal?.marital_status && (\n                      <div className=\"flex items-center gap-2 bg-gray-50 px-2 py-1 rounded-full w-fit\">\n                        <svg className=\"w-4 h-4 text-red-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\" />\n                        </svg>\n                        <span className=\"text-sm text-gray-700 font-medium\">\n                          {personal.marital_status}\n                        </span>\n                      </div>\n                    )}\n\n                    {/* –ß—ñ–ø –∑ –¥—ñ—Ç—å–º–∏ */}\n                    {personal?.count_children !== undefined && personal?.count_children >= 0 && (\n                      <div className=\"flex items-center gap-2 bg-lime-50 px-2 py-1 rounded-full w-fit\">\n                        <svg className=\"w-4 h-4 text-lime-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253\" />\n                        </svg>\n                        <span className=\"text-sm text-gray-700 font-medium\">\n                          {personal.count_children === 0 ? '–ù–µ–º–∞—î –¥—ñ—Ç–µ–π' : `${personal.count_children} ${personal.count_children === 1 ? '–¥–∏—Ç–∏–Ω–∞' : personal.count_children < 5 ? '–¥–∏—Ç–∏–Ω–∏' : '–¥—ñ—Ç–µ–π'}`}\n                        </span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n\n              {/* –ë–ª–æ–∫ \"–ó–≤–∏—á–∫–∏ —Ç–∞ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Å—Ç—å\" */}\n              {(() => {\n                const hasDrinking = personal?.drinking && parseFloat(String(personal.drinking)) !== 0;\n                const hasHeight = personal?.height && parseFloat(String(personal.height)) !== 0;\n                const hasSmoking = personal?.smoking && parseFloat(String(personal.smoking)) !== 0;\n                const hasWeight = personal?.weight && parseFloat(String(personal.weight)) !== 0;\n                const shouldShow = hasDrinking || hasHeight || hasSmoking || hasWeight;\n\n                if (!shouldShow) return null;\n\n                return (\n                <div className=\"mt-6 mb-4\">\n                  <h3 className=\"text-base font-semibold text-gray-900 mb-3\">–ó–≤–∏—á–∫–∏ —Ç–∞ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Å—Ç—å</h3>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {/* –ß—ñ–ø –∑ –∞–ª–∫–æ–≥–æ–ª–µ–º */}\n                    {(() => {\n                      const value = personal?.drinking;\n                      const numValue = value ? parseFloat(String(value)) : 0;\n                      return numValue !== 0 && (\n                        <div className=\"flex items-center gap-2 bg-amber-50 px-2 py-1 rounded-full w-fit\">\n                          <svg className=\"w-4 h-4 text-amber-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\" />\n                          </svg>\n                          <span className=\"text-sm text-gray-700 font-medium\">\n                            –ê–ª–∫–æ–≥–æ–ª—å: {value}\n                          </span>\n                        </div>\n                      );\n                    })()}\n\n                    {/* –ß—ñ–ø –∑—ñ –∑—Ä–æ—Å—Ç–æ–º */}\n                    {(() => {\n                      const value = personal?.height;\n                      const numValue = value ? parseFloat(String(value)) : 0;\n                      return numValue !== 0 && (\n                        <div className=\"flex items-center gap-2 bg-cyan-50 px-2 py-1 rounded-full w-fit\">\n                          <svg className=\"w-4 h-4 text-cyan-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M16 7l-2-2-2 2m0 0l-2 2 2 2m0-2V21M8 7h8M8 7V5a2 2 0 012-2h4a2 2 0 012 2v2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V9a2 2 0 00-2-2h-2\" />\n                          </svg>\n                          <span className=\"text-sm text-gray-700 font-medium\">\n                            {value} —Å–º\n                          </span>\n                        </div>\n                      );\n                    })()}\n\n                    {/* –ß—ñ–ø –∑ –∫—É—Ä—ñ–Ω–Ω—è–º */}\n                    {(() => {\n                      const value = personal?.smoking;\n                      const numValue = value ? parseFloat(String(value)) : 0;\n                      return numValue !== 0 && (\n                        <div className=\"flex items-center gap-2 bg-gray-50 px-2 py-1 rounded-full w-fit\">\n                          <svg className=\"w-4 h-4 text-gray-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z\" />\n                          </svg>\n                          <span className=\"text-sm text-gray-700 font-medium\">\n                            –ö—É—Ä—ñ–Ω–Ω—è: {value}\n                          </span>\n                        </div>\n                      );\n                    })()}\n\n                    {/* –ß—ñ–ø –∑ –≤–∞–≥–æ—é */}\n                    {(() => {\n                      const value = personal?.weight;\n                      const numValue = value ? parseFloat(String(value)) : 0;\n                      return numValue !== 0 && (\n                        <div className=\"flex items-center gap-2 bg-pink-50 px-2 py-1 rounded-full w-fit\">\n                          <svg className=\"w-4 h-4 text-pink-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0m-6.001 0l3-9m0 0l3-1m-3 1l-3 1M6 7l3 1m0 0l-3 9a5.002 5.002 0 006.001 0m-6.001 0l3-9m0 0l3-1m-3 1l-3 1M9 8l3 1m0 0l-3 9a5.002 5.002 0 006.001 0m-6.001 0l3-9m0 0l3-1m-3 1l-3 1M12 9l3 1m0 0l-3 9a5.002 5.002 0 006.001 0m-6.001 0l3-9m0 0l3-1m-3 1l-3 1\" />\n                          </svg>\n                          <span className=\"text-sm text-gray-700 font-medium\">\n                            {value} –∫–≥\n                          </span>\n                        </div>\n                      );\n                    })()}\n                  </div>\n                </div>\n                );\n              })()}\n\n              {/* –ë–ª–æ–∫ \"–û–ø–∏—Å\" */}\n              {personal?.description && (\n                <div className=\"mt-6 mb-4\">\n                  <h3 className=\"text-base font-semibold text-gray-900 mb-3\">–û–ø–∏—Å</h3>\n                  <div className=\"text-sm text-gray-700 leading-relaxed\">\n                    {(() => {\n                      const decodeHtmlEntities = (text: string) => {\n                        const textarea = document.createElement('textarea');\n                        textarea.innerHTML = text;\n                        return textarea.value;\n                      };\n                      return decodeHtmlEntities(String(personal.description));\n                    })()}\n                  </div>\n                </div>\n              )}\n\n              <div className=\"space-y-1\">\n                <InfoRow label=\"–í–æ–ª–æ—Å—Å—è\" value={personal?.color_hair} />\n                <InfoRow label=\"–û—á—ñ\" value={personal?.color_eye} />\n                <InfoRow label=\"–°—Ç–∞—Ç—É—Ä–∞\" value={personal?.body_type} />\n                <InfoRow label=\"–®—É–∫–∞—é\" value={personal?.looking_for} />\n              </div>\n              <div className=\"space-y-1\">\n                <InfoRow label=\"–°—Ç–≤–æ—Ä–µ–Ω–æ\" value={dateCreated} />\n              </div>\n            </div>\n          </div>\n        )}\n\n        {fullImage && (\n          <div className=\"fixed inset-0 z-[80] flex items-center justify-center\" onClick={() => setFullImage(null)}>\n            <div className=\"absolute inset-0 bg-black/80\" />\n            <img src={fullImage} alt=\"full\" className=\"relative max-w-[95vw] max-h-[95vh] object-contain rounded\" />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\n\n","\"use client\";\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { apiGet, apiPost } from '@/lib/api';\n\ninterface PersonalInfo {\n  avatar_xl?: string;\n  age?: number;\n  date_birth?: string;\n  city?: string;\n  country?: string;\n  count_children?: number;\n  color_hair?: string;\n  color_eye?: string;\n  body_type?: string;\n  description?: string;\n  drinking?: number;\n  education?: string;\n  level_of_english?: string;\n  gender?: string;\n  height?: number;\n  looking_for?: string;\n  marital_status?: string;\n  name?: string;\n  occupation?: string;\n  other_langs?: string;\n  religion?: string;\n  smoking?: number;\n  weight?: number;\n  goal?: string[];\n  traits?: string[];\n  hobbies?: string[];\n}\n\ninterface Preferences {\n  gender?: string;\n  age_from?: number;\n  age_to?: number;\n  pref_personality_type?: string;\n}\n\ninterface ProfileData {\n  personal: PersonalInfo;\n  preferences: Preferences;\n}\n\ninterface InfoRowProps {\n  label: string;\n  value?: string | number | null;\n}\n\nconst InfoRow: React.FC<InfoRowProps> = ({ label, value }) => {\n  if (!value || String(value).trim() === '') return null;\n\n  return (\n    <div className=\"flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0\">\n      <span className=\"text-sm font-medium text-gray-600\">{label}</span>\n      <span className=\"text-sm text-gray-900\">{value}</span>\n    </div>\n  );\n};\n\ninterface MyPublicProfileModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  profileId: string;\n}\n\nexport const MyPublicProfileModal: React.FC<MyPublicProfileModalProps> = ({\n  isOpen,\n  onClose,\n  profileId,\n}) => {\n  const [profileData, setProfileData] = useState<ProfileData | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (isOpen && profileId) {\n      fetchProfileData();\n    }\n  }, [isOpen, profileId]);\n\n  const fetchProfileData = async () => {\n    setLoading(true);\n    setError(null);\n\n    try {\n      const profileDataResponse = await apiGet<{ profileData: { personal: PersonalInfo; preferences: Preferences } }>(`/profiles/${profileId}/profile-data`);\n\n      if (profileDataResponse.profileData) {\n        setProfileData(profileDataResponse.profileData);\n      } else {\n        setError('–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥–∞–Ω—ñ –ø—Ä–æ—Ñ—ñ–ª—é');\n      }\n    } catch (err: any) {\n      setError(err.message || '–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const personal = profileData?.personal;\n  const preferences = profileData?.preferences;\n\n  const dateCreated = useMemo(() => {\n    if (!personal?.date_birth) return null;\n    try {\n      const date = new Date(personal.date_birth);\n      return date.toLocaleDateString('uk-UA', {\n        day: 'numeric',\n        month: 'long',\n        year: 'numeric',\n      });\n    } catch {\n      return null;\n    }\n  }, [personal?.date_birth]);\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto custom-scroll\">\n        {/* Header */}\n        <div className=\"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between\">\n          <h2 className=\"text-xl font-semibold text-gray-900\">–ú—ñ–π –ø—É–±–ª—ñ—á–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å</h2>\n          <button\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 transition-colors\"\n          >\n            <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n            </svg>\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"px-6 py-4\">\n          {loading && (\n            <div className=\"flex items-center justify-center py-8\">\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n            </div>\n          )}\n\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 mb-4\">\n              <p className=\"text-red-700\">{error}</p>\n            </div>\n          )}\n\n          {profileData && personal && (\n            <div className=\"space-y-6\">\n              {/* Avatar and Basic Info */}\n              <div className=\"flex items-start space-x-4\">\n                <div className=\"w-20 h-20 rounded-full overflow-hidden bg-gray-200 flex-shrink-0\">\n                  {personal.avatar_xl ? (\n                    <img\n                      src={personal.avatar_xl}\n                      alt={personal.name || 'Avatar'}\n                      className=\"w-full h-full object-cover\"\n                    />\n                  ) : (\n                    <div className=\"w-full h-full bg-gray-300 flex items-center justify-center\">\n                      <svg className=\"w-8 h-8 text-gray-500\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                        <path d=\"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z\" />\n                      </svg>\n                    </div>\n                  )}\n                </div>\n\n                <div className=\"flex-1 min-w-0\">\n                  <h3 className=\"text-lg font-semibold text-gray-900\">{personal.name}</h3>\n                  {personal.age && (\n                    <p className=\"text-sm text-gray-600\">{personal.age} —Ä–æ–∫—ñ–≤</p>\n                  )}\n                  {(personal.city || personal.country) && (\n                    <p className=\"text-sm text-gray-600\">\n                      {[personal.city, personal.country].filter(Boolean).join(', ')}\n                    </p>\n                  )}\n                </div>\n              </div>\n\n              {/* –ë–ª–æ–∫ \"–ó–≤–∏—á–∫–∏ —Ç–∞ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Å—Ç—å\" */}\n              {(() => {\n                const drinkingValue = personal?.drinking ? parseFloat(String(personal.drinking)) : 0;\n                const hasDrinking = drinkingValue === 1 || drinkingValue === 2 || drinkingValue === 3 || drinkingValue === 4;\n                const hasHeight = personal?.height && parseFloat(String(personal.height)) !== 0;\n                const smokingValue = personal?.smoking ? parseFloat(String(personal.smoking)) : 0;\n                const hasSmoking = smokingValue === 1 || smokingValue === 2 || smokingValue === 3;\n                const hasWeight = personal?.weight && parseFloat(String(personal.weight)) !== 0;\n                const hasHair = personal?.color_hair && String(personal.color_hair).trim() !== '';\n                const hasBodyType = personal?.body_type && String(personal.body_type).trim() !== '';\n                const hasEyes = personal?.color_eye && String(personal.color_eye).trim() !== '';\n                const hasGoals = personal?.goal && Array.isArray(personal.goal) && personal.goal.length > 0;\n                const shouldShow = hasDrinking || hasHeight || hasSmoking || hasWeight || hasHair || hasBodyType || hasEyes || hasGoals;\n\n                if (!shouldShow) return null;\n\n                return (\n                <div className=\"mt-6 mb-4\">\n                  <h3 className=\"text-base font-semibold text-gray-900 mb-3\">–ó–≤–∏—á–∫–∏ —Ç–∞ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Å—Ç—å</h3>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {/* –ß—ñ–ø –∑ –∞–ª–∫–æ–≥–æ–ª–µ–º */}\n                    {(() => {\n                      const value = personal?.drinking ? parseFloat(String(personal.drinking)) : 0;\n                      let displayText = '';\n\n                      if (value === 1) {\n                        displayText = '–ù—ñ–∫–æ–ª–∏';\n                      } else if (value === 2) {\n                        displayText = '–ó–∞ –∫–æ–º–ø–∞–Ω—ñ—é';\n                      } else if (value === 3) {\n                        displayText = '–Ü–Ω–æ–¥—ñ';\n                      } else if (value === 4) {\n                        displayText = '–ß–∞—Å—Ç–æ';\n                      }\n\n                      return displayText && (\n                        <div className=\"flex items-center gap-2 bg-amber-50 px-2 py-1 rounded-full w-fit\">\n                          <svg className=\"w-4 h-4 text-amber-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" strokeWidth=\"1.6\" strokeLinecap=\"round\" strokeLinejoin=\"round\" role=\"img\" aria-label=\"Cocktail icon\">\n                            <path d=\"M4 4h16l-8 9-8-9Z\"/>\n                            <path d=\"M12 13v6\"/>\n                            <path d=\"M7 21h10\"/>\n                            <path d=\"M8.5 6.5l7 4\"/>\n                            <circle cx=\"15.5\" cy=\"9\" r=\"1.4\" fill=\"currentColor\" stroke=\"none\"/>\n                          </svg>\n                          <span className=\"text-sm text-gray-700 font-medium\">\n                            {displayText}\n                          </span>\n                        </div>\n                      );\n                    })()}\n\n                    {/* –ß—ñ–ø –∑ –∫—É—Ä—ñ–Ω–Ω—è–º */}\n                    {(() => {\n                      const value = personal?.smoking ? parseFloat(String(personal.smoking)) : 0;\n                      let displayText = '';\n\n                      if (value === 1) {\n                        displayText = '–ù—ñ–∫–æ–ª–∏';\n                      } else if (value === 2) {\n                        displayText = '–ó–∞ –∫–æ–º–ø–∞–Ω—ñ—é';\n                      } else if (value === 3) {\n                        displayText = '–¢–∞–∫';\n                      }\n\n                      return displayText && (\n                        <div className=\"flex items-center gap-2 bg-gray-50 px-2 py-1 rounded-full w-fit\">\n                          <svg className=\"w-4 h-4 text-gray-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 64 64\" strokeWidth=\"3.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\" role=\"img\" aria-label=\"Cigarette icon\">\n                            {/* –°–∏–≥–∞—Ä–µ—Ç–∞ */}\n                            <rect x=\"8\" y=\"28\" width=\"36\" height=\"8\" rx=\"1.5\"/>\n                            <line x1=\"14\" y1=\"28\" x2=\"14\" y2=\"36\"/>\n                            <line x1=\"22\" y1=\"28\" x2=\"22\" y2=\"36\"/>\n                            {/* –ü–æ–ø—ñ–ª / –∫—ñ–Ω—á–∏–∫ */}\n                            <rect x=\"44\" y=\"28\" width=\"8\" height=\"8\" rx=\"1.5\" fill=\"currentColor\" stroke=\"none\"/>\n                            {/* –î–∏–º */}\n                            <path d=\"M56 20c-4 6 4 8 0 14\" stroke=\"currentColor\"/>\n                          </svg>\n                          <span className=\"text-sm text-gray-700 font-medium\">\n                            {displayText}\n                          </span>\n                        </div>\n                      );\n                    })()}\n\n                    {/* –ß—ñ–ø –∑ –≤–æ–ª–æ—Å—Å—è–º */}\n                    {(() => {\n                      const value = personal?.color_hair;\n                      return value && String(value).trim() !== '' && (\n                        <div className=\"flex items-center gap-2 bg-purple-50 px-2 py-1 rounded-full w-fit\">\n                          <svg className=\"w-4 h-4 text-purple-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2zM8 14v4m8-4v4m-4-4v4\" />\n                          </svg>\n                          <span className=\"text-sm text-gray-700 font-medium\">\n                            {value}\n                          </span>\n                        </div>\n                      );\n                    })()}\n\n                    {/* –ß—ñ–ø –∑—ñ —Å—Ç–∞—Ç—É—Ä–æ–≥–æ */}\n                    {(() => {\n                      const value = personal?.body_type;\n                      return value && String(value).trim() !== '' && (\n                        <div className=\"flex items-center gap-2 bg-indigo-50 px-2 py-1 rounded-full w-fit\">\n                          <svg className=\"w-4 h-4 text-indigo-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z\" />\n                          </svg>\n                          <span className=\"text-sm text-gray-700 font-medium\">\n                            {value}\n                          </span>\n                        </div>\n                      );\n                    })()}\n\n                    {/* –ß—ñ–ø –∑ –æ—á–∏–º–∞ */}\n                    {(() => {\n                      const value = personal?.color_eye;\n                      return value && String(value).trim() !== '' && (\n                        <div className=\"flex items-center gap-2 bg-teal-50 px-2 py-1 rounded-full w-fit\">\n                          <svg className=\"w-4 h-4 text-teal-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />\n                          </svg>\n                          <span className=\"text-sm text-gray-700 font-medium\">\n                            {value}\n                          </span>\n                        </div>\n                      );\n                    })()}\n\n                    {/* –ß—ñ–ø –∑—ñ –∑—Ä–æ—Å—Ç–æ–º */}\n                    {(() => {\n                      const value = personal?.height;\n                      const numValue = value ? parseFloat(String(value)) : 0;\n                      return numValue !== 0 && (\n                        <div className=\"flex items-center gap-2 bg-cyan-50 px-2 py-1 rounded-full w-fit\">\n                          <svg className=\"w-4 h-4 text-cyan-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M16 7l-2-2-2 2m0 0l-2 2 2 2m0-2V21M8 7h8M8 7V5a2 2 0 012-2h4a2 2 0 012 2v2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V9a2 2 0 00-2-2h-2\" />\n                          </svg>\n                          <span className=\"text-sm text-gray-700 font-medium\">\n                            {value} —Å–º\n                          </span>\n                        </div>\n                      );\n                    })()}\n\n                    {/* –ß—ñ–ø –∑ –≤–∞–≥–æ—é */}\n                    {(() => {\n                      const value = personal?.weight;\n                      const numValue = value ? parseFloat(String(value)) : 0;\n                      return numValue !== 0 && (\n                        <div className=\"flex items-center gap-2 bg-pink-50 px-2 py-1 rounded-full w-fit\">\n                          <svg className=\"w-4 h-4 text-pink-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0m-6.001 0l3-9m0 0l3-1m-3 1l-3 1M6 7l3 1m0 0l-3 9a5.002 5.002 0 006.001 0m-6.001 0l3-9m0 0l3-1m-3 1l-3 1M9 8l3 1m0 0l-3 9a5.002 5.002 0 006.001 0m-6.001 0l3-9m0 0l3-1m-3 1l-3 1M12 9l3 1m0 0l-3 9a5.002 5.002 0 006.001 0m-6.001 0l3-9m0 0l3-1m-3 1l-3 1\" />\n                          </svg>\n                          <span className=\"text-sm text-gray-700 font-medium\">\n                            {value} –∫–≥\n                          </span>\n                        </div>\n                      );\n                    })()}\n\n                    {/* –ß—ñ–ø–∏ –∑ —Ü—ñ–ª—è–º–∏ */}\n                    {personal?.goal && Array.isArray(personal.goal) && personal.goal.map((goalItem, index) => (\n                      <div key={`goal-${index}`} className=\"flex items-center gap-2 bg-purple-50 px-2 py-1 rounded-full w-fit\">\n                        <svg className=\"w-4 h-4 text-purple-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\" />\n                        </svg>\n                        <span className=\"text-sm text-gray-700 font-medium\">\n                          {goalItem}\n                        </span>\n                      </div>\n                    ))}\n\n                    {/* –ß—ñ–ø –∑ —Ç–∏–ø–æ–º –æ—Å–æ–±–∏—Å—Ç–æ—Å—Ç—ñ */}\n                    {preferences?.pref_personality_type && (\n                      <div className=\"flex items-center gap-2 bg-gray-50 px-2 py-1 rounded-full w-fit\">\n                        <svg className=\"w-4 h-4 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z\" />\n                        </svg>\n                        <span className=\"text-sm text-gray-700 font-medium\">\n                          {preferences.pref_personality_type}\n                        </span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n                );\n              })()}\n\n              {/* –ë–ª–æ–∫ \"–†–∏—Å–∏ —Ç–∞ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è\" */}\n              {(() => {\n                const hasTraits = personal?.traits && ((Array.isArray(personal.traits) && personal.traits.length > 0) || (typeof personal.traits === 'string' && (personal.traits as string).trim()));\n                const hasHobbies = personal?.hobbies && ((Array.isArray(personal.hobbies) && personal.hobbies.length > 0) || (typeof personal.hobbies === 'string' && (personal.hobbies as string).trim()));\n                const hasReligion = personal?.religion;\n\n                return (hasTraits || hasHobbies || hasReligion) ? (\n                <div className=\"mt-6 mb-4\">\n                  <h3 className=\"text-base font-semibold text-gray-900 mb-3\">–†–∏—Å–∏ —Ç–∞ –∑–∞—Ö–æ–ø–ª–µ–Ω–Ω—è</h3>\n                  <div className=\"flex flex-wrap gap-2\">\n                    {/* –û–∫—Ä–µ–º—ñ —á—ñ–ø–∏ –∑ —Ä–∏—Å–∞–º–∏ */}\n                    {(() => {\n                      let traitsArray: string[] = [];\n                      if (Array.isArray(personal?.traits)) {\n                        traitsArray = personal.traits;\n                      } else if (typeof personal?.traits === 'string' && personal.traits) {\n                        traitsArray = (personal.traits as string).split(',').map((t: string) => t.trim()).filter((t: string) => t);\n                      }\n                      return traitsArray.map((trait, index) => (\n                        <div key={`trait-${index}`} className=\"flex items-center gap-2 bg-blue-50 px-2 py-1 rounded-full w-fit\">\n                          <svg className=\"w-4 h-4 text-blue-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z\" />\n                          </svg>\n                          <span className=\"text-sm text-gray-700 font-medium\">\n                            {trait}\n                          </span>\n                        </div>\n                      ));\n                    })()}\n\n                    {/* –û–∫—Ä–µ–º—ñ —á—ñ–ø–∏ –∑ —Ö–æ–±—ñ */}\n                    {(() => {\n                      let hobbiesArray: string[] = [];\n                      if (Array.isArray(personal?.hobbies)) {\n                        hobbiesArray = personal.hobbies;\n                      } else if (typeof personal?.hobbies === 'string' && personal.hobbies) {\n                        hobbiesArray = (personal.hobbies as string).split(',').map((h: string) => h.trim()).filter((h: string) => h);\n                      }\n                      return hobbiesArray.map((hobby, index) => (\n                        <div key={`hobby-${index}`} className=\"flex items-center gap-2 bg-green-50 px-2 py-1 rounded-full w-fit\">\n                          <svg className=\"w-4 h-4 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M14.828 14.828a4 4 0 01-5.656 0M9 10h1.586a1 1 0 01.707.293l.707.707A1 1 0 0012.414 11H15m-3 7.5A9.5 9.5 0 1121.5 12 9.5 9.5 0 0112 2.5z\" />\n                          </svg>\n                          <span className=\"text-sm text-gray-700 font-medium\">\n                            {hobby}\n                          </span>\n                        </div>\n                      ));\n                    })()}\n\n                    {/* –ß—ñ–ø –∑ —Ä–µ–ª—ñ–≥—ñ—î—é */}\n                    {personal?.religion && (\n                      <div className=\"flex items-center gap-2 bg-violet-50 px-2 py-1 rounded-full w-fit\">\n                        <svg className=\"w-4 h-4 text-violet-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253\" />\n                        </svg>\n                        <span className=\"text-sm text-gray-700 font-medium\">\n                          {personal.religion}\n                        </span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n                ) : null;\n              })()}\n\n              {/* –ë–ª–æ–∫ \"–ü—Ä–æ –º–µ–Ω–µ\" */}\n              {personal?.description && (\n                <div className=\"mt-6 mb-4\">\n                  <h3 className=\"text-base font-semibold text-gray-900 mb-3\">–ü—Ä–æ –º–µ–Ω–µ</h3>\n                  <div className=\"text-sm text-gray-700 leading-relaxed\">\n                    {(() => {\n                      const decodeHtmlEntities = (text: string) => {\n                        const textarea = document.createElement('textarea');\n                        textarea.innerHTML = text;\n                        return textarea.value;\n                      };\n                      return decodeHtmlEntities(String(personal.description));\n                    })()}\n                  </div>\n                </div>\n              )}\n\n              {/* –Ü–Ω—à—ñ –ø–æ–ª—è */}\n              <div className=\"space-y-1\">\n                <InfoRow label=\"–®—É–∫–∞—é\" value={personal?.looking_for} />\n              </div>\n              <div className=\"space-y-1\">\n                <InfoRow label=\"–°—Ç–≤–æ—Ä–µ–Ω–æ\" value={dateCreated} />\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};"],"names":[],"mappings":"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"}