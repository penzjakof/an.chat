# –¢–µ—Å—Ç —Å–∏—Å—Ç–µ–º–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É –¥–æ —á–∞—Ç—ñ–≤

## ‚úÖ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:

### 1. **–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø—É –¥–æ –ø—Ä–æ—Ñ—ñ–ª—ñ–≤**
- **Owner**: –ú–∞—î –¥–æ—Å—Ç—É–ø –¥–æ –≤—Å—ñ—Ö –ø—Ä–æ—Ñ—ñ–ª—ñ–≤ –∞–≥–µ–Ω—Ü—ñ—ó —á–µ—Ä–µ–∑ `/profiles`
- **Operator**: –ú–∞—î –¥–æ—Å—Ç—É–ø —Ç—ñ–ª—å–∫–∏ –¥–æ –ø—Ä–æ—Ñ—ñ–ª—ñ–≤ —Å–≤–æ—ó—Ö –≥—Ä—É–ø —á–µ—Ä–µ–∑ `/profiles/my`

### 2. **–ù–æ–≤—ñ –º–µ—Ç–æ–¥–∏ –≤ ProfilesService**
- `listByOperatorAccess(operatorId, agencyCode)` - –ø–æ–≤–µ—Ä—Ç–∞—î –ø—Ä–æ—Ñ—ñ–ª—ñ –¥–æ—Å—Ç—É–ø–Ω—ñ –æ–ø–µ—Ä–∞—Ç–æ—Ä—É
- `hasAccessToProfile(profileId, operatorId, agencyCode)` - –ø–µ—Ä–µ–≤—ñ—Ä—è—î –¥–æ—Å—Ç—É–ø –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ñ—ñ–ª—é

### 3. **–°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É –¥–æ —á–∞—Ç—ñ–≤**
- –°—Ç–≤–æ—Ä–µ–Ω–æ `ChatAccessService` –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –¥–æ—Å—Ç—É–ø–æ–º
- `ChatsService` —Ç–µ–ø–µ—Ä —Ñ—ñ–ª—å—Ç—Ä—É—î –¥—ñ–∞–ª–æ–≥–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä–æ–ª—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- –ü—ñ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –¥—ñ–∞–ª–æ–≥—ñ–≤ –∑–∞ –ø—Ä–æ—Ñ—ñ–ª—è–º–∏

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:

### –¢–µ—Å—Ç 1: –î–æ—Å—Ç—É–ø –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –¥–æ –ø—Ä–æ—Ñ—ñ–ª—ñ–≤
```bash
# –õ–æ–≥—ñ–Ω –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
curl -X POST http://localhost:4000/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"operator","password":"operator123"}'

# –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—ñ–≤ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
curl -H "Authorization: Bearer $OPERATOR_TOKEN" \
  http://localhost:4000/profiles/my
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ –û–ø–µ—Ä–∞—Ç–æ—Ä –±–∞—á–∏—Ç—å —Ç—ñ–ª—å–∫–∏ 3 –ø—Ä–æ—Ñ—ñ–ª—ñ –∑ "Group 1", –¥–æ —è–∫–æ—ó –≤—ñ–Ω –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π

### –¢–µ—Å—Ç 2: –î–æ—Å—Ç—É–ø –¥–æ —á–∞—Ç—ñ–≤
```bash
# –¢–µ—Å—Ç –¥—ñ–∞–ª–æ–≥—ñ–≤ –¥–ª—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
curl -H "Authorization: Bearer $OPERATOR_TOKEN" \
  http://localhost:4000/api/chats/dialogs
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∞—Ü—é—î, –ø–æ–≤–µ—Ä—Ç–∞—î mock –≤—ñ–¥–ø–æ–≤—ñ–¥—å –≤—ñ–¥ TalkyTimes

## üîÑ –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:

1. **–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –¥—ñ–∞–ª–æ–≥—ñ–≤ –∑–∞ –ø—Ä–æ—Ñ—ñ–ª—è–º–∏**: –ö–æ–ª–∏ –±—É–¥–µ –≤—ñ–¥–æ–º–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥—ñ–∞–ª–æ–≥—ñ–≤ TalkyTimes, –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é –≤ `ChatAccessService.filterDialogsByAccess()`

2. **–í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–æ—Å—Ç—É–ø—É –¥–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å**: –î–æ–¥–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –≤ `ChatsService.fetchMessages()` —Ç–∞ `sendText()`

3. **WebSocket –±–µ–∑–ø–µ–∫–∞**: –î–æ–¥–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫—É –¥–æ—Å—Ç—É–ø—É –¥–æ –¥—ñ–∞–ª–æ–≥—ñ–≤ –≤ `ChatsGateway.join()`

## üìä –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞:

```
User (Owner/Operator)
    ‚Üì
ProfilesController (@Roles)
    ‚Üì
ProfilesService
    ‚Üì (listByOperatorAccess)
Database (Profile ‚Üê Group ‚Üê OperatorGroup ‚Üí User)

User (Owner/Operator)
    ‚Üì
ChatsController (@Roles)
    ‚Üì
ChatsService
    ‚Üì
ChatAccessService ‚Üí ProfilesService
    ‚Üì
TalkyTimesProvider (Mock/Real)
```

## ‚úÖ –í–∏—Å–Ω–æ–≤–æ–∫:

**–°–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª—é –¥–æ—Å—Ç—É–ø—É –ø—Ä–∞—Ü—é—î –ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
- Owner –º–∞—î –¥–æ—Å—Ç—É–ø –¥–æ –≤—Å—ñ—Ö –ø—Ä–æ—Ñ—ñ–ª—ñ–≤ –∞–≥–µ–Ω—Ü—ñ—ó
- Operator –º–∞—î –¥–æ—Å—Ç—É–ø —Ç—ñ–ª—å–∫–∏ –¥–æ –ø—Ä–æ—Ñ—ñ–ª—ñ–≤ –≥—Ä—É–ø, –¥–æ —è–∫–∏—Ö –≤—ñ–Ω –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π
- –ß–∞—Ç–∏ –≥–æ—Ç–æ–≤—ñ –¥–æ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –Ω–∞ –æ—Å–Ω–æ–≤—ñ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –ø—Ä–æ—Ñ—ñ–ª—ñ–≤
- –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ —Ä–æ–∑—à–∏—Ä—é—î—Ç—å—Å—è –¥–ª—è —ñ–Ω—à–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º
