# Rate Limiting Configuration

## üìä –ù–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è

### –ì–ª–æ–±–∞–ª—å–Ω—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è
- **Short**: 10 –∑–∞–ø–∏—Ç—ñ–≤ –∑–∞ —Å–µ–∫—É–Ω–¥—É
- **Medium**: 100 –∑–∞–ø–∏—Ç—ñ–≤ –∑–∞ —Ö–≤–∏–ª–∏–Ω—É  
- **Long**: 1000 –∑–∞–ø–∏—Ç—ñ–≤ –∑–∞ –≥–æ–¥–∏–Ω—É

### –°–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è –ø–æ –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∞—Ö

#### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è
- `POST /auth/login`: **5 —Å–ø—Ä–æ–± –∑–∞ —Ö–≤–∏–ª–∏–Ω—É**
  - –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ brute force –∞—Ç–∞–∫
  - –ó–∞–ø–æ–±—ñ–≥–∞—î –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—é —Å–∏—Å—Ç–µ–º–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

#### üåê TalkyTimes API
- `GET|POST /api/tt/*`: **30 –∑–∞–ø–∏—Ç—ñ–≤ –∑–∞ —Ö–≤–∏–ª–∏–Ω—É**
  - –ó–∞—Ö–∏—Å—Ç TalkyTimes —Å–µ—Ä–≤–µ—Ä—ñ–≤ –≤—ñ–¥ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
  - –î–æ—Ç—Ä–∏–º–∞–Ω–Ω—è fair usage policy

#### üí¨ –ß–∞—Ç–∏
- `GET|POST /api/chats/*`: **60 –∑–∞–ø–∏—Ç—ñ–≤ –∑–∞ —Ö–≤–∏–ª–∏–Ω—É** (–∑–∞–≥–∞–ª—å–Ω–∏–π –ª—ñ–º—ñ—Ç)
- `POST /api/chats/dialogs/:id/text`: **20 –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∑–∞ —Ö–≤–∏–ª–∏–Ω—É**
- `POST /api/chats/send-photo`: **10 —Ñ–æ—Ç–æ –∑–∞ —Ö–≤–∏–ª–∏–Ω—É**
- `POST /api/chats/send-sticker`: **15 —Å—Ç—ñ–∫–µ—Ä—ñ–≤ –∑–∞ —Ö–≤–∏–ª–∏–Ω—É**

## üõ°Ô∏è –ü–µ—Ä–µ–≤–∞–≥–∏ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

### –ó–∞—Ö–∏—Å—Ç —Å–∏—Å—Ç–µ–º–∏
- –ó–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è DDoS –∞—Ç–∞–∫–∞–º
- –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –∑–ª–æ–≤–º–∏—Å–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
- –°—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å –ø—ñ–¥ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º

### –ó–∞—Ö–∏—Å—Ç TalkyTimes
- –î–æ—Ç—Ä–∏–º–∞–Ω–Ω—è API limits
- –ó–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—é –∞–∫–∫–∞—É–Ω—Ç—ñ–≤
- –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ö–æ—Ä–æ—à–∏—Ö –≤—ñ–¥–Ω–æ—Å–∏–Ω –∑ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–º

### UX –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è
- –ó–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è —Å–ø–∞–º—É –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- –†–æ–∑—É–º–Ω—ñ –ª—ñ–º—ñ—Ç–∏ —â–æ –Ω–µ –∑–∞–≤–∞–∂–∞—é—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—é
- –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–æ–º–∏–ª–æ–∫ –∫–ª—ñ—î–Ω—Ç—Å—å–∫–æ–≥–æ –∫–æ–¥—É

## üîß –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó
- `@nestjs/throttler` - –æ—Å–Ω–æ–≤–Ω–∏–π –ø–∞–∫–µ—Ç
- In-memory storage (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –¥–æ Redis

### –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
```typescript
ThrottlerModule.forRoot([
  {
    name: 'short',
    ttl: 1000, // 1 —Å–µ–∫—É–Ω–¥–∞
    limit: 10, // 10 –∑–∞–ø–∏—Ç—ñ–≤
  },
  {
    name: 'medium', 
    ttl: 60000, // 1 —Ö–≤–∏–ª–∏–Ω–∞
    limit: 100, // 100 –∑–∞–ø–∏—Ç—ñ–≤
  },
  {
    name: 'long',
    ttl: 3600000, // 1 –≥–æ–¥–∏–Ω–∞
    limit: 1000, // 1000 –∑–∞–ø–∏—Ç—ñ–≤
  }
])
```

### –ö–∞—Å—Ç–æ–º–Ω—ñ –ª—ñ–º—ñ—Ç–∏
```typescript
@Throttle({ default: { limit: 5, ttl: 60000 } })
```

## üìà –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

### HTTP Headers
–ü—Ä–∏ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—ñ –ª—ñ–º—ñ—Ç—É –∫–ª—ñ—î–Ω—Ç –æ—Ç—Ä–∏–º—É—î:
- Status: `429 Too Many Requests`
- Headers:
  - `X-RateLimit-Limit`: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤
  - `X-RateLimit-Remaining`: –∑–∞–ª–∏—à–∏–ª–æ—Å—å –∑–∞–ø–∏—Ç—ñ–≤
  - `X-RateLimit-Reset`: —á–∞—Å —Å–∫–∏–¥–∞–Ω–Ω—è –ª—ñ–º—ñ—Ç—É

### –õ–æ–≥—É–≤–∞–Ω–Ω—è
- –í—Å—ñ –ø–µ—Ä–µ–≤–∏—â–µ–Ω–Ω—è –ª—ñ–º—ñ—Ç—ñ–≤ –ª–æ–≥—É—é—Ç—å—Å—è
- –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞–ª–µ—Ä—Ç—ñ–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

## üöÄ –ú–∞–π–±—É—Ç–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

### Redis Integration
```typescript
ThrottlerModule.forRoot({
  storage: new ThrottlerStorageRedisService(redis),
  // ... config
})
```

### –î–∏–Ω–∞–º—ñ—á–Ω—ñ –ª—ñ–º—ñ—Ç–∏
- –†—ñ–∑–Ω—ñ –ª—ñ–º—ñ—Ç–∏ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ä–æ–ª–µ–π
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ –ª—ñ–º—ñ—Ç–∏ –±–∞–∑–æ–≤–∞–Ω—ñ –Ω–∞ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ
- Whitelist –¥–ª—è –¥–æ–≤—ñ—Ä–µ–Ω–∏—Ö IP

### –ú–µ—Ç—Ä–∏–∫–∏
- Prometheus metrics
- Grafana dashboards
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ –∞–ª–µ—Ä—Ç–∏

## ‚ö†Ô∏è –í–∞–∂–ª–∏–≤—ñ –ø—Ä–∏–º—ñ—Ç–∫–∏

1. **–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è**: –õ—ñ–º—ñ—Ç–∏ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω—ñ –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏, –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—ñ –º–æ–∂—É—Ç—å –ø–æ—Ç—Ä–µ–±—É–≤–∞—Ç–∏ –∫–æ—Ä–∏–≥—É–≤–∞–Ω–Ω—è
2. **Bypass**: –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏ –º–æ–∂—É—Ç—å –º–∞—Ç–∏ –≤–∏—â—ñ –ª—ñ–º—ñ—Ç–∏
3. **Graceful degradation**: –ü—Ä–∏ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—ñ –ª—ñ–º—ñ—Ç—ñ–≤ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–≤–µ—Ä—Ç–∞—î –∑—Ä–æ–∑—É–º—ñ–ª—ñ –ø–æ–º–∏–ª–∫–∏
4. **Scaling**: –ü—Ä–∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–º—É –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—ñ –ø–æ—Ç—Ä—ñ–±–µ–Ω Redis
